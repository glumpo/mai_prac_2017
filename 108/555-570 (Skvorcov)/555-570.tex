\documentclass{mai_book}

\defaultfontfeatures{Mapping=tex-text}
\setdefaultlanguage{russian}

\setcounter{page} {555}

\begin{document}

\fancyhead[LE,RO]{\thepage}
\fancyhead[RE]{IV \textit{\small Некоторые методы алгбраической алгоритмики}}
\fancyhead[LO]{\textit{\small Решения упражнений}}

\newcounter{exercise}
\setcounter{exercise} {20}
\newcommand{\newexercise}{\noindent{\textbf{\theexercise. \stepcounter{exercise}}}}

\newexercise{\textbf{Замечание о } \textit{$v_{2}(n - 1)$} \textbf{при нечетном \textit{n}}}\\

Имеем $n_i \equiv$ 1 (mod $2^k$) для $i = 1,\ldots ,r$, а потому $n \equiv 1$ (mod $2^k$).
Кроме того:
\begin{align*}
	& n_{i} \equiv \text{1 (mod } 2^{k+1}), \text{ если } v_{2}(n_i - 1) > k, \\
	& n_{i} \equiv 1+2^{k} \text{ (mod } 2^{k+1}), \text{ если } v_{2}(n_i - 1) = k,
\end{align*}
откуда $n \equiv (1+2^{k})^{t}$ (mod $2^{k+1}$), где $t$ --- число таких индексов $i$, что $v_{2}(n_i - 1) = k$. Элемент $1+2^{k}$ имеет порядок 2 в $U(\mathbb{Z}_{2^{k+1}}$), а значит, $n \equiv (1+2^{k})^{t \text{ mod } 2}$ (mod $2^{k+1}$), откуда и следует наш результат.\\


\newexercise{\textbf{Простые числа вида } $4k+1$}\\

Предположим противное: существует конечное множество таких простых чисел $p_{1},\ldots ,p_{n}$, и рассмотрим число $a = 4(p_{1}\ldots p_{n})^2 + 1$. Если простое число $q$ делит $a$, то оно отлично от всех $p_{i}$, но при это явно $-1$ является квадратом по модулю $q$ и, следовательно, число $q$ имеет вид $4k+1$; пришли к противоречию.\\

\newexercise{\textbf{Некоторые свойства чисел Ферма}}\\

\textbf{a. } Легко доказывается, что $F_{n+1} - 2 = F_{n}(F_{n} - 2)$; и по индукции 
$F_{n+k} - 2 =$ $=F_{n+k-1} F_{n+k-2} \ldots F_{n+1}F_n(n-2)$. Следовательно, НОД($F_{n},F_{n+k}$) = НОД($F_{n},2) = 1$. \smallskip

\textbf{b. } В $\mathbb{Z}_{p}$ элемент $2$ имеет порядок $2^{n+1}$ (ибо $2^{2^{n}} = -1$). Значит, $2^{n+1}$ делит порядок группы $U(\mathbb{Z}_{p})$, равный $p - 1$. \par
Согласно дополнительному квадратичному закону взаимности $(p \equiv 1$ \text{ (mod 8)} при $n \ge 3$) $2$ является квадратичным вычетом по модулю $p$. Порядок $2$ равен $2^{n+1}$, а порядок квадратного корня из $2$ равен $2^{n+2}$. По аналогии с предыдущими рассуждениями $2^{n+1}$ делит $p -1$. \smallskip

\textbf{c. } Случай $F_{4}$. Простой делитель $p$ числа имеет вид $64k+1$, но его единственноe число такого вида, меньшее $\sqrt{65537}$, есть $193$ и оно не делит $F_{4}$. \par
Случай $F_{5}$. Делитель $F_{5}$ имеет вид $128k+1$. Поищем простые числа такого вида: $129$ делится на $3$, $257$ --- число Ферма, а потому взаимно просто с $F_{5}$, $385$ непростое, $513$ делится на $3$. Число же $641$ является простым, а потому оно хороший кандидат в делители $F_{5}$. И действительно, $F_{5} = 4 \,294 \, 967 \, 297 =$ $=641 \times 6 \, 700 \, 417$ --- разложение $F_{5}$ на простые множитли. \\

\newexercise{\textbf{Числа Ферма и критерий Пепина}} \\

\textbf{a. } Порождающий элемент группы обратимых очевидно не является квадратичным вычетом. Однако, если $x$ не квадратичный вычет, то $-1 \equiv (\frac{x}{p}) \equiv$ $\equiv x^{\frac{p-1}{2}} \text{ (mod } p$) и, поскольку порядок x делит степень $2$, он в точности равен $p-1$. \smallskip

\textbf{b. } Согласно квадратичному закону взаимности, если $p \neq 5$, то $5$ --- квадратичный вычет по модулю $p$ тогда и только тогда, когда $p$ --- квадратичный вычет по модулю $5$. Однако $p = 4^{2^{n-1}} + 1 \equiv 2${} (mod $5$) и $2$ не является квадратичным вычетом по модулю $5$. \par
Аналогично, при $p \neq 3$ число $7$ является квадратичным вычетом по модулю $p$ тогда и только тогда, когда $p$ --- квадратичный вычет по модулю $7$, а квадратичными вычетами по модулю $7$ будут $1$, $2$ и $4$. \smallskip

\textbf{c. } Предположим, что выполнено сравнение. Имеем $3^{p-1} \equiv 1 \text{ (mod } p$). Порядок $3$ по модулю $p$ равен в точности $p - 1$; и кольцо $\mathbb{Z}_{p}$, следовательно, является полем. \par
Обратно, предположим, что $p$ --- простое. Докажем, что $3$ не является квадратичным вычетом по модулю $p$. Заметим, что $p \equiv 2${} (mod $3$) и $p$ не квадратичный вычет по модулю $3$. Следовательно, как и в предыдущих вопросах, $3$ не квадратичный вычет помодулю $p$ (конечно, за исключением случая $p = 3$). \\

\newexercise{\textbf{Вычисление квадратных корней}} \\

\textbf{a. } Имеем: $a^{4} + 1 = (a^{2} + 1)^{2} - 2a^{2} = 0$, элемент $a$ обратим и потому $(a^{2}+1)/a = a - a^{3}$ --- квадратный корень из 2. \par
Запишем $17 = 2^4 + 1, \, 257 = 4^4 + 1, \, 41 = (3^{4} + 1)/2, \, 241 = (8^{4} + 1)/17, \, 1201 = (7^{4} + 1)/2$ и $3281 = (9^{4} + 1)/2$ и теперь без труда находим квадратные корни из $2$. Это соответственно $6$, $60$, $24$, $22$, $336$ и $720$. Последнее рассмотренное число, $3281$, непростое: $3281 = 17 \times 193$. \smallskip

\textbf{b. } Если существует такой $a$, что $a^{4} + 1 = 0$, то, как мы видели, существут и $\sqrt{2}$. Еще проще доказать, что существует $\sqrt{-1}$. Обратно, предположим, что существуют оба корня, и изучим уравнение $a^{4}+1 = 0$. Это уравнение обычным способом разлагается на множители $(a^{2}+a\sqrt{2}+1)(a^{2}-a\sqrt{2}+1) = 0$. Докажем, что оба эти уравнения имеют решение. Возьмем первое: его дискриминант равен $-2$ и, по предположению, существует квадратный корень из $-2$. Следовательно, одно из решений есть $(-\sqrt{2}+\sqrt{-2})/2$(не забываем, что $2$ обратимо по предположению). Итак, мы нашли элемент $a$ и при этом не использовали предположение о целостности кольца. \par
Согласно китайской теореме об остатках, достаточно найти такие корни по модулю $17$ и помодулю $193$, которые являются простыми(между прочим, $193$, как и $17$, является суммой двух квадратов). Рассмотрим теперь конечные поля, порядок которых сравним с $1$ по модулю $8$, и которые имеют, следоватльно, четыре корня четвертой степени и восемь корней восьмой степени из $1$. Аналогично, имеется $2$ квадратных корня из $2$. Следовательно, по модулю $3281$ существует $16$ корней четвертой степени из $1$, $64$ корня восьмой степени из $1$ и $4$ квадратных корня из $2$. \smallskip

\textbf{c. } Если мы работаем в поле $\mathbb{Z}_{p}$, содержащем такой элемент $a$, что $a^{4}+1=0$, то порядок элемента $a$ равен $8$ и $p \equiv 1$ (mod $8$). В этом случае нам известно, что существуют квадратные корни из $-1$ и $2$. В предыдущем пункте они выражены в явном виде. \par
Если теперь $p = 2q+1 \equiv 3$ (mod $4$), то можно записать магическую формулу Шенкса:
\begin{equation*}
	u = \left(u^{\frac{q+1}{2}}\right)^{2}u^{-q} = \left(u^{\frac{q+1}{2}}\right)^{2}u^{-\frac{p-1}{2}} = \left(u^{\frac{q+1}{2}}\right)^{2}u^{\frac{p-1}{2}},
\end{equation*}
в которой последний множитель является символом Лежандра для $u$ и равен $\pm 1$. Следовательно, если вычислим квадратный корень из $u^{(p+1)/2}$, то получим один из вариантов: результат равен $u$ и можно найти квадратный корень из $u$, результат равен $-u$ и не существует квадратного корня из $u$(ибо символ Лежандра равен $-1$).\\

\newexercise{\textbf{При каком условии -1 является $m$-й степенью?}} \\

Пусть $d = \text{НОД} (m, \varphi(p^{\alpha}))$. В этом случае -1 есть m-я степень в цикличиской группе $U(\mathbb{Z}_{p^{\alpha}})$ тогда и только тогда, когда $(-1)^{\varphi(p^{\alpha})/d} = 1$, т.е. когда $\varphi(p^{\alpha})/d$ четно. Последнее эквивалентно тому, что
\begin{equation*}
	\text{inf}(v_{2}(\varphi(p^{\alpha})), v_{2}(m)) < v_{2}(\varphi(p^{\alpha})) \text{ или, иначе, } v_{2}(m) < v_{2}(\varphi(p^{\alpha})).
\end{equation*}
Но $\varphi(p^{\alpha}) = p^{\alpha - 1}(p -1)$ и $v_{2}(\varphi(p^{\alpha})) = v_{2}(p-1)$, откуда следует результат.\par
Дадим более явное решние. Пусть $\varphi(p^{\alpha}) = 2^{k}q, m = 2^{h}r$ с нечетными $q$ и $r$. Существует такой $x$, что $x^{\frac{\varphi(p^{\alpha})}{2}} = -1$(такие $x$ образуют дополнение к подгруппе всех квадратов). Если $h < k$, то $-1 = (x^{2^{k - 1 - h}})^{2^{h}r}$. Обратно, если $-1 = x^{m}$, то $(x^{r})^{2^{h}} = -1$; это доказывает, что $2^{h+1}$, порядок $x^{r}$, делит $\varphi(p^{\alpha})$, а значит, $h < k$. \\

\newexercise{\textbf{Квадратичные вычеты по модулю некоторого числа}} \\

\textbf{a. } В одну сторону это очевидно. Докажем в другую. Пусть $x, y$ таковы, что $x^{2} \equiv a \text{ (mod } n),\, y^{2} \equiv a \text{ (mod } m)$. Применяя китайскую теорему об остатках, получим,  что существует такое целое число $z$, что $z \equiv x \text{ (mod } n)$, $z \equiv y \text{ (mod } m)$. Тогда $z^{2} \equiv x^{2} \equiv a \text{ (mod } n), \, z^{2} \equiv y^{2} \equiv a \text{ (mod } m)$, а потому $z^{2} \equiv a \text{ (mod } nm)$ (разность $z^{2}-a$ делится на $n$ и $m$, а значит, и на $nm$). \smallskip

\textbf{b. } Можно записать $x^{2} = a + qn$ с $q \in \mathbb{Z}$. Сравнение
\begin{equation*}
	(x+yn)^{2} = x^{2} + 2xyn + y^{2}n^{2} \equiv a + (q + 2xy)n \text{ (mod } n^{2})
\end{equation*}
показывает, что для сравнния $(x+yn)^{2} \equiv a \text{ (mod } n^{2})$ достаточно доказать, что $q+2xy \equiv 0 \text{ (mod } n)$. Элемент $2x$ обратим по модулю $n$ (по предположению) и сравнение $q + (2x)y \equiv 0 \text{ (mod } n)$ имеет решение $y = -q(2x)^{-1}$. Отсюда получаем, что $a$ является квадратичным вычетом по модулям $n^{2}, \, n^{4}, \, n^{8} \, \ldots $, а потому $a$ --- квадратичный вычет по модулю любой степени $n$. \smallskip

\textbf{c. } Пусть $x$ --- решение сравнения $x^{2} \equiv a \text{ (mod } 2^{k})$ и поищем решение того же сравнения по модулю $2^{k+1}$ в виде $x+y2^{k-1}$. Так как $2(k-1) \ge k+1$, то
\begin{equation*}
	(x+y2^{k-1})^{2} = x^{2}+ xy2^{k} + y^{2}2^{2(k-1)} \equiv x^{2} + xy2^{k} \text{ (mod } 2^{k+1}),
\end{equation*}
откуда $(x+y2^{k-1})^{2} \equiv a + q2^{k} + xy2^{k} \text{ (mod } 2^{k+1})$. Поэтому достаточно взять $y$ такое, что $q + xy$ четно, а это можно сделать, взяв $y$ той же четности, что и $q$ ($x$ нечетно). \par
Отсюда заключаем, что $a$ --- квадрат по модулю $2^{k} \ge 8$ тогда и только тогда, когда $a$ квадрат по модулю $8$. Группа обратимых по модулю $8$ элементов есть \{$1$, $3$, $5$, $7$\}, а подгруппа квадратов --- \{$1$\}. \\

\newexercise{\textbf{Элементрарное вычисление ($\frac{-3}{p}$)}} \\

\textbf{b. } Дискриминант трехчлена $X^{2} + X + 1$ равен $-3$ и этот трехчлен, следовательно, имеет корень $x_{0}$ в $\mathbb{Z}/p\mathbb{Z}$. Тогда этот корень $x_{0}$ удовлетворяет следующим условиям:
\begin{equation*}
	x_{0} \neq 1, \qquad x_{0}^{3} - 1 = (x_{0} - 1)(x_{0}^{2}+x_{0}+1) = 0,
\end{equation*}
а значит, $x_{0}$ --- элемент порядка $3$ в группе обратимых по модулю $p$ элементов. Поэтому $3$ делит порядок этой группы, т.е. $3$ | $p - 1$, что и требовалось доказать. \smallskip

\textbf{c. } Если $\omega$ порождает граппу $U(\mathbb{Z}/p\mathbb{Z})$, то $x_{0} = \omega^{(p-1)/3}$ --- элемент порядка $3$. Многочлен $X^{2} + X + 1$ имеет корень $x_{0}$, а его дискриминант равен $-3$ и является квадратом: $-3 = (2x_{0}+1)^{2}$. В действительности речь идет о хорошо известном равенстве $j = (-1+\sqrt{-3})/2$, где $j$ --- кубический корень из $1$. \par
Можно не использовать то, что $U(\mathbb{Z}/p\mathbb{Z})$ циклическая, а рассмотреть многочлен $X^{(p-1)/3} - 1$ с коэффициентами из $\mathbb{Z}/p\mathbb{Z}$. Поскольку степень этого многочлена строго меньше $p - 1$, то сущствует элмент $y \in U(\mathbb{Z}/p\mathbb{Z})$, не являющийся корнем $X^{(p-1)/3} - 1$. Элемент $x_{0} = y^{(p-1)/3}$ тогда имеет порядок 3\ldots  \\

\newexercise{\textbf{Другой способ вычисления ($\frac{2}{p}$)}} \\

Пусть $p \equiv 1 \text{ (mod } 4)$. Можно записать произведение $\pi = 2^{\frac{p-1}{2}} (\frac{p-1}{2})!$ в виде двух произведений, имеющих по $\frac{p-1}{4}$ множителей каждое:
\begin{equation*}
	\pi = 2 \cdot 4 \cdot 6 \ldots  (p-3) \cdot (p-1) = (2 \cdot 4 \cdot 6 \ldots  \frac{p-1}{2}) \times (\frac{p+3}{2}\ldots p-1).
\end{equation*}
Не изменяя значение по модулю $p$, заменим $x$ на $-(p-x)$ во втором произведении:
\begin{gather*}
	\pi = (-1)^{\frac{p-1}{4}}(2 \cdot 4 \cdot 6 \ldots  \frac{p-1}{2}) \times (\frac{p-3}{2} \frac{p-5}{2} \ldots  1) = (-1)^{\frac{p-1}{4}}(\frac{p-1}{2})! \\
	\Rightarrow (\frac{2}{p}) = (-1)^{\frac{p-1}{4}}. 
\end{gather*}
Проделаем то же самое при $p \equiv 3$ (mod $4$), но на этот раз возьмем первое произведние из $\frac{p-3}{4}$ множителей, а второе из $\frac{p+1}{4}$:
\begin{equation*}
	\pi = (2 \cdot 4  \ldots  \frac{p-3}{2}) \times (\frac{p+1}{2}\ldots p-1),
\end{equation*}
Проведя вычисления, аналогичные проведенным выше, получим $(\frac{2}{p}) = (-1)^{\frac{p+1}{4}}$. Можно проверить, что, используя дополнение к квадратичному закону взаимности, мы получим тот же результат. \\

\newexercise{\textbf{Прямые следствия закона взаимности}} \\

Используя квадратичный закон взаимности, видим, что \\


\noindent{3 --- квадрат по модулю $p \Leftrightarrow p = 2$ или $p \equiv \pm 1 \text{ (mod } 12)$,} \\
5 --- квадрат по модулю $p \Leftrightarrow p = 2$ или $p \equiv \pm 1 \text{ (mod } 5)$, \\
7 --- квадрат по модулю $p \Leftrightarrow p = 2$ или $p \equiv \pm 1, \pm 3, \pm 9 \text{ (mod } 29)$. \\

\newexercise{\textbf{Символ Якоби}} \\

\textbf{a. } Искомая сложность --- порядка $\mathcal{O}(\text{log}\,p)$ оперций по модулю $p$.\smallskip

\textbf{b. } Предположим, что $(\frac{a}{b}) = 1$ для всякого $a$, обратимого по модулю $b$. Пусть $b = p_1^{{\alpha}_1}\ldots p_k^{{\alpha}_k}$ --- разложение на простые множители. Можно найти такой $x \in U(\mathbb{Z}_b)$, что $x$ --- квадратичный невычет по модулю $p_1$ и $x \equiv 1 \text{ (mod } p_i)$ для $i \ge 2$. Тогда $(\frac{x}{b}) = (-1)^{{\alpha}_1} = 1$, откуда ${\alpha}_1$ --- четно. Аналогично, все ${\alpha}_i$ четны и $b$ является \textbf{квадратом}. Обратное очевидно. \smallskip

\textbf{c. } Докажем, что $(\frac{-1}{b}) = (-1)^{\frac{b-1}{2}}$. Если $p_1,\ldots ,p_r$ --- разложение на простые множители \textit{нечетного} числа $b$, то, по определению, $(\frac{-1}{b}) = (-1)^x$ с $x = \sum_{i = 1}^r \frac{p_i - 1}{2}$. Если $p$ и $q$ --- два \textbf{нечетных} числа, то $\frac{pq - 1}{2} \equiv \frac{p-1}{2} \frac{q-1}{2}$ (mod $2$) (заметим, что $(p-1)(q-1)$ делится на $4$), а значит, $\sum_{i = 1}^r \frac{p_i - 1} {2} \equiv \frac{p_1\ldots p_r - 1}{2}$ (mod~$2$). Отсюда получаем, что $(\frac{-1}{b}) = (-1)^{\frac{b-1}{2}}$. \par
Аналогично, используя то, что $\frac{(pq)^2-1}{8} \equiv \frac{p^2-1}{8} \frac{q^2-1}{8}$ (mod $2$) для \textbf{нечтных} $p$ и $q$ ($(p^2-1)(q^2-1)$ делится на $64$), докажем: $(\frac{2}{b}) = (-1)^{\frac{b^2-1}{8}}$. \par
Для доказательства закона взаимности запишем $a = p_1\ldots p_r$, $b = q_1\ldots q_s$. Можем считать, что $a$ и $b$ взаимно просты и, следовательно, $p_i \neq q_j$.
\begin{gather*}
	\left( \frac{a}{b} \right) \left( \frac{b}{a} \right) = \prod\limits_{j = 1}^s \left( \frac{a}{q_j} \right) \prod\limits_{i = 1}^r \left( \frac{b}{p_i} \right) = \prod\limits_{i = 1}^r \prod\limits_{j = 1}^s \left( \frac{p_i}{q_j} \right) \prod\limits_{j = 1}^s \prod\limits_{i = 1}^r \left( \frac{g_j}{p_i} \right) = \prod\limits_{i,j} \left( \frac{p_i}{q_j} \right) \left( \frac{q_j}{p_i} \right) \\
	\\
	=(-1)^{\sum\limits_{i,j} \frac{p_i - 1}{2} \frac{q_j - 1}{2}} = (-1)^{\sum\limits_{i = 1}^r \frac{p_i - 1}{2} \sum\limits_{j = 1}^s \frac{g_j -1}{2}} = (-1)^{\frac{a-1}{2} \frac{b-1}{2}}.
\end{gather*}

\textbf{d. } Тождество $(\frac{a}{b}) = (\frac{b \text{ mod } a}{a})(-1)^{\frac{(a-1)(b-1)}{4}}$, применимое к нечетным числам $a > b \ge 3$, наводит на мысль о том, что символ Якоби можно вычислить с помощью последовательности евклидовых делений. Надо все-таки то, что $b$ mod $a$ не обязательно останется нечетным. В этом случае используем следующее:
\begin{equation*}
	\left( \frac{2^k a}{b} \right) = (-1)^{k \frac{b^2 -1}{8}} \left( \frac{a}{b} \right).
\end{equation*}
Множитель $(-1)^{k \frac{b^2 -1}{8}}$ равен $-1$ тогда и только токда, когда $k$ нечетно, а $b$~mod~$8 = \pm 3$.

\definecolor{light-gray}{rgb}{0.8,0.8,0.8} 
\begin{center}
\fbox{ \begin{minipage}{30em}
	int $a$ = fmod($u$, $v$); \par
	int $b$ = $v$; \par
	int $J$ = $1$; \par
	for ( ; ; ) \{ \par
	\quad if ($a$ == $0$) return $0$; \par
	\quad if (($a$ \& $1$) == $0$) \{ \colorbox{light-gray}{$0 \le a < b$, $b$ нечетное $\ge 3$ и $(\frac{a}{b})J = (\frac{u}{v}$)} \par
	\quad \quad int $k$ = $0$; \par
	\quad \quad do \{ \par
	\quad \quad \quad a \textbackslash = $2$; \par
	\quad \quad \quad $k++$; \par
	\quad \quad \} while (($a$ \& $1$) == $0$); \par
	\quad \quad if (($k$ \& $1$) == $1$ \&\& fabs(fmod($b$, $8$)) == $3$) $J$ = -$J$;\par
	\quad \} \par
	\quad \colorbox{light-gray}{$0 \le a < b$, $a,\,b$ нечетны, $b \ge 3$ и $(\frac{a}{b})J = (\frac{u}{v}$)} \par
	\quad if ($a$ == $1$) return $J$; \par
	\quad if (fmod($a$, $4$) == $3$ \&\& fmod($b$, $4$) == $3$) $J$ = -$J$; \par
	\quad int $c$ = $a$; \par
	\quad $a$ = fmod($b$, $a$); \par
	\quad $b$ = $c$; \par
	\}
\end{minipage}}
\end{center}
\begin{center}
	\textbf{Алгоритм 11. }Вычисление символя Якоби $(\frac{a}{b})$ \par
	($u \in \mathbb{Z}$, $v$ --- нечетно и $\ge 3$)
\end{center}
Указания: присваивание ($a$ = fmod($u$, $v$) и int $b$ = $v$, возникающее в  начале алгоритма 11, делает положительным первый операнд $а$ вычисляемого символа Якоби; последующие операции обеспечивают то, что $a$~остается~$\ge~0$. Приведем требуемые вычисления: 
\begin{align*}
	\left( \frac{713}{1009} \right) &= \left( \frac{1009}{713} \right) = \left( \frac{1009-713}{713} \right) = \left( \frac{296}{713} \right) = \left( \frac{2^3 \cdot 37}{713} \right) \\
	&= \left( \frac{2}{713} \right) \left( \frac{37}{713} \right) = \left( \frac{37}{713} \right) = \left( \frac{713}{37} \right) = \left( \frac{713 - 19 \cdot 37}{37} \right) = \left( \frac{10}{37} \right) \\
	&= \left( \frac{2}{37} \right) \left( \frac{5}{37} \right) = \left( \frac{5}{37} \right) = \left( \frac{37}{5} \right) = \left( \frac{37 - 7 \cdot 5}{5} \right) = \left( \frac{2}{5} \right) = 1,
\end{align*}
а потому $713$ --- квадрат по модулю $1\,009$ (фактически $210^2 \equiv 713$ (mod $1\,009$)). Число $713$ непростое: $713 = 23 \cdot 31$, и аналогичные  вычисления дают, что ни $23$, ни $31$ не есть квадраты по модулю $1\,009$. \\

\newexercise{\textbf{Символ Якоби: подход Золотарева}} \\

\textbf{a. } Достаточно расмотреть модель цикла $(123\ldots l)$: инверсиями являются пары $(i,l)$ с $i < l$, но можно также записать $(123\ldots l)$ в виде произведения транспозиций $(12)(23)\ldots (l-1)(l)$. В любом случае знак этого цикла равен $(-1)^{l-1}$. \par
Достаточно рассмотреть случай $s = 2$ и такое упорядочение, что $I_1 < I_2$. Тогда имеем объединение непересекающихся множеств Inv$_{\sigma} = $Inv$_{{\sigma}_1}~\cup~$Inv$_{{\sigma}_2}$, откуда и следует результат. Аналогично, рассматривая инверсии, получим ${\varepsilon} (\sigma \times \ \tau) = \varepsilon (\sigma)^{|J|} \varepsilon (\tau)^{|I|}$. \smallskip

\textbf{b. } В обоих случаях достаточно посчитать число инверсий. \smallskip

\textbf{c. } Отображение $x \to -x$ инволютивно. В $\mathbb{Z}_n$ (а так же в абелевой группе порядка $n$) с нечетным $n$ это отображение имеет неподвижную точку $0$ и имеет знак $(-1)^{\frac{n-1}{2}}$. Если $n$ четно, то имеется две неподвижных точки ($0$ и $\frac{n}{2})$ и знак равен $-(-1)^{\frac{n}{2}}$. В обоих случаях это получается из $(-1)^{\frac{(n-1)(n-2)}{2}}$, что можно найти, замечая, что отображение $x \to -x$ меняет порядок $\mathbb{Z}_n$ --- $\{0\}$ на противоположный.\par
Отображение $x \to x+1$ --- цикл длины $n$, и его знак равен $(-1)^{n-1}$. Отображение $x \to x+r$ --- $r$-я степень отображения $x \to x+1$, a потому его знак равен $(-1)^{r(n-1)}$. \smallskip

\textbf{d. } Первое свойство тривиально, второе следует из ${\pi}_{n n', m} = {\pi}_{n,m} \circ {\pi}_{n',m}$. Вычисление $(-1 | m)$ сводится к изучению отображения $x \to -x$. Наконец, если $m = 2q + 1$ , то умножение на $2$ в $\mathbb{Z}_m$ дает подстановку:
$$ \begin{pmatrix}
	0& 1& 2& \qquad q& q+1& q+2& \qquad 2q \\
	0& 2& 4& \qquad 2q& 1& 3& \qquad 2q-1
\end{pmatrix}, $$
число инверсий которой равно $1+2+ \cdots +q = \frac{q(q+1)}{2} = \frac{m^2-1}{8}$. \par
Если $p$ --- простое, то формула $\varepsilon ({\pi}_{n,p}) = \prod_{i < j} \frac{{\pi}_{n,p} (j) - {\pi}_{n,p} (i)}{j-i}$ может быть вычислена в $\mathbb{Z}_p$ (поскольку это поле, то можно делить на  любой ненулевой элемент). По модулю $p$ получаем $\varepsilon ({\pi}_{n,p}) = \prod_{i<j} \frac{nj-ni}{j-i} = \prod_{i<j} n = n^{\frac{p(p-1)}{2}} = n^{\frac{p-1}{2}}$. Можно было также рассмотреть циклы при умножении на $n$. Докажите, $\varepsilon ({\pi}_{n,p}) = (-1)^{(r-1) \frac{p-1}{r}}$, где $r$ --- порядок $n$ по модулю $p$, что дает $(-1)^{\frac{p-1}{r}}$. Если $r$ четно, то $x^{\frac{r}{2}} = -1$ и, следовательно, $x^{\frac{p-1}{2}} = (x^{\frac{r}{2}})^{\frac{p-1}{r}} = (-1)^{\frac{p-1}{r}}$. Если $r$ нечетно, то $x = (x^{\frac{r+1}{2}})^2$, а потому $x^{\frac{p-1}{2}} = 1 = (-1)^{\frac{p-1}{r}}$. \smallskip

\textbf{e. } Подстановка $\sigma$ оставляет на месте множество $[0,n-1] \times \{j\}$, a сужение ${\sigma}_j$ подстановки $\sigma$ на $[0,n-1] \times \{j\}$ --- отображение $i \to mi + j$ группы $\mathbb{Z}_n$ на себя. Поскольку знак сдвигов равен $1$ ($n$ и $m$ нечетны), то $\varepsilon ({\sigma}_j) = \varepsilon ({\pi}_{m,n}) = (m|n)$ и, следовательно, $\varepsilon (\sigma) = (m|n)^m = (m|n)$. Доказательство для $\tau$ аналогично. Если обозначим через Ch : $[0,n-1] \times [0,m-1] \to [0,nm-1]$ китайский изоморфизм, то Ch$(\sigma (i,j)) = mi+j$ и Ch$(\tau(i,j)) = nj + i$, что дает
\begin{equation*}
	\text{Ch} \circ \tau = \theta \circ \text{Ch} \circ \sigma,
\end{equation*} 
\noindent{где $\theta$ : $[0, nm-1] \to [0,nm-1]$ --- инволюция, которая изменяет  нумерацию $(\theta (mi+j) = nj+i)$. Отображение $\theta$ сопряжено с  отображением, которое переставляет две структуры лексикографического упорядочения множества $[0, n-1] \times [0,m-1]$, а потому его ранг равен $(-1)^{\frac{n(n-1)}{2}\frac{m(m-1)}{2}} = (-1)^{\frac{n-1}{2} \frac{m-1}{2}}$. Отсюда $\varepsilon (\tau) = (-1)^{\frac{n(n-1)}{2} \frac{m(m-1)}{2}} \varepsilon (\sigma)$, что и требовалось доказать.} \smallskip

\textbf{f. } $(2|m)$ можно вычислить, используя соотношения
\begin{align*}
	(2|m+2) & = (-m|m+2) = (-1)^{\frac{m+1}{2}} (m|m+2) = \\
	& = (-1)^{\frac{m+1}{2}}(m+2|m) = (-1)^{\frac{m+1}{2}}(2|m)
\end{align*}
и применяя индукцию по $m$. Мультипликативность символа Золотарева по второму аргументу следует из мультипликативности по первому и закона взаимности. Символ Золотарева $(n|m)$ и символ Якоби $(\frac{n}{m})$ совпадают при простом $m$ (благодаря критерию Эйлера), а значит, совпадают при любом $m$. \\

\newexercise{\textbf{Некоторые простые числа, для которых $2$ --- примитивный корень}} \\

Порядок элемента в группе $U(\mathbb{Z}_p)$ делит $p — 1 = 4q$, а так как $q$ --- простое, то этот порядок принадлежит множеству $\{2,4,q,2q,4q\}$. Но с другой стороны, не выполняется ни $2^4 \equiv 1$ (mod $p$) (в противном случае $p = 3$ или $p = 5$, что невозможно ввиду ограничений на $p$), ни $2^{2q} \equiv 1$ (mod $p$), поскольку
\begin{equation*}
	2^{2q} = 2^{\frac{p-1}{2}} \equiv \left( \frac{2}{p} \right) = -1, \text{ ибо } p \equiv 5 \text{ (mod } 8),
\end{equation*}
а поэтому порядок элемента $2$ не делит ни $4$, ни $2q$, а значит, равен $4q$. \par
Аналогично, $2^q = 2^{\frac{p-1}{2}} \equiv (\frac{2}{p}) = -1$, ибо $p \equiv 3$ (mod $8$). Порядок элемента $2$ делит $2q$ и не делит $q$, а значит, этот порядок равен $2q$. \par
Имеем $(-2)^q = -2^q = -2^{\frac{p-1}{2}} \equiv -(\frac{2}{p}) = -1$, поскольку $p \equiv 7$ (mod $8$). Таким же образом делаем вывод относительно $-2$. \\ 

\newexercise{\textbf{Вычисление длины периода: метод Флойда}} \\

\textbf{a. } Очевидно, $x_n = x_{2n}$ тогда и только тогда, когда $n \ge \mu$ и $n \equiv 0$ (mod $\lambda$) ($\mu$ — индекс вхождения в период, $\lambda$ — длина периода), поэтому в качестве $n$ достаточно взять первое число, кратное $\lambda$ и не меньшее $\mu$. Если $x_m = x_{2m}$, то $m \ge \mu$ и $m \equiv 0$ (mod $\lambda$), а значит,  $n = m$ (mod $\lambda$), откуда $x_n = x_m$. \smallskip

\textbf{b. } Пусть $S$ --- подгруппа всех функций из $F$ в $F$, а $\Phi$ такая функция, которая элементу $g \in S$ ставит в соответствие функцию $g \circ f \in S$. Применим предыдущий результат к функции $\Phi$ с начальным членом последовательности Id$_{F}$: существует такое $n$, что ${\Phi}^n (\text{Id}_{F}) = {\Phi}^{2n} (\text{Id}_{F})$, т.е. $f^n = f^{2n}$. \\

\newexercise{\textbf{Линейные генераторы: изучение частных случаев}} \\

\textbf{a. } Имеем $x_n = (a^n x_0 + S_n (a)b)$ mod $m$, где $S_n (a) = 1 + a + \cdots + a^{n-1}$. Если $n = \sup\limits_{i} {\alpha}_i,$ то ${\alpha}^n \equiv 0$ (mod $m$), а потому $x_n = x_{n+1}$. Индекс вхождения меньше или равен max(${\alpha}_i$). \smallskip

\textbf{b. } Очевидно, $x_n = S_n (a)$ и, следовательно, $(a-1)x_n = a^n - 1$.  Поскольку $a$ обратимо по модулю $m$, то существует такое $n$, что $a^n = 1$, а это эквивалентно тому, что $x_n = 0 = x_0$ (так как $a-1$ обратимо по модулю $m$). Откуда и следует искомый результат (индекс вхождения в период равен $0$). Для двух примеров соответственно выполняется $\lambda = 4$ (порядок $8$ в $U(\mathbb{Z}_{15})$) и $\lambda = 18$ ($2$ порождает $U(\mathbb{Z}_{27})$). \smallskip

\textbf{c. } Используем китайскую теорму об остатках, соответсвенно находим $\lambda = 6, \lambda = 20$, $\lambda = 10$ и $\lambda = 6$. \\

\newexercise{\textbf{Линейные генераторы: частные случаи аффинных преобразований}} \\

\textbf{a. } Из $y_{n+1} = ay_n +1$ и $x_i = {\alpha}y_i +\beta$ получаем $x_{n+1} = ax_n + \alpha + \beta (1 -a)$. Равенство $y_0 = 0$ дает $\beta = x_0$, откуда $\alpha = b+x_0 (a -1)$.\smallskip

\textbf{b. } Известно, что
\begin{align*}
	\alpha y \equiv 0 \text{ (mod } m) &\Longleftrightarrow \text{НОД} (\alpha,m)y \equiv 0 \text{ (mod } m) \\
	&\Longleftrightarrow y \equiv 0 \text{ (mod } m\text{/НОД}(\alpha,m)).
\end{align*}
Если $m' = m\text{/НОД}(\alpha,m)$, то $\varphi (y) \equiv \varphi (z)$  (mod $m$) тогда и только тогда, когда $y \equiv z$ (mod $m'$). Следовательно, последовательности $(x_n)_{n \ge 0}$ и $(y_n)_{n \ge 0}$ имеют одну и ту же длину периода и одинаковые индексы вхождения в период.
\begin{align*}
	x_{n+1} = 12x_n + 7 \text{ mod } &45, x_0 = 1 \longrightarrow \alpha = 18, \\
	m' &= 5, y_{n+1} = 2y_n + 1 \text{ mod } 5, \\
	x_{n+1} = 12x_n + 3 \text{ mod } &45, x_0 = 2 \longrightarrow \alpha = 25, \\
	m' &= 9, y_{n+1} = 3y_n + 1 \text{ mod } 9, \\ 
	x_{n+1} = 11x_n + 10 \text{ mod } &45, x_0 = 1 \longrightarrow \alpha = 20, \\
	m' &= 9, y_{n+1} = 2y_n + 1 \text{ mod } 9,
\end{align*}

\newexercise{\textbf{Порядок элемента $1+p$ в $U(\mathbb{Z}_{p^r})$}} \\

Длина периода последовательности $(x_n)_{n \ge 0}$ не что иное, как порядок $1+p$ в $U(\mathbb{Z}_{p^r})$. Но последовательность $(y_n)_{n \ge 0}$ имеет ту же длину периода, что и $x$. Итак, $\alpha = p$ и, следовательно, $m' = p^{r-1}$. Можно применить к последовательности $(y_n)_{n \ge 0}$ теорему $47$: эта  последовательность максимального периода $(p^{r-1})$. То, что $(1+p)$ имеет порядок $p^{r-1}$ в $U(\mathbb{Z}_{p^r})$, связано с тем, что подстановка $y \to (1+p)y+1$ является циклом в $\mathbb{Z}_{p^{r-1}}$. \\

\newexercise{\textbf{Последовательности, порожденные сравнниями}} \\

Единственный случай, который представляет проблему, --- это $p = 2$, $a \equiv 3$ (mod $4$); случай $a \equiv -1$ (mod $2^n$) прост, поскольку $x_{k+1} = -x_k +1$, а значит, $x_{k+2} = x_k$. Рассмотрим случай $a \not\equiv -1$ (mod $2^n$).Поскольку $x \to ax+1$ --- перестановка из $\mathbb{Z}_{2^n}$, то индекс вхождения в период равен $0$, а поэтому, длина периода --- это наименьшее число $\lambda$ с $x_{\lambda} = x_0$. Напомним, что $x_k = S_k (a)$ и $x_0 = 0$. Итак, записывая $a^q - 1 = S_q(a)(a-1)$, имеем:
\begin{equation*}
	S_q(a) \equiv 0 \text{ (mod } 2^n) \Longleftrightarrow a^q \equiv 1 \text{ (mod } 2^{n+1}),
\end{equation*}
откуда $\lambda = q$ где $q$ --- порядок $a$ в $U(\mathbb{Z}_{2^{n+1}})$. Предположение $a \equiv 3$ (mod $4$) и $a \not \equiv -1$ (mod $2^n$) приводит к тому, что $q$ --- удвоенный  порядок $a$ в $U(\mathbb{Z}_{2^n})$. \\

\newexercise{\textbf{Линейные генераторы: синтез}} \\

Изменяя модуль $m$ при помощи аффинного преобразования  (упражнение 37), можно считать, что $b = 1$ и $x_0 = 0$. Теперь можно  использовать китайскую теорему об остатках, которая сводит модуль к степени простого числа, а затем --- таблицу из упражнения 39. Для приведенного примера $\alpha = 130$, $m' = 315$/НОД($130,315$) $ = 63$, $y_{n+1} = 16y_n + 1$ mod $63$. Длина периода $y$ по модулю $7$ равна $3$ (так как $16 = 2$ в $\mathbb{Z}_7$ и $2$ имеет порядок $3$), длина периода $y$ по модулю $9$ равна $9$ ($16 \equiv 1$ (mod $3$)), а значит, длина периода $y$ (а потому и $x$) равна $9$. \\

\newexercise{\textbf{Многошаговые линейные генераторы}} \\

\textbf{a. } Полезно рассмотреть отображение $\theta$ : $F^k \to F^k$, заданное следующим образом:
\begin{equation*}
	\theta ({\alpha}_1,{\alpha}_2,\ldots ,{\alpha}_{k-1}, {\alpha}_k) = ({\alpha}_2,{\alpha}_3,\ldots ,{\alpha}_k,f({\alpha}_1,{\alpha}_2,\ldots ,{\alpha}_k)).
\end{equation*}
Понятно, что существует биекция между последовательностями $(x_n)_{n \ge 0}$, значения которых лежат в $F$ (и которые определяются при помощи функций $f$), и последовательностями $(X_n)_{n \ge 0}$ в $F^k$  (определенными при помощи одношагового генератора $\theta$). Это доказывает, в частности, ограничения, касающиеся длины периода. \par
Соображения, используемые в теории графов (эйлеровы циклы), позволяют доказать, что для всякой пары $(k,q)$ существуют $k$-шаговый генератор на множестве $[1,q]$, имеющий период длины $q^k$ (см. [$18$]). Например, для $q = 3$, $k = 4$ это означает, что существует последовательность длины $3^4 = 81$, т.е. $(x_0,x_1,x_2,\ldots ,x_{80})$, такая, что $81$ тройка $(x_i,x_{i+1},x_{i+2})$ (индексы по модулю $81$) различны. \par
Пусть $b$ --- фиксированный элемент, отличный от $a$. Определим $g$ : $F^k~\to~F$ следующим образом: $g(b,a,a,\ldots ,a) = a, \, g(a,a,a,\ldots ,a) = f(a,a,a,\ldots ,a)$ и $g = f$ в остальных случаях. Тогда $g$ определяет последовательность, длина периода которой равна $q^k$ (группа символов $(a,a,a,\ldots ,a)$ появляется сразу после группы $(b,a,a,\ldots ,a)$). \smallskip

\textbf{b. } Хотя матрицы $A$ и $B$ имеют те же самые алгебраические  свойства (позже будет доказано, что они сопряжены в основном кольце), предпочтительнее выбрать $B$ в виде циклической матрицы. Вычисление характеристического многочлена производится непосредственно (для $A$ или $B$). Например, разлагая по последней строке матрицу
\begin{equation*} 
	X\text{Id}_k - A =
	\begin{pmatrix}
		X & -1 & \qquad 0 & 0 \\
		\vdots & X & \qquad \vdots & \vdots \\
		0 & 0 & \qquad -1 & 0 \\
		0 & 0 & \qquad 0 & -1 \\
		-a_0 & -a_1 & \qquad -a_{k-2} & X - a_{k-1}
	\end{pmatrix},
\end{equation*}
получим характеристический многочлен:
\begin{align*}
	(-1)^{k-1} \Bigl( -a_0(-1)^{k-1} &+ a_1 (-1)^{k-2}X - a_2(-1)^{k-3}X^2 + \\
	&+ \cdots + (-1)^{k-1}(X-a_{k-1})X^{k-1} \Bigr),
\end{align*}
т.е. $-a_0-a_1 X - a_2 X^2 - \cdots - a_{k-1}X^{k-1} + X^k = P(X)$. \par
Теперь понятно, что вектор $e_1$ порождает $E_B$, ибо $e_2 = B \cdot e_1, \dots, e_k = B^{k-1} \cdot e_1$ . Ясно также, что $B^k \cdot e_1 = a_0 e_1 + \cdots + a_{k-1}e_k$, что  записывается как $P(B) = 0$, откуда $P(B)(B^i \cdot e_1) = 0$, а потому $P(B) = 0$: фактически мы доказали теорему Гамильтона — Кэли для матрицы Фробениуса (или транспонированной к ней). Легко установить, что $P$ является и минимальным многочленом. \par
То, что $e_k$ порождает $A$, доказывается немного проще: $A e_k = e_{k-1}+a_{k-1}e_k$, откуда $e_{k-1} \in K \cdot e_k \oplus K \cdot A \cdot e_k$, затем $e_{k-2} \in K \cdot e_k \oplus K \cdot A \cdot e_k \oplus K \cdot A^2 \cdot e_k$. Нетрудно доказать, что $\{f_1,f_2,\dots,f_k\} = \{e_k, A \cdot e_k, A^2 \cdot e_k, \dots, A^{k-1} \cdot e_k\}$ --- базис $E$. В этом базисе матрица $A$ является матрицей Фробениуса. В действительности это матрица $B!$ Достаточно,  например, принять во внимание то, что $A$ и $B$ — транспонированные одна к другой и имеют один и тот же характеристический многочлен. Но можно это увидеть, транспонируя соотношение $B^k = a_{k-1}B^{k-1}+\cdots+a_0$, что дает $A^k = a_{k-1}A^{k-1}+\cdots+a_0$ и
\begin{equation*}
	B \cdot f_k = B^k \cdot f_1 = a_{k-1}f_{k-1}+\cdots+a_0f_1.
\end{equation*}
Следует отметить, что мы не пользовались тм, что $K$ --- поле! \smallskip

\textbf{с. } Множество $\{R \in K[X] \, | \, R(A) \cdot e_k \in F\} = \{R \in K[X] \, | \, R(A) \cdot x \in F, \forall x \in E\}$ является идеалом в $K[X]$, содержащим $P$. Единственный унитарный порождающий его многочлен $Q$ является решением задачи. \smallskip

\textbf{d. } Для $X_i = A^i X_0$ и $X_j = A^j X_0$ предположим, что $X_i = X_j$.  Матрица $A$ обратима ($det A = \pm a_0$ не равен нулю, так как $P(X)$ неприводим), а значит, $A^{j-i}X_0 = X_0$. Множество таких $X \in K^k$, что $A^{j-i}X = X$, --- подпространство, инвариантное относительно действия $A$ и  содержит ненулевой вектор $X_0$. Значит, оно равно $E$ откуда $A^{j-i} =$ Id$_E$ и, следовательно, минимальный многочлен матрицы $A$ делит $X^{j-i} - 1$: $P(X) \, | \, X^{j-i} - 1$. Обратное очевидно. Следовательно, длина периода равна наименьшему числу $\lambda$ с $P(X) \, | \, X^{\lambda} - 1$, т. е. порядку $\bar{X}$ в $K[X]/P$. \smallskip

\textbf{e. } Если $\Omega$ --- некоторое расширение $K$, в котором $P(X)$ имеет  корень $y$, то отображение $K[x] \in Q \to Q(y) \in \Omega$ ---гомоморфизм, ядром которого является в точности идеал, порожденный многочленом $P$ (ибо $P$ неприводим), что дает изоморфизм $K[X]/P$ в $\Omega$. \par
Для любого $k$ существует $K$-расширение $L$ степени $k$. Если $P$  обозначает минимальный многочлен порождающего элемента  мультипликативной группы $L^*$, то $P$ имеет (по построению) корень порядка $q^k-1$ и это, следовательно, примитивный многочлен. \smallskip

\textbf{f. } Пусть $p^k$ --- степень простого числа $p$. Располагая $k$-шаговым  линейным генератором с периодом $p^k-1$ и используя замечание вопроса $a$ относительно $(0,0,\dots,0)$, построим $k$-шаговый генератор с периодом длины $p^k$. Например, примитивный многочлен $X^3+2X^2+1$ порождает $3$-шаговую последовательность с длиной периода $26$:
$$
	00111021121010022201221202 \quad 00111021121010022201221202\dots ,
$$
в которую можно включить $0$ после получения $3$-шаговой последовательности с длиной периода $27$.\par
Имея два $k$-шаговых генератора $f$ : $F^k \to F$ и $g$ : $G^k \to G$, можно определить их декартово произведение $f \times g$ : $(F \times G)^k \to F \times G$. Длина периода $f \times g$ равна НОК длин периодов множителей. Пусть $F \simeq F_1 \times \cdots \times F_r$, где порядок каждого $F_i$ простой. Для каждого $F_i$, существует $k$-шаговый генератор длины $|F_i|^k$. Их декартово произведение является искомым $k$-шаговым генератором. \\

\newexercise{\textbf{Псевдопростые числа}} \\

\textbf{a. } Сравнения $S_q(b) \equiv q$ (mod $2$) и $S_q(b) \equiv S_q(1) = q $ (mod $b-1$) 
показывают, что $S_q(b)$ нечетно и взаимно просто с $b-1$. \par
Сравнение $b^q \equiv 1$ по модулю $S_q(b)$ является прямым следствием определения $S_b(q)$. Поскольку оно остается верным, если $q$ заменить на кратное для $q$, то достаточно доказать, что $2q$ делит $S_q(b)-1$. Итак, определение $S_q(b)$ и сравнение $b^{q-1} = 1$ (mod $q$) приводят к $(b-1)S_q(b) = b^q -1 \equiv b-1$ (mod $q$), откуда, сокращая на $b-1$,  получаем $S_q(b) \equiv 1$ (mod $q$). Число $S_q(b)-1$ делится на $q$ и на 2, а значит, и на $2q$, что и требовалось доказать. \par 
Если $q$ --- составное, то имеется все то же $S_q(b)$. Предыдущее  свойство доказывает, что конструкция $q \to S_q(b)$ при итерировании  производит бесконечно много псевдопростых чисел, если все-таки удастся ее осуществить. Для оснований $2$, $3$, $5$ и $7$ можно взять наименьшие  псевдопростые числа, которыми являются соответственно $341 = 11 \times 31$, $91 = 7 \times 13$, $217 = 7 \times 31$ и $25$ [$148$]. \smallskip

\textbf{b. } Пусть $q$ --- простое число, не делящее $b(b^2 - 1)$. Согласно малой теореме Ферма $(b^2)^{q-1} \equiv 1$ (mod $q$). Положим $n = S_q(b^2)$ и из  предыдущего вопроса, примененного к $q$ и $b^2$, получим $b^{n-1} \equiv 1$ (mod $n$). Число $n$ --- составное, так как $S_q(b^2) = S_q(b)S_q(-b)$, а значит, $n$ —  псевдопростое по основанию $b$. \\

\newexercise{\textbf{Число Кармaйкла}} \\ 

\textbf{a. } Пусть $n$ --- число Кармайкла. Взяв $b = -1$, получим, что $n$ нечетно. Пусть $p$ --- простой делитель $n$. Существует такое $b$, что $b$ mod $p$ --- примитивный корень по модулю $p$ и $b$ mod $q = 1$ для всех других  простых делителей $q$ числа $n$ (используйте китайскую теорему об  остатках или поищите $b$ в виде $1+k \frac{n}{p}$). Тогда $b$ обратимо по модулю $n$ и $b^{n-1}$ (mod $n$) означает, что $р - 1$ делит $n - 1$. Предположим, что $p^2$ делит $n$. Пусть $n = p^{\alpha}m$ с НОД$(p,m) = 1$. Тогда получим  изоморфизм $ U(\mathbb{Z}_n) \simeq U(\mathbb{Z}_{p^{\alpha}}) \times U(\mathbb{Z}_m)$; группа $U(\mathbb{Z}_{p^{\alpha}})$ порядка $p^{\alpha - 1}(p -1)$ и, поскольку $\alpha \ge 2$, существует элемент $b \in U(\mathbb{Z}_{p^{\alpha}})$ порядка $p$: этот элемент $b$ не удовлетворяет сравнению $b^{n-1} \equiv 1$ (mod $n$), так как $p$ делит $n$, а значит, не может делить $n-1$ (впрочем можно взять $b = 1 + \frac{n}{p}$ и применить формулу бинома Ньютона). Обратное очевидно. Для доказательства того, что $k \ge 3$, предположим, что $n = pq$. Тогда $pq \equiv 1$ (mod $p-1$), откуда $q \equiv 1$ (mod $p-1$). Меняя местами $p$ и $q$ получим, что $p = q$, --- противоречие.\\

\newexercise{\textbf{Числа Кармайкла, являющиеся произведениями трех простых чисел}} \\

Воспользуемся несколько раз тривиальным сравнением
\begin{equation*}
	p_i \equiv 1 \text{ (mod } p_i - 1).
\end{equation*}

\textbf{a. } Используя то, что $p_1 p_2 p_3 \equiv 1$ (mod $p_3 - 1$), а также наше тривиальное сравнение, получаем $p_3 - 1$ | $p_1 p_2 - 1$, а значит, $r$ --- целое число; $r \neq 1$, так как $p_1 p_2 \neq p_3$ и
\begin{equation*}
	r = \frac{p_1 p_2 - 1}{p_3 - 1} < \frac{p_1 p_2}{p_3 - 1} \le \frac{p_1 (p_3 - 1)}{p_3 - 1} = p_1.
\end{equation*}

\textbf{b. } Оба сравнения очевидны. Рассмотрим по модулю $p_2 - 1$ и получим, что $p_2 - 1$ | $(p_1 - 1 + r)p_1 - r = (p_1 - 1)(p_1 + r)$. \smallskip

\textbf{c. } Обратное утверждение формулируется так. Зафиксируем $1 < r < p_1$. Для каждого \textit{простого} числа $p_2$ из интервала $[p_1 + 2, 1 + (p_1 - 1)(p_1 + r)]$ такого, что
\begin{equation*}
	(p_1 p_2 - 1 + r)p_1 \equiv r \text{ (mod } r(p_2 - 1)), \quad (p_1 p_2 - 1 + r)p_2 \equiv r \text{ (mod } r(p_1 -1)),
\end{equation*}
число $p_3 = 1 + \frac{p_1 p_2 - 1}{r}$ --- целое, и если оно простое, то оно дополняет числа $p_1$, $p_2$ до тройки Кармайкла. Действительно, из первого сравнения следует $(p_1 p_2 - 1)p_1 \equiv$ (mod $r$), т.е. $r$ | $p_1 p_2 -1$, и число $p_3$ --- целое. Кроме того,
\begin{equation*}
	p_3 = 1 + \frac{p_1 p_2 - 1}{r} > \frac{p_1 p_2 - 1}{p_1 - 1} > p_2.
\end{equation*}
Наконец, по определению, $p_3 - 1$ | $p_1 p_2 - 1$, и используя то, что $rp_3~=~p_1p_2~-~1~+~r$, а также два приведенных выше сравнения, получим $p_2 - 1$ | $p_1 p_3 - 1$ и $p_1~-~1$~| $p_2p_3~-~1$.

\begin{center}
\fbox{ \begin{minipage}{38em}
	for (r = 2; r <= p1 - 1; ++r) \{ \par
	\quad for (p2 = p1 + 2; p2 <= ((p1 - 1) * (p1 + r) + 1) ; ++p2) \{ \par
	\quad \quad if(issimple(p2)) \{ \par
	\quad \quad \quad x = p1 * p2 - 1 + r; \par
	\quad \quad \quad if (fmod(x*p1 - r, r*(p2 - 1)) == 0 \&\& fmod(x*p2 - r, r*(p1 - 1)) == 0) \{\par
	\quad \quad \quad \quad p3 = x / r; \par
	\quad \quad \quad \quad if (issimple(p3)) printf("\%d \%d \%d$\backslash$n", p1, p2, p3); \par
	\quad \quad \quad \} \par
	\quad \quad \} \par
	\quad \} \par
	\}
\end{minipage}}
\end{center}
\begin{center}
	\textbf{Алгоритм 12. } Определение чисел Кармайкла вида $p_1 p_2 p_3$ 
\end{center}
\textbf{d. } Приведем числа Кармайкла вида $rpq$ с $r = 3,\,5,\,7$ в порядке нахождения их алгоритмом 12:
\begin{gather*}
	561 = 3 \cdot 11 \cdot 17, \quad 10\,585 = 5 \cdot 29 \cdot 73, \quad 2\,465 = 5 \cdot 17 \cdot 29, \quad 1\,105 = 5 \cdot 13 \cdot 17, \\
	8\,911 = 7 \cdot 19 \cdot 67, \quad 2\,821 = 7 \cdot 13 \cdot 31, \quad 15\,841 = 7 \cdot 31 \cdot 73, \quad 6\,601 = 7 \cdot 23 \cdot 41, \\
	1\,729 = 7 \cdot 13 \cdot 19, \quad 52\,633 = 7 \cdot 71 \cdot 103.
\end{gather*}
Пусть $n$ --- число Кармайкла. Если оно содержит более трех простых множителей, то оно больше, чем $3 \times 5 \times 7 \times 11 = 1\,155$. Если $n$ имеет $3$ простых множителя, то либо разложение $n$ на простые множители содержит $3$ или $5$ (таких чисел всего $4$ и все они приведены выше), либо $n \ge 7 \times 11 \times 13 = 1\,001$. \\

\newexercise{\textbf{Числа, достигающие границы $\frac{1}{4}$ в тесте Рабина}} \\

\textbf{a. } В общем, если $n \equiv 3$ (mod $4$), то $B_n$ является подгруппой группы $U(\mathbb{Z}_n)$, состоящей из таких элементов $b$, что $b^{\frac{n-1}{2}} = \pm 1$. Кроме того, $(-1)^{\frac{n-1}{2}} = -1$, а значит, $B_n$ --- объединение непересекающихся множеств $L_n \cup (-1)L_n$, $L_n~=$ $ = \{b~\in~U(\mathbb{Z}_n) ~|~b^{\frac{n-1}{2}}~=~1\}$.\par
Для первого семейства $L_n$ равно $C_{p_1} \times Q_{p_2}$, где $C_{p_1}$ --- подгруппа индекса $2$ в $U(\mathbb{Z}_{p_1})$, образованная квадратами, a $Q_{p_2}$ --- подгруппа индекса $4$ в $U(\mathbb{Z}_{p_2})$, образованная четвертыми степенями. Следовательно, $L_n$ индекса $8$, а $B_n$ индекса $4$. Чтобы получить такие числа $n$, достаточно найти такие простые числа $p_1$, что $p_1 \equiv 3$ (mod $4$) и $p_2 = 2p_1 - 1$ --- простое. Приведем список таких $(p_1, p_2)$ с $p_1 <500$:
\begin{gather*}
	(3,\,5),\,(7,\,13),\,(19,\,37),\,(31,61),\,(79,157),\,(139,277),\,(199,\,397), \\
	(211,\,421),\,(271,\,541),\,(307,\,613),\,(331,661),\,(367,\,733),\,(379,\,757), \\
	(439,\,877),\,(499,997).
\end{gather*}
\end{document}
