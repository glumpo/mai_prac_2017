\documentclass{mai_book}

\defaultfontfeatures{Mapping=tex-text}

\setmainlanguage{russian}
\setotherlanguage{english}

\clearpage

\setcounter{page}{175}
% \setcounter{thesection}{9}

\begin{document}

\noindent Однако,

$$
1-\dfrac{v}{v_mb^m+v_{m-1}b^{m-1}} = \dfrac{v_mb^m+v_{m-1}b^{m-1}-v}{v_mb^m+v_{m-1}b^{m-1}} = - \dfrac{v_{m-2}b^{m-2}+...+v_0}{v_mb^m+v_{m-1}b^{m-1}}
$$ \linebreak 
$$ > \dfrac{-b^{m-1}}{v_mb^m+v_{m-1}b^{m-1}} \ge \dfrac{-b^{m-1}}{v_mb^m} = \dfrac{-1}{v_mb}
$$

\noindent и, следовательно, $\frac{u-\hat{q}v}{bv_m} > -u$. Оценка $\hat{q}$ по предположению отлична от $q$, так что $q = \hat{q}-1$ и поэтому

\[
u-qv = v+u-\hat{q}v > v-\dfrac{u}{v_mb} = v(1-\dfrac{u}{v}\dfrac{1}{v_mb}),
\]

\noindent и, наконец, используя то, что $u/v \le q+1 = \hat{q} \le b-1$, и предположение $v_m \ge [b/2]$, имеем:

\[
u-qv > v(1-\dfrac{b-1}{v_mb}) \ge v(1-\dfrac{2}{b}).
\]

\textbf{c.} Ясно, что $u'$ имеет вес $\le n+1$, так как $[b/(v_m + 1)]$ — цифра, и осталось доказать, что $v'$ имеет вес $m$. Рассмотрим сначала частный случай $m = 1$:

\[
1 \le v \le b-1 \Longrightarrow [b/2] \le v[b/(v+1)] \le b-1 \text{ (границы достижимы)}.
\]

\noindent Из $v[b/(v+1)] < (v+1)[b/(v+1)] \le b$ получаем правое неравенство. Докажем левое неравенство. Так как всегда $v[b/(v+1)] \ge v$, то можно предположить, что $v<[b/2]$. Тогда: $v[b/(v+1)] > v(\frac{b}{v+1} - 1) = f(v)$. Но $f(v)-f(1) = (v-1)\frac{b/2-v-1}{v+1}$. Поэтому:

\[
v < [b/2] \Longrightarrow v \le b/2-1 \Longrightarrow f(v)-f(1) \ge 0 \Longrightarrow f(v) \ge f(1) = b/2-1,
\]

откуда $v[b/(v+1)] > [b/2]-1$, что и требовалось доказать.

Перейдем к общему случаю. С одной стороны:

\[
v' = [b/(v_m+1)]v < [b/(v_m+1)](v_mb^m+b^m) = [b/(v_m+1)](v_m+1)b^m<b^{m+1},
\]

\noindent что и доказывает, что старшая цифра у $v'$ не меньше $[b/2]$.

Из деления $u'$ на $v'$ можно вывести деление $u$ на $v$. Действительно, если $u'=v'q'+r'$ и $u=vq+r$, то $q=q'$ и $r=r'/d$ (имеется ввиду точное деление числа на цифру). Окончательный алгоритм деления получается объединением алгоритмов, изученных в предыдущих упражнениях.

\pagebreak

\noindent \textbf{40. Самовоспроизводящаяся программа}

Решением задачи является следующая программа:

\begin{lstlisting}[frame=none]
with Text_IO; use Text_IO;
procedure R is
	procedure P (S : String) is
		use Ascii;
	begin
		Put_Line (S);
		Put_Line ('('& Quotation & S & Quotation &%);end R;%);
	end P;
begin
	-- специальная строка
end R;
\end{lstlisting}

В этой программе строка $10$ содержит весьма длинную инструкцию (из которой можно удалить все ненужные пробелы):

\begin{lstlisting}[frame=none]
	P("WITH Text_I0;USE Text_I0;PROCEDURE R IS PROCEDURE
P(S:String)IS USE ASCII;BEGIN Put_Line(S);
Put_Line('('&Quotation&S&Quotation&%);end R;%);
END P; BEGIN P");
\end{lstlisting}

Если нужна программа с действительно более короткими строками
(строка "$10$" содержит около $160$ символов), то это, разумеется, можнно сделать, хотя программа станет чуть длиннее. Символ " не может просто появиться в цепочке - аргументе $P$ в строке $7$, там была использована константа Quotation, определенная в пакете Ascii. Наконец, была использована одна из возможностей языка Ада, которая позволяет разграничивать цепочки символов со знаком \% если не располагаем кавычками. Все использованные уловки только укорачивают программу, но не делают ее возможной. Можно заметить, что эта программа не воспроизводит знак за знаком оригинальный исходный текст. Она порождает программу, которая эквивалентна. И пусть этот недостаток кажется неприемлемым, зато идея проста: эта программа порождает программу $P$, которая порождает $P$...

\newpage

\end{document} % 4:20