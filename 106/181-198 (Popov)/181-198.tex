
%//////////////////////////////////////
%//Begin of 181 page
%//////////////////////////////////////
%\newtop{II-1.2 $\:$ Что такое факториальное кольцо?}

\noindent \textit{нуля, то оба элемента равны } \textbf{с точностью до обратимого элемента}\textit{,
т.е. существует $\text{\textepsilon}\in\:U(A)$, такой, что $a=\text{\textepsilon}\:\!b$.}

\textit{($iii$) Элемент р $\in$ А называется} \textbf{неприводимым}\textit{, если он не является ни нулевым, ни обратимым и если его единственными делителями являются 1 и р. Более точно: р неприводим тогда и только тогда, когда d | р $\Rightarrow$ d \textasciitilde$\:$ 1 или d \textasciitilde$\:$ р. Это свойство равносильно тому, что идеал Ар является максимальным в множестве} \textbf{однопорожденных}\textit{ (т.е глав­ных) идеалов в А, отличных от А и \{0\}.}

\textit{($iv$) Если кольцо А без делителей нуля, то р — неприводимый эле­мент тогда и только тогда, когда из р = de следует, что d или е — обратимый элемент в А.}
$\:$\newline\newline
\section{\large 1.2 Что такое факториальное кольцо?}

Теперь можно дать точное определение структуры колец, обобщающей в какой-то мере структуру кольца $\mathbb{Z}$ целых чисел.

\begin{determ}[факториальность]
\textit {\indent} Кольцо А называется факториальным, если оно не имеет делителей нуля и если оно удовлетворяет основной теореме арифметики, что, формально, выражается следующим образом: \newline \indent($i$) Наличие разложения на неприводимые множители:
\begin{align*}
\forall a \in A^* \backslash U(A),\,\exists p_1 ,p_2 ,\dots,p_n , \text{\textit{неприводимые}} \\ 
\text{\textit{и такие, что}}\: a = p_1 p_2 \dots p_n . 
\end{align*}
\indent ($ii$) Единственность такого разложения:
\begin{align*}
p_1 p_2 \dots p_n \sim_A q_1 q_2 \dots q_m (p_i , q_j \text{\textit{неприводимые }}\;\Rightarrow \\
n = m \:\text{и}\: \exists \sigma, \text{\textit{перестановка на }}[1, n]\text{\textit{, такая, что }} \\
p_i \sim_A q_{q(i)} (1 \leqslant i \leqslant n) \text{.}
\end{align*}
\end{determ}
$\:$\newline\newline
В дальнейшем мы рассмотрим критерии, позволяющие распознать факториальность кольца. В настоящий момент читатель должен пове­рить, что это понятие не «бессодержательное», т.е. класс факториаль­ных колец сравнительно широк. Прежде, чем продолжать дальнейшее изучение делимости, укажем одно арифметическое приложение факториальности.

\newpage
%//////////////////////////////////////
%//Begin of 182 page
%//////////////////////////////////////
%\setcounter{page}{182}
%\newtop{II-1 $\:$ Обобщение арифметики целых чисел}

\subsection{\large 1.3 Обобщать арифметику целых чисел: зачем?}

\noindent Абстрагирование от конкретной ситуации позволяет математику отследить влияние основных параметров, влияющих на ситуацию, и диапазон их изменения. Более того, часто происходит так, что свойства обобщенной ситуации оказываются полезными для изучения базовой ситуации. Вот пример, когда арифметика подкольца кольца $\mathbb{Z}$ оказывает влияние на арифметику в $\mathbb{Z}$.
\newline \indent Рассмотрим для этого кольцо целых гауссовых чисел $\mathbb{Z}[i] = \mathbb{Z} + i\mathbb{Z} =$\newline $\{x + iy | (x, у) \in \mathbb{Z} \times \mathbb{Z}\}$. Очевидно, $\mathbb{Z}[i]$ — подкольцо поля $\mathbb{C}$ комплексных чисел, выдерживающее операцию сопряжения $z \rightarrow \bar{z}$. Поэтому операция сопряжения индуцирует инволютивный автоморфизм в $\mathbb{Z}[i]$, в котором $\mathbb{Z}$ является множеством неподвижных точек, и позволяет оснастить $\mathbb{Z}[i]$ мультипликативной нормой $N : \mathbb{Z}[i] \rightarrow \mathbb{N}$, определяемой через $N(z) = z\bar{z}$, для $z \in \mathbb{Z}[i]$. Другими словами, $N(x + iy) = x^2 + y^2 $ для всех $x , y \in \mathbb{Z}$.

\begin{predl}
\textit{\indent} ($i$) Кольцо $\mathbb{Z}[i]$ целых гауссовских чисел факториально. 
\newline \indent($ii$)  Пусть $z \in \mathbb{Z}[i]$ — неприводим в $\mathbb{Z}$ и не ассоциирован с элементом из $\mathbb{Z}$. Тогда $N(z)$ является простым числом в $\mathbb{Z}$.
\end{predl}

\begin{myproof}
Пункт $(i)$ следует из евклидовости $\mathbb{Z}[i]$ (см. раздел 3.1) и того, что всякое евклидово кольцо без делителей нуля факториально (см. раздел 3.5). \newline Что касается $(ii)$, то мы покажем, что разложение $rs$ числа $N(z)$ в $\mathbb{Z}$ тривиально. Сначала предположим, что ни r, ни s не обратимы в $\mathbb{Z}[i]$. Пусть $n$ (соответственно, $m$) — длина разложения на простые множители для $r$ (соответственно, для $s$). Так как $z\bar{z}$ является простым разложением для $N(z)$ (напомним, что $z$ и $\bar{z}$ неприводимы в $\mathbb{Z}[i]$), то из единственности разложения на неприводимые множители следует, что $m + n = 2$, откуда $n = m = 1$, т.е. $r$ и $s$ — неприводимые в $\mathbb{Z}[i]$. Из единственности следует, что $z \sim_{\mathbb{Z}[i]} r$  или $z \sim_{\mathbb{Z}[i]} s$ , что противоречит предположению относительно $z$ ($z$ не ассоциирован с элементом из $\mathbb{Z}$). Следовательно, хотя бы один из двух элементов $r$ и $s$ является обратимым в $\mathbb{Z}[i]$. Но из $r \in U(\mathbb{Z}[i])$ следует, что $N(r) \in U(\mathbb{Z})$. Так как $N(r) = r^2$ и $N(s) = s^2$ , то имеем $r = \pm 1$ или $s = \pm 1$. \\
\end{myproof}

\begin{mynotice}
\noindent В доказательстве, приведенном выше, мы использовали (кроме факториальности кольца) только наличие мультипликативной нормы со значениями в $\mathbb{Z}$ (фактически, в $\mathbb{N}$, хотя это

\newpage
%//////////////////////////////////////
%//Begin of 183 page
%//////////////////////////////////////
%\newtop{II-1.3 $\:$ Обобщать арифметику целых чисел: зачем?}

\noindent и не важно). В то же время вид единиц в $\mathbb{Z}[i]$ не был использован. Кроме того, существование мультипликативной нормы основано, главным образом, на существовании инволютивного автоморфизма $z \rightarrow \bar{z}$, для которого $\mathbb{Z}$ является множеством неподвижных точек. Такой тип доказательства применим и в других ситуациях.
\end{mynotice}

\begin{predl}
\textit{\indent} Элемент вида $x^2 + y^2$ из $\mathbb{N}$, где $x \in \mathbb{N}$ и $y \in \mathbb{N}$ взаимно просты, назовем точной суммой двух квадратов. Тогда всякий делитель (из $\mathbb{N}$) точной суммы двух квадратов сам является точной суммой двух квадратов.
\end{predl}

$\:$\newline\newline
\begin{myproof}
Заметим сначала, что «общая» сумма двух квадратов может иметь делители, о которых ничего сказать нельзя (достаточно рассмотреть сумму виде $(\lambda x)^2 + (\lambda y)^2 $ и тогда $\lambda$ — такой делитель). Поэтому утверждение о взаимной простоте $x + iy$ в произведение неприводимых в $\mathbb{Z}[i]: x + iy = \pi_1 \dots \pi_n $ , где $\pi_j $ неприводимы. Это разложение индуцирует разложение $x^2 + y^2:$
\begin{align}
x^2 + y^2 = N(x + iy) = N(\pi_1 )N(\pi_2) \dots N(\pi_n )\text{.}
\end{align}
Заметим, что ни одно из $\pi_j$ не ассоциировано с элементом из $mathds{Z}$ (так как $x$ и $y$ взаимно просты). Согласно предшествующей лемме, $N(\pi_j )$ является простым элементом $\mathbb{Z}$. Следовательно, разложение $(1)$ есть разложение (в $\mathbb{Z}$) $x^2 + y^2$ на простые множители. Если $d \in \mathbb{N}$ — делитель $x^2 + y^2$, то существует такое подмножество $J \subset [1,n]$, что
\begin{align*}
d = \prod_{j \in J}\: N(\pi_j) = N\Biggl(\prod_{j \in J} \pi_j \Biggr) = u^2 + v^2\text{, где } u + iv = \prod_{j \in J} \pi_j \text{.} 
\end{align*}
Откуда следует, что $d$ есть сумма двух квадратов. Так как $u + iv$ является делителем в $\mathbb{Z}[i]$ числа $x + iy$, то эта сумма точная.\\
\end{myproof}

$\:$\newline\newline
\begin{mynote}% 1em left, 2em right
Зная, что кольцо $\mathbb{Z}[\sqrt{—2}] = \mathbb{Z} + i\sqrt{2}\mathbb{Z} = \{x + \sqrt{—2}у, (x,y) \in \mathbb{Z}\times\mathbb{Z}\}$ факториально, можно доказать небанальный результат, касающийся сумм $x^2 + 2y^2$ , где $(x,y) \in \mathbb{N}\times\mathbb{N}$. Это обобщенная точка зрения математика $\dots$

\newpage
%//////////////////////////////////////
%//Begin of 184 page
%//////////////////////////////////////
%\newtop{II-1 $\:$ Обобщение арифметики целых чисел}
\noindent Кстати: существует аналогичный результат для сумм вида $x^2 - 2y^2$, связанный с кольцом $\mathbb{Z}[\sqrt{2}] = \mathbb{Z} + \sqrt{2}\mathbb{Z}$. Предложложив, что кольцо факториально, можно доказать, для взаимно простых $x,y \in \mathbb{Z}$ следующий результат:
\begin{align*}
d \in \mathbb{Z}, d|x^2 - 2y^2 \Rightarrow \exists u \in \mathbb{Z}\text{,}v \in \mathbb{Z} \:\text{такие, что } d = u^2 - 2v^2\text{.}
\end{align*}
Начнём с определения инволютивного автоморфизма $\mathbb{Z}[\sqrt{2}]$ (которое в этом случае уже не связано с операцией сопряжения в $\mathbb{C}$), затем введём норму (со значением в $\mathbb{Z}$ на этот раз)$\dots$, остерегаясь обратимого элемента $-1 \in \mathbb{Z}$. Новая ступень преодолена. \newline \indent Однако аналогичного феномена для сумм вида $x^2 + 3y^2$ в кольце $\mathbb{Z}[\sqrt{-3}]$ не наблюдается. Не путайте кольцо $\mathbb{Z}[j]$ целых чисел и кольца $\mathbb{Q}[\sqrt{-3}]$. Оно не факториально!\\
\end{mynote}

Пусть $p \in \mathbb{N} \backslash \{2\}$ — простое число, являющееся суммой двух квадратов. Легко проверить, рассматривая $\mathbb{Z}/4\mathbb{Z}$, что $p \equiv 1\:(mod\:4)$. Вот обратное утверждение: 

\begin{sled}
\textit{\indent} Пусть $p \in \mathbb{N}$ — простое число, удовлетворяющее соотношению $p \equiv 1\:(mod\:4)$. Тогда $p$ является суммой двух квадратов.
\end{sled}

\begin{myproof}
Сравнение Вильсона для всякого простого $p$:
\begin{align*}
(p - 1)!\equiv -1\:(mod\:p)
\end{align*}
получается при помощи перегруппирования в произведении $1 \times 2 \times \dots \times (p-1)$ каждого сомножителя со своим обратным по модулю $p$. Если $p \neq 2$, то, перегруппировывая в том же произведении вместе числа $i$ и $(p - i)$, получаем формулу
\begin{align*}
(-1)^{(p-1)/2} \Biggl(\Biggl(\frac{p-1}{2}\Biggr)!\Biggr)^2 \equiv -1\:(mod\:p)\text{.}
\end{align*}
В частности, если $p \equiv 1 (mod 4)$ и если $x = (\frac{p-1}{2})!$, то $x^2 \equiv —1\:(mod\:p)$ или, что то же самое, $p | (x^2 + 1)$. Простое $p$ делит точную сумму двух квадратов и, следовательно, само является суммой двух квадратов. \newline Можно заметить, что главный этап доказательства состоит в~ утверждении, что $—1$ является квадратом по модулю $p$, где $p$ — число вида $4n + 1$. Этот результат, прямое доказательство которого было только что получено, будет углублен позже в части, посвященной квадратичным вычетам.
\end{myproof}

\newpage
%//////////////////////////////////////
%//Begin of 185 page
%//////////////////////////////////////

Закончим раздел сводкой результатов, относящихся к группе единиц и неприводимым элементам в $\mathbb{Z}[i]$ (результаты, содержащие, в частности, пункт ($ii$) теоремы 5). Указанные результаты позволяют лучше понять новое кольцо, удовлетворяющее основной теореме арифметики, обобщающее некоторые кольца, являющиеся квадратичными расширениями, например $\mathbb{Z}[\sqrt{2}]$ или $\mathbb{Z}[\sqrt{2}]$, но не все! \newline \indent Пусть $p \in \mathbb{Z}$. Если $p$ неприводимо в $\mathbb{Z}[i]$, то оно тем более неприводимо в $\mathbb{Z}$ (это простое число из $\mathbb{Z}$). Следующее предложение содержит одну из возможных обратных теорем:

\begin{predl}
\textit{\indent} ($i$) $U(\mathbb{Z}[i]) = \{z \in \mathbb{Z}[i] | N(z) = 1\} = \{+1,-1,+i,-i\}$. \newline \indent ($ii$) Если $p$ — простое в $\mathbb{N}$, то $p$ неприводимо в $\mathbb{Z}[i]$ тогда и только тогда, когда оно не является нормой $N(z)$ для $z \in \mathbb{Z}[i]$ (что эквивалентно $p \equiv 3\:(mod\:4)$). \newline \indent ($iii$) Пусть $z \in \mathbb{Z}[i]$. Элемент $z$ является неприводимым в $\mathbb{Z}[i]$ и не ассоциированным с элементом из $\mathbb{Z}$ тогда и только тогда, когда $N(z)$ — простое число в $\mathbb{Z}.$
\end{predl}

\noindent \textbf{ \large \textit{Несколько примеров}}
\begin{enumerate}
\item Число $5$ — простое в $\mathbb{Z}$, не неприводимое в $\mathbb{Z}[i]$, так как существует нетривиальное разложение $5 = 1^2 + 2^2 = (1 + 2i)(1 — 2i)$
\item В $\mathbb{Z}[i] 2$ разлагается в сумму двух равных квадратов и почти является квадратом: $2 = 1^2  + 1^2  = (1 + i)(l — i) = —i(1 + i)^2 \sim_{\mathbb{Z}[i]} (1 + i)^2.$
\item В $\mathbb{Z}[i]$ еще неприводимо $2 + Зi$, так как $N(2 + Зi) = 13$ — простое число в $\mathbb{Z}$.
\item Простые числа $181$, $281$ и $601$, сравнимые с $1$ по модулю $4$, имеют представление в виде суммы двух квадратов: $181 = 9^2 + 10^2$, $281 = 5^2 + 16^2$, и $601 = 5^2 + 24^2$.\\
\end{enumerate}

\begin{myproof}[Доказательство предложения 8]
$\;\;\;\;$ Пункт ($i$) вытекает из равенства
\begin{align*}
U(\mathbb{Z}[i]) = \{z \in \mathbb{Z}[i]\:|\:N(z) \text{обратим в}\:\mathbb{Z}\:\} = \{+1,-1,+i,-i\}\text{.}
\end{align*}
\indent Докажем ($ii$), рассматривая простое число $р$ из $\mathbb{N}$. Если $p$ является нормой $N(z)$, то имеется нетривиальная факторизация: $p = z\bar{z}$, которая показывает, что $p$ не является неприводимым в $\mathbb{Z}[i]$.

\newpage
%//////////////////////////////////////
%//Begin of 186 page
%//////////////////////////////////////

Обратно, если $p$ не является неприводимым в $\mathbb{Z}[i]$, то имеется его разложение на неприводимые в $\mathbb{Z}[i]:\:р = \pi_1 \pi_2 \dots \pi_n$ с $n \geqslant 2$. Применяя норму, получаем: $р^2 = N(\pi_1) N(\pi_2) \dots N(\pi_n)$ дает нетривиальное разложение $p^2$ в $\mathbb{Z}$. Отсюда $n = 2$, $N(\pi_1) = p$ и $N(\pi_2) = p$.\newline \indent Второй результат о равносильности — следствие первого. \newline \indent ($iii$) Пусть $z \in \mathbb{Z}[i]$ такое, что $N(z)$ — простое число в $\mathbb{N}$. Из разложения $z = z_1 z_2$, где $z_1$ и $z_2$ принадлежат $\mathbb{Z}[i]$, получаем, применяя норму, что $N(z) = N(z_1 ) N(z_2 )$. Это — разложение простого числа $N(z)$ в $\mathbb{Z}$. Оно непременно тривиально. Следовательно, тому, что исходное разложение является разложением неприводимого элемента $z$ из $\mathbb{Z}[i]$ (и подтверждает его неассоциированность с элементом из $\mathbb{Z}$). Обратное уже было доказано в предложении 5.
\end{myproof}

\section{\large{2 Элементарные~ свойства теории~ делимости}}

Мы займемся нахождением общих критериев факториальности колец. Эти критерии устанавливаются совершенно естественным путем и ба­зируются на основных понятиях теории делимости: нётеровости кольца и свойстве Гаусса.

\subsection{2.1 Существование и единственность разложения на \newline простые~ множители}

\subsection{(9) Предложение.}
\textit{\indent Пусть любая бесконечно неубывающая последовательность главных (т.е. порожденных одним элементом) идеалов кольца $A$ без делителей нуля стабилизируется (т.е. становится постоянной, начиная с некоторого ее члена). Тогда кольцо $A$ удовлетворяет условию существования разложения на неприводимые множители.}

\begin{myproof}
Допустим, что условие на главные идеалы выполнено. Предположим противное: существует $x_0 \in A^* \backslash U(A)$, не являющийся произведением неприводимых. Элемент хо тем более не является неприводимым и поэтому имеет нетривиальное разложение $x_0 = x_1 y_1$, где $x_1$ и $y_1$ необратимы. Один из двух элементов $x_1$ или $y_1$ не представим в виде произведения неприводимых (иначе $x_0$ обладает разложением в произведение неприводимых). Пусть это будет $x_1$. Значит имеем строгое включение $A x_0 \varsubsetneq A x_1$. Тогда это рассуждение можно

\newpage
%//////////////////////////////////////
%//Begin of 187 page
%//////////////////////////////////////
\noindent повторить для $x_1$, что дает другое точное включение того же типа, что и первое: $A x_1 \varsubsetneq A x_2$ с $x_2$, не являющимся произведением неприводимых. Ясно, что можно построить бесконечную последовательность главных идеалов, которая не может стабилизироваться.
\end{myproof}

Следующее предложение связано с единственностью разложения на неприводимые множители. Доказательство является простой формальностью и предоставим его читателю.

\begin{predl}
\textit{\indent} Пусть $A$ — кольцо без делителей нуля, удовлетворяющее условию существования разложения в произведение неприводимых. Тогда $A$ обладает свойством единственности разложения (т.е. является \textbf{факториальным}), если для любого неприводимого $p$ выполнено следующее свойство: если $p$ делит $ab$, то $p\:|\:a$ или $p\:|\:b$ (значит $p$ может рассматриваться как простой элемент).
\end{predl}

\subsection{\large 2.2 НОД и взаимно простые элементы}

\begin{determ}
\textit{\indent} ($i$) Элемент $d \in A$, являющийся общим делителем $a$ и $b$, называется НОД $a$ и $b$, если всякий другой делитель $\delta$ элементов $a$ и $b$ является делителем $d$. В кратком виде это выражается следующей эквивалентностью:
\begin{align*}
d\:\text{есть НОД}\:a\:\text{и}\:b\:\text{тогда и только тогда, когда}\:[\delta\:|\:d\:\Longleftrightarrow\:\delta\:|\:a\:\text{и}\:\delta\:|\:b]\text{.}
\end{align*}
В этом случае идеал $Ad$ является единственным: действительно, сказать, что $d = $НОД$(a,b)$ равносильно тому, что идеал $Ad$ есть верхняя грань для множества $\{Aa, Ab\}$ главных идеалов. \newline \indent В дальнейшем будем использовать обозначения $d = $НОД$(a, b)$ или $a = a \wedge b$, помня, что в общем случае НОД — не единственный элемент. \newline \indent ($ii$) Элементы $a$ и $b$ будут называться \textbf{взаимно простыми} , если 1 является НОД $a$ и $b$ (равносильным образом, это означает, что только единицы $A$ — суть общие делители для $a$ и $b$).
\end{determ}

Существуют кольца, обладающие парами элементов, не имеющими наибольшего общего делителя. Покажем это.
$\:$\newline\newline
\textit{\textbf{Кольцо $A = \mathbb{Z}[\sqrt{-5}]$}}
$\:$\newline\newline
Рассмотрим кольцо $A = \mathbb{Z}[\sqrt{-5}] = \{x + iy\sqrt{5}, x, y \in \mathbb{Z}\}$. Это множество есть подкольцо поля С с обычными операциями сложения и

\newpage
%//////////////////////////////////////
%//Begin of 188 page
%//////////////////////////////////////
%\newtop{II-2 $\:$ Элементарные свойства теории делимости}
\noindent умножения и потому без делителей нуля. Операция сложения в $\mathbb{C}$ инду­
цирует инволютивный автоморфизм $\sigma \mathbb{Z}[\sqrt{-5}]:\sigma(x+y\sqrt{5}) = x - y\sqrt{5}$,
и дает возможность определить в $\mathbb{Z}[\sqrt{-5}]$ мультипликативную алгебра­
ическую норму со значениями в $\mathbb{N}$, определяемую через $N(z) = z\sigma(z)$.
Другими словами, $N(x + y\sqrt{-5}) = x^2 + 5y^2$. Группа единиц в $\mathbb{Z}[\sqrt{-5}]$ следующая:
\begin{align*}
U(\mathbb{Z}[\sqrt{-5}]) =  \{z \in \mathbb{Z}[\sqrt{-5}]\:\text{с}\:N(z) = 1\} = \{\pm 1\}\text{.}
\end{align*}
\indent Элемент $2$ неприводим в этом кольце. Действительно, из соотношения $2 = uv$ следовало бы равенство $4 = N(u)N(v)$. Так как $2$ не представимо в виде $x^2 + 5y^2$, то $2$ не является нормой. Из этого ясно, что $N(u) = 1$ или $N(v) = 1$: $u$ или $v$ обратим, а, следовательно, $2$ неприводим. Таким же образом можно показать, что элементы $3$, $1 + \sqrt{5}$ и $1 - \sqrt{5}$ неприводимы. Однако для них выполнено равенство $2 \times 3 = (1 + \sqrt{5} )\times(1 - \sqrt{5})$. Как грустно: $4$ сомножителя, встречающихся здесь, неприводимы! Понятно, что в кольце $\mathbb{Z}[\sqrt{-5}]$ основная теорема арифметики не имеет места. \newline \indent Если положим $a = 1 + \sqrt{-5}$ , $b = 1 — \sqrt{-5}$, то это равенство имеет другое необычное следствие: $2 | ab$, $2$ неприводимо, но $2$ не делит ни $a$, ни $b$! Беда не приходит одна. В результате предыдущей патологии элементы $2a$ и $ab$ не имеют НОД в $\mathbb{Z}[\sqrt{-5}]$. Допустим, что $d$ — общий делитель $2a$ и $ab$. Тогда $d\:|\:2a$ и $а\:|\:d$, что приводит к заключению $(\frac{d}{a} | 2$. Так как $2$ неприводимо, то $d \sim_A a $ или $d \sim_A 2a$. Но а не может быть НОД (он не делится на общий делитель с $2$), а $2a$ — тем более ($b$ не делится на $2$, $ab$ не делится на $2a$), что приводит к противоречию.

\subsection{\large 2.3 Выделение понятия}
\noindent Мы уже рассмотрели два важных свойства. Одно связано с наличием разложения на неприводимые множители, другое — с единственностью разложения. Это дает повод к следующим определениям:
$\:$\newline
\begin{determ}[свойство Гаусса]
\textit{\indent} Элемент $p$ кольца $A$ \textbf{называется простым}, если он отличен от нуля, не является обратимым и удовлетворяет условию: $p | ab \rightarrow p | a$ или $p | b$, что можно выразить по-другому: факторкольцо $A/Ap$ не имеет делителей нуля.
\end{determ}
$\:$\newline
\begin{determ}[упорядоченное нётерово множество]
\textit{\indent} Упорядоченное множество $X$ называется нётеровым, если всякая бесконечная возрастающая последовательность стабилизируется.
\end{determ}

\newpage
%//////////////////////////////////////
%//Begin of 189 page
%//////////////////////////////////////
\begin{determ}[нётерово кольцо]
\textit{\indent} Кольцо $A$ называется нётеровым, если множество идеалов этого кольца, упорядоченное по включению, является нётеровым. Другими словами, всякая бесконечная возрастающая последовательность идеалов постоянна, начиная с некоторого номера.
\end{determ}

По определению (или почти по определению) для факториального кольца понятия простого и неприводимого элемента совпадают. Между прочим, в кольце без делителей нуля имеет место следующее свойство:

\begin{determ}
\textit{\indent} В кольце без делителей нуля простой элемент неприводим. Обратное, вообще говоря, неверно.
\end{determ}

\begin{determ}[принцип нётеровой индукции]
\textit{\indent} Упорядоченное множество $X$ нётерово тогда и только тогда, когда всякое непустое подмножество $Y$ в $X$ обладает максимальным элементом, содержащимся в $Y$ (элемент $y \in Y$ называется максимальным в $Y$, если не существует $z \in Y$, для которого $z > y$).
\end{determ}

\begin{myproof}
Допустим, что $X$ нётерово и $Y \subset X$ — непустое подмножество $X$ без максимального элемента. Пусть $x_0 \in Y$. Так как $x_0$ не максимальный в $Y$ , то найдется $x_i \in Y$, такой, что $x_0 < x_1$. Так как $x_1$ не максимален в $Y$, то можно построить $x_2$, такой, что $x_i < x_2$, $x_2 \in Y$. Это вам ничего не напоминает? \newline Обратно, пусть $(x_n)_{n \in \mathbb{N}}$ — возрастающая последовательность элементов из $X$. Если $x_m$ — максимальный элемент множества $\{x_n,n \in \mathbb{N}\}$, то последовательность $(x_n)_{n \in \mathbb{N}}$ стабилизируется, начиная с номера $m$.\\
\end{myproof}

\begin{determ}[связь между нётеровостью и конечностью колец]
\textit{\indent} Кольцо $A$ является нётеровым, тогда и только тогда, когда всякий идеал в $A$ конечного типа (т.е. порожден конечным числом элементов).
\end{determ}

\begin{myproof}
Допустим, что всякий идеал конечного типа, и пусть $(I_n)_{n \in \mathbb{N}}$ — возрастающая последовательность идеалов. Объединение $I = \bigcup_{n \in \mathbb{N}} I_n$ есть идеал, порожденный конечным подмножеством $\mathcal{F}$. Так как $(I_n)_{n \in \mathbb{N}}$ возрастающая, то существует такое $m \in \mathbb{N}$, что $\mathcal{F} \subset I_m$. Отсюда получаем, что $I = I_m$, а, следовательно, начиная с номера $m$, последовательность $(I_n)_{n \in \mathbb{N}}$ стабилизируется.

\newpage
%//////////////////////////////////////
%//Begin of 190 page
%//////////////////////////////////////
\noindent Обратно, предположим, что кольцо $A$ нётерово, содержащее идеал $I$, не являющийся идеалом конечного типа. Так как $I$ не является идеалом конечного типа, то $x_0 \in I$, затем $x_1 \in I \backslash A x_0$, затем $x_2 \in I \backslash (A x_0 + A x_1 )\:\dots$ Это приводит нас к наличию строго воэрастающей последовательности идеалов:
\begin{align*}
Ax_0 \varsubsetneq Ax_0 + Ax_1 \varsubsetneq Ax_0 + Ax_1 + Ax_2 \varsubsetneq \dots \\
\varsubsetneq Ax_0 + Ax_1 + \dots + Ax_n \varsubsetneq \dots\text{,}
\end{align*}
что заканчивает доказательство.
\end{myproof}
Прежде чем перейти к вещам, более конкретным, забежим вперед в главу III и приведем несколько результатов о нётеровых модулях. Конечно, нётеров модуль — это такой модуль, в котором всякая возрастающая последовательность подмодулей стабилизируется, или, иначе, всякий подмодуль является подмодулем конечного типа. Для того чтобы связать сказанное с предыдущим, заметим, что идеалы кольца являются его подмодулями.

\begin{predl}
\textit{\indent} ($i$) Пусть $A$ — кольцо. Если $A$-модуль $E$ — нётеров, то для всякого подмодуля $F$ модуля $E$ $A$-модули $E/F$ и $F$ нётеровы. Обратно, если в $A$-модуле $E$ есть такой нётеров подмодуль $F$, что $E/F$ нётеров, то и $E$ — нётеров.
\end{predl}

\begin{myproof}
Доказательство первого результата очень просто. Действительно, всякая возрастающая последовательность подмодулей $F$ является также возрастающей последовательностью подмодулей в $E$. Заметим также, что подмодули $E/F$ есть образы подмодулей $E$, содержащие $F$. \newline Обратное утверждение доставляет больше забот. Нельзя пользоваться теми же рассуждениями, что в векторном пространстве, и предполагать, например, что $E \simeq E/F \oplus F$. \newline Рассмотрим отображение, которое каждому подмодулю $G$ в $E$ ставит в соответствие пару $(G + F, G \cap F)$. Это отображение порождает строго возрастающую последовательность. Действительно, рассмотрим два подмодуля $G' \subset G$, такие, что $G' + F = G + F$ и $G' \cap F = G \cap F$. Пусть элемент $x \in G$. Тогда $x = y + z$, где $y \in G', z \in F$. Так как $G' \cap G$, то $y \in G$ и, значит, $z \in G$. Однако $G' \cap F = G \cap F$, откуда $z \in G'$, и потому $x \in G'$. Таким образом, всякая строго возрастающая последовательность модулей в $E$

\newpage
%//////////////////////////////////////
%//Begin of 191 page
%//////////////////////////////////////
\noindent порождает строго возрастающую последовательность подмодулей в $(E + F)/F$ и $E \cap F$. Догадаемся о продолжении$\dots$
\end{myproof}

\begin{predl}
\textit{\indent} Если $E$ и $F$ — два $A$-модуля, то $E \times F$ нётеров модуль тогда, и только тогда, когда таковыми являются $E$ и $F$.
\end{predl}

\begin{myproof}
Проектируя $E \times F$ на каждый из подмодулей $E$ и $F$, получаем необходимость условия. Для доказательства обратного достаточно заметить, что $E \simeq E \times F / \{0\} \times F$ и применить предыдущее предложение.
\end{myproof}
$\:$\newline\newline
\subsection{\large 2.4 Соотношение Безу}

\begin{predl}
\textit{\indent} ($i$) Пусть $a$, $b$ и $d$ — элементы кольца $A$, связанные соотношением \newline $Ad = Aa + Ab$. Тогда $d$ = НОД$(a, b)$. \newline \indent($ii$) Пусть $A$ — кольцо, в котором сумма двух главных идеалов есть главный идеал. Тогда всякий неприводимый элемент $A$ является простым элементом (т.е. удовлетворяет свойству Гаусса).
\end{predl}

\begin{myproof}
($i$) — простая формальность, в которой нет ничего удивительного. Действительно, $Aa + Ab$ есть верхняя грань для множества идеалов \newline $\{Aa, Ab\}$.\newline \newline Чтобы доказать ($ii$), предположим, что $p$ неприводим в $A$, $a \in A$ и $b \in A$ таковы, что $p | ab$. Допустим, к примеру, что $p$ не делит $a$. Тогда $Ap \varsubsetneq Ap + Aa$ и, значит, $Ap + Aa$ есть главный идеал. Из максимальности $Ap$ среди главных идеалов следует, что $Ap + Aa = A$, и поэтому выполнено соотношение Безу $1 = up + va$, из которого выводим $b = upb + vab$. Но тогда $p$ делит $b$.
\end{myproof}

\indent Подчеркнем роль, сыгранную соотношением Безу, связанную с НОД и свойством Гаусса в доказательстве предложения. Вот результат, приводящий к понятию максимального элемента.


\newpage
%//////////////////////////////////////
%//Begin of 192 page
%//////////////////////////////////////
\begin{determ}[кольцо Безу]
\textit{\indent} Кольцо А называется кольцом Безу, если сумма любых двух его главных идеалов является главным идеалом. Это эквивалентно тому, что всякий идеал конечного типа является главным.
\end{determ}

\begin{mynotice}
Введение понятия кольца Безу продиктовано соображениями удобства записи. Никакой теории колец Безу в этой книге не будет!
\end{mynotice}
$\:$\newline\newline
\begin{predl}
Пусть $p$ — неприводимый элемент кольца Безу $A$. Тогда факторкольцо $A/Ap$ есть тело. Равносильным образом это означает, что идеал $Ap$ максимален среди всех идеалов (отличных от $A$). По-другому это можно выразить так: для любого $x \in A\backslash Ap$ существуют такие $u$ и $v$ из $A$, что $1 = ux + vp$.
\end{predl}

\begin{myproof}
Пусть $\xi$ — ненулевой элемент из $A\backslash Ap$, представляющийся элементом $x \in A\backslash Ap$. Тогда идеал $Ax + Ap$ есть главный идеал $Ad$, строго содержащий $Ap$. Отсюда $d | p$ и $d \nsim p$. Значит, $d \sim 1$, т.е. $1 \in Ax + Ap = A$. Поэтому найдутся такие $u$ и $v$, что $1 = ux + vp$, откуда, переходя к факторкольцу $A/Ap$, получаем $1 = \bar{ux} = \bar{u}\xi$, что доказывает обратимость $\xi$ в $A/Ap$. Отсюда следует, что $A/Ap$ — тело. \newline Читатель без труда проверит самостоятельно эквивалентность трех формулировок результата
\end{myproof}

\begin{determ}
\textit{\indent}Идеал $I$ кольца называется простым, если он отличен от $A$ и если для всякого произведения $ab \in I$ следует, что $a \in I$ или $b \in I$. Последнее равносильно тому, что факторкольцо $A/I$ не имеет делителей нуля. \newline \indent Идеал называется максимальным, если он максимален среди всех идеалов, отличных от $A$, или, что то же самое, факторкольцо $A/I$ является телом.
\end{determ}

\begin{mynotice}
Идеал $\{0\}$ простой тогда и только тогда, когда кольцо не имеет делителей нуля. Он максимален тогда и только тогда, когда кольцо является телом.
\end{mynotice}

\newpage
%//////////////////////////////////////
%//Begin of 193 page
%//////////////////////////////////////
\indent В качестве резюме:

\begin{predl}
\textit{\indent} ($i$) В кольце без делителей нуля всякий элемент, порождающий максимальный идеал, является простым, а каждый простой элемент неприводим. Два последние понятия (простой и неприводимый) совпадают в факториальном кольце, и все три понятия совпадают в кольце Везу. \newline \indent ($ii$) Элемент $p$ кольца $A$ простой тогда и только тогда, когда идеал $Ap$ простой и отличен от $\{0\}$. \newline \indent ($iii$) В любом кольце всякий максимальный идеал прост.
\end{predl}

\section{3 Евклидовы кольца с точки зрения эффективности}

Этот раздел посвящен изучению евклидовых колец, т.е. колец, обладающих евклидовым делением. Здесь можно будет найти точное определение данного понятия, элементарные свойства евклидовых колец, в частности, факториальности евклидовых колец без делителей нуля, алгоритм Евклида и его реализацию в языке Ада во всей его общности. Для более глубокого изучения необходимой математики читатель может обратиться к работе Самюэля $[159]$, являющейся очень толковыми легко читаемым руководством.

\subsection{3.1 Что такое евклидово кольцо?}

\begin{determ}
Евклидово деление в кольце $А$ есть оператор $A\times A^* \rightarrow A$, обозначаемый «$/$», для которого существует отображение $\phi$ кольца $A$ во вполне упорядоченное множество (т.е. множество, всякая непустая часть которого имеет наименьший элемент), удовлетворяющее соотношению:
\begin{align}
\forall(a,b) \in A \times A^*, \:\: \phi(a - b(a/b)) < \phi(b)
\end{align}
В этом случае говорят, что «$/$» евклидово для $\phi$. Отображение $\phi$ называется \textbf{алгоритмом Евклида}, если оно удовлетворяет свойству:
\begin{align}
\forall(a,b) \in A \times A^*, \exists(q,r) \in A \times A \:\text{такая, что}\: a = bq + r \: c \:\phi(r) < \phi(b)\text{.}
\end{align}
Эквивалентным образом, для всякого $b$ в $A^*$ существует такая система представителей в $A/Ab$, элементы $r$ которых удовлетворяют неравенству $\phi(r)<\phi(b)$.
\newpage
%//////////////////////////////////////
%//Begin of 194 page
%//////////////////////////////////////
\indent Кольцо $A$ (не обязательно без делителей нуля) называется евклидовым, если оно допускает евклидово деление «$/$» (в таком случае $A$ называется евклидовым для «$/$»), а также, что $A$ допускает евклидов алгоритм (в последнем случае говорят, что $A$ евклидово для $\phi$).
\end{determ}

\begin{mynotice}
Хотя в математике заостряется внимание на понятии евклидова алгоритма, именно эффективность евклидова деления позволяет вычислять НОД, находить коэффициенты Безу, и т.д. В какой-то мере приходится пожалеть о термине «алгоритм Евклида».\newline \indent Большинство евклидовых алгоритмов, используемых в математических учебниках, базируется на упорядоченности множества $\mathbb{N}$(или на упорядочении множества, изоморфного $\mathbb{N}$). Междупрочим, произведение колец $\mathbb{Z} \times \mathbb{Z}$ есть евклидово кольцо (имеющее делители нуля), не допускающее алгоритма Евклида с целыми значениями $[159]$. Гиблот в $[85]$ нашел аналогичный пример для кольца без делителей нуля.
\end{mynotice}
$\:$\newline\newline
\begin{determ}
\textit{\indent} Пусть $A$ — евклидово кольцо для $\phi$. Скажем, что равенство типа $(3)$ есть \textbf{евклидово деление} (относительно $\phi$) $a$ на $b$, $q$ — частное евклидова деления, $r$ — остаток. Назовем оператором \textbf{взятия остатка} (для $\phi$) оператор $mod\::A \times A^* \rightarrow A$, удовлетворяющий соотношениям:
\begin{align*}
\phi(a\:mod\:b) < \phi(b)\;\text{и}\; a\:mod\:b\equiv a\:(mod\:b)\text{.}
\end{align*}
Каждое евклидово деление «$/$» определяет остаточный оператор\newline$a\;mod\;b = a - b \times (a/b)$, для $a \in A$ и $\b \in A^*$.
\end{determ}

\noindent \textbf{Примеры евклидовых алгоритмов на $\mathbb{Z}$}
\newline \indent Кольцо $\mathbb{Z}$ целых чисел является моделью для конструирования евклидовых колец. Вот два примера деления и евклидовых алгоритмов для $\mathbb{Z}$.

\begin{enumerate}
\item Взятие абсолютного значения в $\mathbb{Z}$ дает возможность построить алгоритм Евклида. Для $(a,\:b) \in \mathbb{Z} \times \mathbb{Z}^*$ можно записать $a = bq + r\:с\: |r| < |b|$ различными способами. Например, при $(a,b) = (—14,3)$ можно записать $—14 = 3 \times (-5) + 1$ и получить остаток, равный единице, или $—14 = 3 \times (-4) — 2$ с остатком, равным $-2$. В обоих случаях абсолютная величина остатка меньше $3$. Следовательно, знание евклидова алгоритма еще не определяет евклидово деление (оно становится единственным, если потребовать, чтобы остаток был положительным или нулевым).
\newpage
%//////////////////////////////////////
%//Begin of 195 page
%//////////////////////////////////////
\item Другой, менее известный, евклидов алгоритм на $\mathbb{Z}$ связан с отображением $\phi$, которое по целому числу дает количество двоичных цифр в его записи (уславливаются, что $\phi(0) = 0$). Для доказательства того, что $\phi$ является евклидовым алгоритмом, необходимо показать, что для $b \ne 0$ выполнено соотношение деления: $a = bq + r, |r| \le |b|/2$. Действительно, при $b \ne 0$ из соотношения $|r| \le |b|/2$, конечно следует $\phi(r) < \phi(b)$ и обратно.
\end{enumerate}

Наличие такого деления вытекает из того факта, что всегда можно записать соотношение $a = bq + r\:c\:|r| < |b|$ и $r$ того же знака, что и $b$. Это и дает возможность отыскать такое деление, что $|r| \le |b|/2$. Если
$|r| > |b|/2$, то положим:
\begin{align*}
a = bq + r = b(q + 1) + r — b,\;\;\; (\text{ибо}\:|r — b| \le |b|/2)\text{.}
\end{align*}
Еще раз подчеркнем, что для пары $(a, b)$ пара $(q,r)$ определяется не единственным образом. Например, если $(a, b) = (27,6)$, то:
\begin{align*}
\text{$
\begin{cases}
27 = 6 \times 4 + 3 & (r\; = \:\;3),\\
27 = 6 \times 5 - 3 & (r = -3),
\end{cases}$} & \;\;\;\;\;c\:|r|\le |b|/2 \text{в обоих случаях.}
\end{align*}
Несмотря на эту неединственность, будем использовать выражение «евклидово деление с самым малым остатком» или «центрированное деление», чтобы обозначить всякое евклидово деление, ассоциированное с данным евклидовым алгоритмом. Примечательно, что указанный евклидов алгоритм является в определенном смысле наименьшим евклидовым алгоритмом на $\mathbb{Z}$ (см. упр. 27).

$\:$\newline
\noindent \textbf{Пример кольца многочленов.}
\newline \indent Для кольца многочленов $K[X]$, где $K$ — поле, функция степени со значениями во вполне упорядоченном множестве $\{-\infty\} \cup \mathbb{N}$ есть евклидов алгоритм. Действительно, хорошо известно, что для $a,b \ in K[X], b \ne 0$ можно записать $a = bq + r\:с\:deg\:r < deg\:b$ и такое представление однозначно. Мы вернемся позднее к этому евклидову делению, когда будем рассматривать алгоритм евклидова деления многочленов для вычисления НОД при нахождении неприводимых многочленов над $\mathbb{Z}/p\mathbb{Z}$.

$\:$\newline
\noindent \textbf{Пример кольца целых гауссовских чисел.}
\newline \indent Кольцо $\mathbb{Z}[i]$, введенное в разделе $1.3$, евклидово для нормы $N$. Чтобы это проверить, рассмотрим сначала поле $\mathbb{Q}[i] = \mathbb{Q} + i\mathbb{Q}$, являющееся полем частных для кольца $\mathbb{Z}[i]$. Это поле остается неподвижным относительно операции комплексного сопряжения, что позволяет продолжить

\newpage
%//////////////////////////////////////
%//Begin of 196 page
%//////////////////////////////////////
\noindent норму с $\mathbb{Z}[i]$ на $\mathbb{Q}[i]$ в той же форме $(N(z) = z\bar{z}, z \in \mathbb{Q}[i])$. Рассмотрение решетки $\mathbb{Z}[i] \subset \mathbb{Q}[i]$ позволяет приблизить каждый элемент $\mathbb{Q}[i]$ следующим образом:
\begin{align*}
\forall c \in \mathbb{Q}[i], \exists q \in \mathbb{Z}[i]\:\text{такой, что}\: \sqrt{N(c-q)} \le \sqrt{2}/2,\text{т.е}\:N(c-q) \le 1/2\text{.}
\end{align*}

\noindent Если $a$ и $b$ — два элемента из $\mathbb{Z}[i]$,где $b \ne 0$, использование предыдущего неравенства с $a/b$ в качестве с дает нам наличие $q \in \mathbb{Z}[i]$, такого, что $N(a/n - q) \le 1/2$, или, по-другому, $N(a - bq) \le $N(b)/2$. Если положить $r = a - bq$, то получим $a = bq + r, где $N(r) < N(b)$, что и ожидалось.

$\:$ \newline
\textbf{\large 3.2 Алгоритм Евклида нахождения НОД}
$\:$ \newline
Алгоритм Евклида для нахождения НОД двух целых чисел адаптируется без изменений для всякого евклидова кольца. Вот точная формулировка:


\begin{algo}[алгоритм Евклида в евклидовом кольце]
Пусть евклидово деление в кольце $A$ ассоциировано с евклидовым алгоритмом $\phi$ и $a, b$ — элементы из $A$. Алгоритм Евклида заключается в том, чтобы осуществить следующие евклидовы деления (в которых положим $r_0 = a, r_1 = b$) до появления нулевого остатка:
\end{algo}
\begin{align*}
\text{$
\begin{cases}
\text{если}\:r_1 \ne 0,&\text{то}\:r_0=r_1 q_1+r_2,\hspace{45pt}\text{где}\:\phi(r_2)<\phi(r_1)\\
\text{если}\:r_2 \ne 0,&\text{то}\:r_1=r_2 q_2+r_3,\hspace{45pt}\text{где}\:\phi(r_3)<\phi(r_2)\\
\;\;\;\;\;\;\vdots &\;\;\;\;\;\;\vdots\;\;\;\hspace{115pt}\vdots\\
\text{если}\:r_i \ne 0, &\text{то}\:r_{i-1}=r_i q_i+r_{i+1},\hspace{29pt}\text{где}\:\phi(r_{i+1})<\phi(r_i)\\
\;\;\;\;\;\;\vdots &\;\;\;\;\;\;\vdots\;\;\;\hspace{115pt}\vdots\\
\text{если}\:r_{n-1} \ne 0, &\text{то}\:r_{n-2}=r_{n-1}q_{n-1}+r_n,\hspace{10pt}\text{где}\:\phi(r_n)<\phi(r_{n-1})\\
\text{если}\:r_n \ne 0, & \text{то}\:r_{n-1}=r_n q_n+r_{n+1},\hspace{20pt}\text{где}\:\phi(r_n) = 0\:\text{и}\:\phi(r_{n+1})<\phi(r_n)\text{.}\\
\end{cases}$}
\end{align*}

\begin{predl}
\textit{\indent}($i$) В евклидовом кольце $A$ алгоритм Евклида, ассоциированный с парой $(a,b) \in A \times A$, находит элемент $r_n \in A$ такой, что $Aa + Ab = Ar_n$ (в частности, $r_n$ является НОД $a$ и $b$).\newline\indent($ii$) Всякое евклидово кольцо $A$ является кольцом Безу.
\end{predl}

\begin{myproof}
Оно идентично тому, что имеется во введении. Из равенства
$r_{i-1} = r_i q_i + r_{i+1}$ с $1 \le i \le n$ выводим, что $Ar_{i - 1} + Ar_i = Ar_i + Ar_{i+1}$ и, в частности, $Aa + Ab = Ar_0+Ar_1=Ar_n+ Ar_{n+1} = Ar_n$.
\end{myproof}

\newpage
%//////////////////////////////////////
%//Begin of 197 page
%//////////////////////////////////////
Пусть mod — оператор нахождения остатка, ассоциированный с $\phi$ в схеме вычисления алгоритма Евклида и $r_{i+1} = r_{i-1}\:mod\:r$. Следовательно, можно только с помощью оператора $mod$ выразить пару $(r_1,r_2)$ через пару $(r_0,r_1)$, затем $(r_2, r_3)$ через $(r_1, r_2)\dots$ Эта рекуррентная последовательность приводит к алгоритму $1$, в котором пара $(r, s)$ принимает последовательные значения $(r_i,r_{i+1})$.

$\:$\newline
\begin{lstlisting}[mathescape=true]
$\text{НОД}(a, b \in A)$ retrun r $\in$ $A$ is 
    $(r,s)$ $\in A \times A\::=\:(a,b)$;{
    while($s$ $\ne$ 0){ $\text{НОД(r,s) = НОД(a,b)}$
	    $(r,s) \longleftarrow (s,r\:mod\:s)$;    
    }
    $\text{НОД(r,s) = НОД(a,b) и s = 0, где r = НОД(a,b)}$
    return $r$;
}
\end{lstlisting}
\begin{align*}
\text{\textbf{Алгоритм 1.} Вычисление НОД в евклидовом кольце}
\end{align*}

$\:$\newline
\begin{mynotice}
Если обозначить НОД результат обсуждаемого ал­горитма, то вполне возможно, что найдутся элементы $a$, $b$, для которых НОД$(a, b)$ отличается от НОД$(b, a)$. Впрочем, даже два последовательных оператора взятия различных модулей могут дать различные НОД, но, конечно, ассоциированные. См. пример в следующем разделе.
\end{mynotice}

\subsection{3.3 Реализация в языке Ада вычисления НОД}
Язык Ада, в котором все понятия определены самым строгим обра­зом $[68]$, располагает, в частности, и евклидовым делением в $\mathbb{Z}$, обозначенным «$/$», определяемым в первую очередь тем фактом, что для
$a \geqslant О, b > 0$ число $a/b$ есть обычное евклидово частное, $a$ с другой стороны, свойством симметрии: $(-a)/b = -(a/b) = a /(-b)$. \newline \indent Язык Ада располагает также двумя остаточными операторами \textbf{mod} и \textbf{rem. mod} (соответственно, \textbf{rem}) есть единственный оператор взятия наименьшего по абсолютной величине остатка того же знака, что и то число, на которое делят (соответственно, делимого), удовлетворяющий соотношениям
\begin{align*}
a\:mod\:b\equiv a\:(mod\: b),\hspace{10pt}|a\:mod\:b| < |b|, \hspace{10pt}a\:mod\:b\:\text{того же знака, что и}\:b,\\
a\:rem\:b\equiv a\:(mod\: b),\hspace{10pt}|a\:rem\:b| < |b|, \hspace{10pt}a\:rem\:b\:\text{того же знака, что и}\:a.\\
\end{align*}

\newpage
%//////////////////////////////////////
%//Begin of 198 page
%//////////////////////////////////////
В частности, $a\:rem\:b = a\:mod\:b$, если $a$ и $b$ одного знака. Следующие соотношения легко проверяются:
\begin{align*}
a\:rem\:b=a-(a/b)\times b, \hspace{10pt}(-a)\:rem\:b=-(a\:rem\:b),\hspace{10pt}a\:rem\:(-b)=a\:rem\:b.
\end{align*}
Вот (программа $1$) настраиваемая Ада-функция, упрощающая вы­числения НОД в $\mathbb{Z}$, основанная на ранее изученном алгоритме. Ниже в рамке записаны сгруппированные спецификация функции и ее реали­зация, что, вообще говоря, является не самым лучшим способом.

\begin{lstlisting}[mathescape=true]
generic
  type Ring-Element is private;
  Zero : in Ring_Element;
  with function "-"(a,b: Ring_Element)return Ring_Element is <>;
  with function "$*$" (a,b: Ring_Element)return Ring_Element is <>;
  with function "$/$" (a,b: Ring_Element)return Ring_Element is <>;
function GCD (a, b : Ring_Element) return Ring_Element;

function GCD (a, b : Ring_Element) return Ring-Element is
  type Pair is record
    First, Second : Ring_Element;
  end record;
  u : Pair := (a , b);

function "NOD" (a, b : Ring-Element) return Ring-Element is
begin
  return a - b * (a/b);
end;

begin
  while u.second / = Zero loop
    u := (u.second, u.first mod u.second);
  end loop;
  return u.first;
end GCD;
\end{lstlisting}

Этот кусок программы требует некоторых пояснений. Тип элементов, для которых требуется вычисление НОД, есть тип private языка Ада. Это означает, что не предполагается особенных ограничений на структуру этих элементов. Единственные операции, которые над ни­ми производятся — это присваивание и проверка на равенство. Для вычисления НОД нам требуются и другие действия: сложение, вычи­тание, евклидово деление и, хотя и не сразу, но во время реализации, необходимо распознавать нулевой элемент рабочего кольца. Итак, вот, в основном, все понятия, заложенные в спецификации функции.
\newpage
