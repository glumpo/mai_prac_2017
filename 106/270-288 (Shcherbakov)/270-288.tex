\documentclass{mai_book}

\defaultfontfeatures{Mapping=tex-text}
\setmainfont{DejaVuSerif}
\setdefaultlanguage{russian}

\setcounter{page}{270} % ВОТ ТУТ ЗАДАТЬ СТРАНИЦУ
%\setcounter{thesection}{5} % ТАК ЗАДАВАТЬ ГЛАВЫ, ПАРАГРАФЫ И ПРОЧЕЕ.
\setcounter{equation}{10}% номер формул
% Эти счетчики достаточно задать один раз, обновляются дальше сами

\begin{document}

\cleartop

\begin{center} %Решения упражнений
\ \newline
\Large \textbf{Решения упражнений}\\
\ \newline
\end{center}

\noindent\textbf{1. Десятичные цифры простых чисел}\\
\ \newline
\hspace*{15pt}Пусть $l$ -- длина $B$, т.е. $10^{l-1}\leqslant B <10^l$\: и \:$k\geqslant 0$. Тогда числа вида\linebreak
$n\cdot10^{k+1} + B\cdot10^k + c$ являются числами десятичная запись которых\linebreak
содержит последовательность $В$, если $ 0 \leqslant c < 10^k.$ Если $k > 0$, то\linebreak
можно взять $с$ взаимно простым с 10 и тогда числа $10^{k+1}$ и $B\cdot10^k + c$\linebreak
будут взаимно просты. Поэтому можно применить теорему Дирихле. В\linebreak действительности оказывается, что существует бесконечно много про­-\linebreak
стых чисел, содержащих фиксированную последовательность цифр $B$ в\linebreak
заранее заданных позициях.\\
\ \newline

\noindent\textbf{2. Вычисление НОД}\\

\hspace*{0pt} Допустим, что $m>n$. Тогда $a^m - b^m = (a^n-b^n)a^{m-n}+(a^{m-n}-b^{m-n}b^n)$.\linebreak 
Это тождество и условия взаимной простоты $a$ и $b$ дает\newline
$$\text{НОД}(a^m-b^m,\ a^n-b^n)=\text{НОД}(a^{m-n}-b^{m-n},\ a^n-b^n)=$$
	$$=\text{НОД}(a^{m\ mod\ n}-b^{m\ mod\ n},\ a^n-b^n),$$
Повторяя это соотношение как в алгоритме Евклида, получим искомый результат.
\ \newline

\noindent\textbf{3. Алгоритм Евклида и непрерывные дроби}\\
\\
\hspace*{10pt} \textbf{a.}\ Пусть $a/b$ — рациональное несократимое число (с $b > 0$). Тогда\linebreak 
последовательность частных, полученных в алгоритме Евклида, при­-\linebreak
мененном к $а$ и $b$, дает разложение $а/b$ в непрерывную дробь. К тому\linebreak
же все частные, за исключением, быть может, первого, положительны,\linebreak
если используемое деление является обычным делением Евклида.\linebreak

 \textbf{b.}\ Рассмотрим непрерывные дроби $s_i = [c_i,c_{i+1},..,c_m]$ и\linebreak
$t_i=[d_i,d_{i+1},...,d_n]$. Тогда, очевидно, имеем $s_i=c_i+1/s_{i+1}$ и \linebreak
аналогичное соотношение для $t$ и $d$. Отсюда получаем $s_i>1$ для $i<m$,\linebreak
и, следовательно, $[s_i] = c_i$. кроме того, по предположению, $s_0=$\linebreak
$=[c_0,c_1,...,c_m]=[d_0,d_1,...,d_n]=t_0$. Используя предыдущее соотношение,\linebreak
получаем $c_0=d_0$ (целые части $s_0$ и $t_0$) и $s_1=t_1$. Затем постепенно\linebreak \newpage

%===============================================================
% 271 страница

%\newtop{Решения упражнений} %!!!!!!!!!!!!!!!!!!!!
\restoretop
\newtoplo{Решения упражнений}
\newtopre{II\quad Евклид и основная теорема арифметики}


\noindent доказываем, что $c_i=d_i$. Этот процесс заканчивается на наименьшем \linebreak
из чисел $m$ и $n$. Допустим, что это $m$. Тогда $s_m=t_m$ и $c_m=d_m$ через\linebreak
предшествующую рекуррентность. Кроме того, $s_m=c_m$ по определе­нию $s$.\linebreak
В результате\:\: $c_m=d_m$\:\: и\:\: $m=n$.\newline
\ \newline
\hspace*{15pt}\textbf{c.} Достаточно рассмотреть последние деления алгоритма Евклида:\nolinebreak $$r_{n-2}=r_{n-1}a_{n-1}+1\quad\text{ и }\quad r_{n-1}=1\times r_{n-1} \quad\text{ с\: } r_{n-1}>1.$$
Последнее деление можно заменить на следующее:\:\: $r_{n-1}=1\times (r_{n-1}-1)+1$ \linebreak
без появления нулевого частного и закончить деление на $1=1\times1$.\linebreak
Это означает, что $$[c_0,c_1,c_2,...,c_n]=[c_0,c_1,c_2,...,c_n-1,1],\quad\text{если\: } c_n > 1.$$

Это эквивалентно факту, что любое целое число $a$ допускает ровно два
разложения в непрерывную дробь: $[a]$ и $[a-1,1]$.\newline\\
\hspace*{15pt}\textbf{d.} Вот часть ответа (развиваемая потом в упражнении 6):
\begin{gather*}
	[a_0]=a_0,\quad [a_0,a_1]=\frac{a_0a_1+1}{a_1},\quad
	[a_0,a_1,a_2]=\frac{a_0a_1a_2+a_0a_1+a_1a_2}{a_1a_2+1}...\text{\:,}\\
	F_4/F_3=[1,1,2]\quad \text{и}\quad F_5/F_4=[1,1,1,2].
\end{gather*}
\\

\noindent\textbf{4. Многочлены континуаты}\\
\\
\hspace*{15pt}\textbf{a.} Легко видеть, что $F_n=K_n(1,...,1)$. Это означает, что в $K_n$\linebreak
имеется $F_n$ слагаемых.\\
\\
\hspace*{15pt}\textbf{b.} Нетрудно проверить, что свойство верно для $n=$ —1, 0, 1.\linebreak
Рассмотрим моном $X_1...X_n$ . Можно разделить исключения примыкающих\linebreak
пар на две категории: те, которые исключают пару $X_nX_{n-1}$, и те,\linebreak
которые оставляют $X_n$. По предположению индукции, первая категория\linebreak
дает все одночлены от $K_{n-2}$, а вторая — все одночлены от $K_{n-1}$,\linebreak
умноженные на $X_n$. Отсюда результат (обнаруженный впервые Эйлером).\linebreak
\\
\hspace*{15pt}\textbf{c.} Следовательно, континуанты обладают зеркальной симметрией:\linebreak
$K_n(X_1,...,X_n)=K_n(X_n,...,X_1)$. Можно определить последователь­-\linebreak
ность $K_n$ следующим образом:
$$K_n=X_1K_{n-1}(X_2,...,X_n)+K_{n-2}(X_3,...,X_n).$$
Соотношение, которое будет использоваться в следующих упражне­ниях.\newpage

%========================================================================
%272
Требуемое тождество доказывается легко. Оно указывает, что в\linebreak
по­ле рациональных дробей
$$ \frac{K_n(X_1,...,X_n)}{K_{n-1}(X_2,...,X_n)}=[X_1,X_2,...,X_n]=X_1+\frac{1}{X_2+...}.$$
Если $r_{i-1}=r_ia_i+r_{i+1}$, где $r_n=1$ и $r_{n+1}=0$ есть последовательность\linebreak
делений алгоритма Евклида, примененного к целым взаимно простым\linebreak
числам, то $r_i=K_{n-i}(a_{i+1},...,a_n)$.\newline
\\

\noindent\textbf{5. Континуаты (продолжение)}\\
\\
\hspace*{15pt}\textbf{a.} Нетрудно доказать, используя индукцию, что рассматриваемое\linebreak
произведение равно матрице
$$\begin{pmatrix}
	K_n(X_1,...,X_n)& K_{n-	1}(X_1,...,X_{n-1})\\
	K_{n-1}(X_2,...,X_n)& K_{n-2}(X_2,...,X_{n-1})
\end{pmatrix}$$
\noindent Этот результат дает другое доказательство зеркальной симметричности\linebreak
многочленов континуант.\newline
\\
\hspace*{15pt}\textbf{b.} Вычислив определитель, находим искомое равенство (с точно­стью\linebreak
до индексов). Следовательно, значения $K_n(a_1,...,a_n)$ и\linebreak
$K_{n-1}(a_2,...,a_n)$ дают взаимно простые целые числа.\\
\\
\hspace*{15pt}\textbf{c.} Простая индукция показывает, что искомое произведение равно
$$\begin{pmatrix}
	K_{n+2}(X_1,...,X_{n+2})& K_{n+1}(X_2,...,X_{n+2})\\
	K_n(X_1,...,X_n)& K_{n-1}(X_2,...,X_n)
\end{pmatrix}$$
\noindent Определитель этой матрицы (что и требовалось доказать) равен
\begin{eqnarray*}
	X_{n+2}\Big( K_{n-1}(X_2,...,X_n) K_{n+1}(X_1,...,X_{n+1})-\quad\\
	-K_n(X_1,...,X_n)K_n(X_2,...,X_{n+1}) \Big),
\end{eqnarray*}
т.е.\:\: $(-1)^{n+1}X_{n+2}$\:\: по предыдущему пункту\\
\\

\noindent\textbf{6. Разложение в непрерывную дробь}\\
\\
\hspace*{15pt}\textbf{a.} Это решение уже намечено в упражнении 3:
$$[a_0]=a_0,\quad [a_0,a_1]=\frac{a_0a_1+1}{a_1},\quad [a_0,a_1,a_2]=\frac{a_0a_1a_2+a_0a_1+a_1a_2}{a_1a_2+1}...$$
\newpage

%===================================================================
%273
\noindent Формула выглядит так:
$$[a_0,a_1,...,a_n]=\frac{K_{n+1}(a_0,a_1,...,a_n)}{K_n(a_1,...,a_n)},$$
и доказывается по индукции. Попутно использовалось соотношение\linebreak
$[a_0,...,a_n]=[a_0,[a_1,...,a_n]]$ и равенство, выражающее зеркальность\linebreak
многочленов континуант.\\
\\
\hspace*{15pt}\textbf{b.} Требуемое соотношение вытекает прямо из определения \linebreak
последовательностей $(a_i)$ и $(x_i)$. Запишем
\begin{equation}
	\begin{split}
		|x-[a_0,...,a_n]|&=|[a_0,...,a_n,x_{n+1}]-[a_0,...,a_n]|=\\
		&=\bigg|\frac{ K_{n+2}(a_0,...,a_n,x_{n+1} }{ K_{n+1}(a_1,...,a_n,x_{n+1} }
		-\frac{ K_{n+1}(a_0,...,a_n) }{K_n(a_1,...,a_n)} \bigg|= \\
		&=\frac{1}{ K_n(a_1,...,a_n)K_{n+1}(a_1,...,a_n,x_{n+1}) }
	\end{split}
\end{equation}
Очевидно, $x_{n+1}$ положительно (по построению) и континуанты возра­стают\linebreak
(хорошо видно, каким образом ), следовательно, получаем
\begin{equation}
	\big|x-[a_0,...,a_n]\big|\leqslant \frac{1}{K_n(a_1,...,a_n)^2}<\frac{1}{2K_n(a_1,...,a_n)},
\end{equation}

\noindent Соотношение, которое впоследствии понадобится. Это доказывает\linebreak 
схо­димость $x$. Можно также констатировать, что подходящие\linebreak веществен­ные числа дают очень хорошие аппроксимации указанного чис-\linebreak
ла. В действительности, как увидим в дальнейшем, они даже наилучшие.\newline
\\
\hspace*{15pt}\textbf{c.} Установленная в пункте \textbf{(a)} формула дает значение в неприводи­мой\linebreak 
форме, ибо, согласно упражнению 5, вводимые туда числа взаимно\linebreak
просты. Остается их только вычислить, что и сделаем, применяя рекур­-\linebreak
рентное определение континуант и значений многочленов. Приводим\linebreak
совмещенные вычисления числителя и знаменателя, чтобы\linebreak 
минимизи­ровать необходимые операции.
\begin{lstlisting}[mathescape=true]
$K\longleftarrow1;$ $K'\longleftarrow a_n$;
for (int i=n-1; i>=0; i=i-1){
	$(K',K)\longleftarrow(a_iK'+K,K')$;
}
\end{lstlisting}
%\newline
В начале итерации для значения $i$ имеем инвариантное отношение
$$ \frac{K'}{K}=[a_{i+1},...,a_n] $$
\newpage
%
%273
%==================================================================
%274
%
\noindent Этот алгоритм(который оперирует с коэффициентами разложения),\linebreak
разумеется, не должен использоваться для вычисления последователь-­\linebreak
ности подходящих дробей, так как каждый промежуточный этап не\linebreak
дает первые подходящие дроби.\newline
\hspace*{15pt}Если необходимо вычислить последовательность подходящих дро­бей,\linebreak
то можно использовать потоковый алгоритм разложения. Для это­го \linebreak
используют две рекуррентные последовательности, определяемые через\nolinebreak
\begin{center}
	$P_0=1,\quad P_1=a_0,\quad P_n=a_nP_{n-1}+P_{n-2},$\\
	$Q_0=0,\quad Q_1=1,\quad Q_n=a_nQ_{n-1}+Q_{n-2}.$
\end{center}

\noindent Итак, определяемые последовательности удовлетворяют соотношению\linebreak
$[a_0,...,a_n]=P_{n+1}/Q_{n+1}.$ \quad Это нас приводит к алгоритму 5.
\begin{center}
\begin{lstlisting}[mathescape=true][xrightmargin=1cm]
	int a;
	scanf("%d", &a);
	$P\longleftarrow1;$ $P'\longleftarrow a;$ $Q\longleftarrow 0;$ $Q'\longleftarrow 1;$
	printf("%d$\text{ }$%d\n", $P',\text{ }Q'$);
	while(){
		scanf("%d", &a);
		$(P',P)\longleftarrow (aP'+P,P');$ $(Q',Q)\longleftarrow(aQ'+Q,Q');$
		printf("%d$\text{ }$%d\n"$,$ $P',\text{ }Q'$);
	}
\end{lstlisting}
\textbf{Алгоритм 5.} Вычисление текущих подходящих дробей
\end{center}
\ \linebreak
\hspace*{15pt}\textbf{d.} Число золотого сечения удовлетворяет уравнению $x=1+1/x$.\linebreak
Следовательно, его разложение в непрерывную дробь есть $[1,1,1,1,...]$.
Последовательность подходящих дробей, согласно пункту \textbf{(a)} упражне­ния 4\linebreak
и предшествующему пункту \textbf{(a)} упражнения 6, есть отношения\linebreak
последовательных чисел Фибоначчи: $F_2/F_1,F_3/F_2,F_4/F_3,...$\newline
\\
\noindent\textbf{7. Аппроксимация вещественных чисел с помощью \newline \hspace*{13pt}непрерывных дробей}\\
\\
\hspace*{15pt}\textbf{a.} Выражение $p_{n+1}q_{n-1}-q_{n+1}p_{n-1}=K_{n+2}K_{n-1}-K_{n+1}K_n$ есть знак\linebreak 
$(-1)^{n+1}$, откуда следует результат. Выражение $p_{n+1}q_n-q_{n+1}p_n=$\linebreak
$K_{n+2}K_n-K_{n+1}K_{n+1}$ есть знак $(-1)^n$. Факт, что $x$ находится между двумя сходящимися последовательностями показывает, что эти последовательности сходятся к $x$.\newline
\\
\hspace*{15pt}\textbf{b.} Равенство (11) утверждает, что
$$\Bigg|x-\frac{p_n}{q_n}\Bigg| = \big|x-[a_0,...,a_n]\big|=\frac{1}{K_n(a_1,...,a_n)K_{n+1}(a_1,...,a_n,x_{n+1})}.$$\newpage


%================================================================
%275
\noindent
Используя двустороннюю оценку $a_{n+1}<x_{n+1}<a_{n+1}$, а также, что каждая\linebreak
континуата --- возрастающая функция любой из этих переменных,\linebreak получаем
$$\frac{1}{q_nK_{n+1}(a_1,...,a_n,a_{n+1}+1)}<\bigg|x-\frac{p_n}{q_n}\bigg|<\frac{1}{q_nq_{n+1}}$$
Но $K_{n+1}(X_1,...,X_n,X_{n+1}+1)$. Действительно, первая континуанта, по\linebreak
определению, равна $K_{n+2}(X_1,...,X_{n+1},1)$, тогда как вторая равна по\linebreak
определению $K_{n+1}(X_1,...,X_{n+1})+K_n(X_1,...,X_n)$, \:\:т.е. второй континуанте.\linebreak
Следовательно,
$$ K_{n+1}(a_1,...,a_n,a_{n+1}+1)\leqslant K_{n+2}(a_1,...,a_{n+1},a_{n+2})=q_{n+2},$$
откуда и получается требуемая оценка. Другие неравенства выводятся\linebreak
немедленно.\newline
\\
\hspace*{15pt}\textbf{c.} Зная, что $|x-p_n/q_n|<1/2q_n$ (соотношение (12)), и что\linebreak
$|p_n/q_n-p/q|\geqslant1/q_n$ (так как $q=q_n$), получаем, что $|x-p/q|>1/2q_n$,
что и дает искомое неравенство.\newline
\\
\hspace*{15pt}\textbf{d.} Матричные соотношения показывают, что матрица 
$\begin{pmatrix}
	p_n&  p_{n-1}\\
	q_n& q_{n-1}\\
\end{pmatrix}$\linebreak
обратима над $\mathbb{Z}$. Следовательно, можно записать $p=\alpha p_n+\beta p_{n-1}$ и \linebreak
$q=\alpha q_n+\beta q_{n-1}$, где $\alpha$ и $\beta$ — целые. Однако $q<q_n$, откуда следует,\linebreak
что $\beta$ — не нуль и что $\alpha$ и $\beta$ имеют противоположные знаки. Кроме\linebreak
того, согласно доказанному в вопросе (а), $p_n-xq_n$ и $p_{n-1}-xq_{n-1}$ тоже\linebreak
имеют противоположные знаки. Отсюда $\alpha(p_n-xq_n)$ и $\beta(p_{n-1}-xq_{n-1}$\linebreak
одного\:\: знака,\:\: а\:\: потому
$$|p-xq|=|\alpha(p_n-xq_n)+\beta(p_{n-1}-xq_{n-1})|\geqslant|\beta|\cdot|p_{n-1}-xq_{n-1})|>|p_n-xq_n|$$
\\
\noindent\textbf{8. Факториал и простые числа} \newline 
\\
\hspace*{15pt}\textbf{a.} Пусть $n=p_1^{\alpha_1}...p_r^{\alpha_r}$  — разложение $n$ на простые множители. \linebreak
Предположим сначала, что $r>1$. Тогда $p_i^{\alpha_i}<n$ и, следовательно, делит\linebreak
$(n-1)!$. Если $r=1$, то так как $n$ — непростое, это приводит к тому,\linebreak
что $\alpha_1>1$. Если $\alpha_1=2$, то числа $p_1$ и $2p_1$ встречаются в разложении\linebreak
$(n-1)!$, кроме случая $p_1=2$. Если $\alpha_1>2$, то числа $p_1$ и $p_1^{\alpha_1}$ меньше $n$\linebreak
и, следовательно, появляются в разложении $(n-1)!$.\newline
\\
\hspace*{15pt}\textbf{b.} Действительно, очевидно, что всякое целое число $k$ из интервала\linebreak
$[2, n+1]$ делит $(n+1)!+k$. Отсюда мы нашли те целые числа, которые\linebreak
искали.\newpage

%275
%=====================================================================
% 276
\noindent\hspace*{15pt}\textbf{c.} Одно из двух: либо $n!+1$ — простое число, и тогда задача реше­на,\linebreak
либо оно составное. В последнем случае оно не может делиться на\linebreak
простое число, меньшее или равное $n$. Итак, оно делится на простое, большее $n$, и, разумеется, $<n!+1$. Это доказательство, в действитель­ности, аналогично доказательству Евклида бесконечности множества простых чисел.\newline
\\
\hspace*{15pt}\textbf{d.} Первые числа $e_i$ являются, действительно, простыми: $e_1=2$,\linebreak
$e_2=3,~e_3=7,~e_4=43$. Однако следующее\:\: $e_5=1807=13\times139$\:\: уже нет.\linebreak
В действительности при $5\leqslant i\leqslant17$ числа $e_i$ составные. Эти числа, очевидно,\linebreak
взаимно простые. Можно также доказать, что существует такая\linebreak
вещественная константа $E\approx1,26$, что $e_n=\lfloor E^{2n}+\frac{1}{2}\rfloor$, но это похоже\linebreak
на шутку, как и для константы $K$ из упражнения 40.\newline
\\
\noindent\textbf{9. Каноническое разложение n! } \newline 
\\
\hspace*{15pt}Если $v_p(m)$ обозначает показатель, с которым простое число $p$ вхо­дит\linebreak
в число $m$, то $v_p(n!)=\sum_{1\leqslant m\leqslant n}v_p(m)$ и остается только доказать, что\linebreak
эта сумма равна $S_n=\sum^{\infty}_{i=1}\lfloor n/p^i\rfloor$. Это можно сделать по индук­ции,\linebreak
доказывая, что $S_{n+1}=S_n+v_p(n+1)$, и проверяя, что $S_1=0$. Если $a$ и $b$\linebreak
— два целых числа, то записывая $a=bq+r$, где $0\leqslant r<b$, легко доказать,\linebreak
что $\lfloor(a+1)/b\rfloor-\lfloor a/b\rfloor$ равно $0$, если $b\dagger a+1$, и равно $1$, если $b~|~a+1$.\linebreak
Следовательно,
\begin{equation*}\lfloor (n+1)/p^i\rfloor - \lfloor n/p^i\rfloor =
\begin{cases}
	1,& \text{если }i\leqslant v_p(n+1),\\
	0& \text{в противном случае.}\\
\end{cases}
\end{equation*}
Отсюда $S_{n+1}-S_n=\sum_{1\leqslant i\leqslant v_p(n+1)}1=v_p(n+1)$.\newline
\\
\noindent\textbf{10. Уравнение Ферма для $n=2$ и $n=4$} \newline 
\\
\hspace*{15pt}\textbf{a.} Если $x$ и $y$ нечетны,\:\: $x^2\equiv y^2\equiv 1~(mod~4)$\:\: и, следовательно,\linebreak
$z^2\equiv 2~(mod~4)$, что невозможно. Если $(x,y,z)$ — решение уравнения,\linebreak
то $(dx,dy,dz)$ — также решение уравнения для любого $d\in \mathbb{Z}$. Обратно,\linebreak
если $d=\text{НОД}(x,y)$, то $d^2|z^2$, откуда $d|z$ и $(x/d,~y/d~,z/d)$ — также\linebreak
решения.\newline
\\
\hspace*{15pt}\textbf{b.} Если $(x+iy)=(1+i)(\alpha+i\beta)$, то $x=\alpha-\beta$ и $y=\alpha+\beta$, что дает\linebreak
искомый результат (см. по этому поводу упражнение 12).\\

В $\mathbb{Z}[i]$ имеем $z^2=(x+iy)(x-iy)$, где $x$ и $y$ имеют \textbf{противоположную}\linebreak
\textbf{четность}. Отсюда ясно, что $x+iy$ и $x-iy$ взаимно просты.\linebreak
Действительно, единственное неприводимое число $\pi$, которое мог­ло бы\linebreak
делить одновременно $x+iy$ и $x-iy$, должно делить их сумму $2x$\linebreak
%
%276
%===================================================================
%______Внимательно, тк выше нет разрыва страницы!!!!_________________
% 277
%
\noindent и разность $2y$, а потому и число 2, являющееся линейной комбинацией\linebreak
$2x$ и $2y$. Но разложение 2 на неприводимые есть $(1+i)(1-i)$, тогда как\linebreak 
ни $1+i$, ни $1-i$ не делят $x+iy$ ($x$ и $y$ противоположной четности).

Однако в факториальном кольце (каковым является $\mathbb{Z}[i]$), если про\linebreak
изведение двух взаимно простых множителей является квадратом, то\linebreak
это же справедливо и для каждого из сомножителей, являющихся взаим-\linebreak
но простыми, с точностью до \textbf{обратимых элементов}. Итак, $x+iy=$\linebreak
$=\pm i(\alpha+i\beta)^2$ со взаимно простыми $\alpha$ и $\beta$, что отвечает на прямую поло-\linebreak
вину вопроса. Обратное легко проверить непосредственно.

Например, $3^2+4^2=5^2~(u=1,~v=2),~~5^2+12^2=13^2~(u=2,~v=3)$.\newline
\\
\hspace*{15pt}\textbf{c.} Предположим, что $x$ и $y$ взаимно просты. Тогда можно считать,\linebreak
что $x$ нечетно, $y=2y'$ — четно. Следовательно, $z$ нечетно. Теперь\linebreak
достаточно записать $y^2=(z-x)(z+x)$, а затем $y'^2=\frac{z-x}{2}\frac{z+x}{2}$. Два\linebreak
взаимно простых числа $\frac{z-x}{2}$ и $\frac{z+x}{2}$ дающие в произведении квадрат,\newline
сами являются квадратами. Поэтому немедленно получаем решение.\newline
\\
\hspace*{15pt}\textbf{d.} Можно предположить, что $x$ и $y$ взаимно просты. Запишем\linebreak
$x^4+y^4=(x^2)^2+(y^2)^2$ и, применяя предыдущий результат, предполагая\linebreak
(при необходимости $x$ и $y$ можно поменять местами), что $x$ нечетно, $y$\linebreak
четно, получим:
$$x^2=u^2-v^2,\quad y^2=2uv,\qquad u,v>0,\quad \Nod(u,v)=1.$$
Тогда имеем $x^2+v^2=u^2$ с $\Nod(x,v)=1$. Применим еще раз предыдущий\linebreak
результат, учитывая, что $x$ нечетно:
$$x=a^2-b^2,\quad v=2ab,\quad u=a^2+b^2,\qquad a,b>0,\quad\Nod(a,b)=1.$$
Отсюда выводим $y^2=2uv=4uab$. Однако $u$, $a$ и $b$ попарно взаимно\linebreak
просты, а произведение $4uab$ --- квадрат. Следовательно, $u$, $a$ и $b$ ---\linebreak
квадраты: $a=c^2$, $b=d^2$. Поэтому
$$c^4+d^4=a^2+b^2=u\text{\: квадрат}.$$
Но $x^4+y^4=(u^2+v^2)^2>u=c^4+d^4$. Доказательство закончено, так как\linebreak
в $\mathbb{N}$ не существует бесконечной строго убывающей последовательности\linebreak
\textit{(это и есть метод бесконечного спуска, принадлежащий Ферма)}.\newline
\\

\noindent\textbf{11. Простое \textbf{диофантово уравнение} } \newline 
\\
\hspace*{15pt}\textbf{a.} Пары $(\pm i,0)$ и $(\pm 2i,\pm i)$ являются решениями в $\mathbb{Z}[i]$.\\
\\
Если бы существовало целое решение, то оно удовлетворяло бы со-\linebreak
отношению $3y^2=x^2+1$, что невозможно, так как 3 не может делить\linebreak
\pagebreak
%
%277
%=====================================================================
%278
%
\noindent сумму двух квадратов, стоящую справа (более простое рассуждение \linebreak
за­ключается в том, чтобы привести уравнение по модулю 3, аналогично\linebreak
тому, как это сделано в следующем вопросе).\newline
\\
\hspace*{15pt}\textbf{b.} Приведя уравнение по модулю 5, получаем $x^2+z^2=0$. Однако\linebreak
2 не является корнем квадратным из —1 по модулю 5. Следовательно,\linebreak
$z\equiv\pm2~(mod~5)$, что дает нам решение $(k,\pm k,\pm 2k)$. Однако оно не\linebreak
единственно.\newline

\noindent\hspace*{15pt}\textbf{c.} Очевидно, что решений нет, если —1 не является квадратичным\linebreak
вычетом по модулю $p$. Поэтому $p\equiv1~(mod~4)$. При этих условиях (мы это\linebreak
уже видели) число $p$ может быть записано в виде суммы двух квадратов,\linebreak
что дает бесконечное множество решений рассматриваемого уравнения.\newline
\\

\noindent\textbf{12. Кольцо $\mathbb{Z}[\theta]/(a+\theta b),~\theta$ --- квадратичная иррациональность,\linebreak \hspace*{27pt}$\Nod(a,b)=1$ } \newline 
\\
\hspace*{15pt}\textbf{a.} Если доказать, что $[i]_{a+ib}=\varphi(t)$, то $[x+iy]_{a+ib}=\varphi(x+ty)$, что до-\linebreak
казывает сюръективность $\varphi$. Достаточно рассмотреть в $\mathbb{Z}[i]$ уравнение\linebreak
$i-t=(a+ib)(v+iu)=(av-bu)+i(au+bv)$. Если $u$, $v$ — коэффициенты\linebreak
Безу для $a$ и $b$ и положить $t=bu-av$, то получим искомое соотношение.\linebreak
\\
\hspace*{15pt}\textbf{b.} Если $\Ker \varphi=(a^2+b^2)\mathbb{Z}$, то $\varphi$ индуцирует изоморфизм $\mathbb{Z}/(a^2+b^2)$\linebreak
на $\mathbb{Z}/(a+ib)$, а так как $t$ переходит в $i$, то имеем $t^2\equiv-1~(mod~a^2+b^2)$.\linebreak
Из очевидного сравнения $a^2\equiv-b^2~(mod~ a^2 + b^2)$ получаем $(ab^{-1})^2\equiv-1$\linebreak
$(mod~a^2+b^2)$, где $b^{-1}$ --- обратный элемент к $b$ по модулю $a^2+b^2$.\linebreak
Следовательно, если $a+tb\equiv 0~(mod~ a^2+b^2)$, то $t\equiv -ab^{-1}~(mod~a^2+b^2)$,\linebreak
откуда $t^2\equiv -1~(mod~a^2+b^2)$. Для выбранного $t$, $t=bu-av$, известно,\linebreak
что $a+tb\equiv0~(mod~a^2+b^2)$ и элемент $t=bu-av$ и в самом деле является\linebreak
противоположным к $ab^{-1}$ по модулю $a^2+b^2$.\\
\\
\hspace*{15pt}\textbf{\textit{Примечание}}

\hspace*{10pt} Используя выражение $t=bu-av$ и равенство $au+bv=1$ с помощью\linebreak
прямых вычислений можно показать, что $t^2\equiv-1 ~(mod~a^2+b^2)$. Но\linebreak
можно также использовать соотношение $t-i\equiv0~(mod~a+ib)$, откуда\linebreak
$t+i\equiv0~(mod~a--ib)$, из чего выводим $t^2+1\equiv0~(mod~a^2+b^2)$.$\qquad \blacksquare$ \linebreak
\\
\hspace*{15pt}\textbf{c.} Положив $\mu(x+iy)=x+ty$ и используя соотношение $t^2\equiv-1$\linebreak
$(mod~a^2+b^2)$, покажем, что $\mu:\mathbb{Z}[i]\rightarrow\mathbb{Z}/(a^2+b^2)$ --- \textit{морфизм колец}.\linebreak
Ясно, что $\mu(m)=m$ для $m\in\mathbb{Z}$ и $\mu(a+ib)=a+tb\equiv0~(mod~a^2+b^2)$.\linebreak
Отсюда следует, что $\mu$ дает переход к факторкольцу и $Ker~\varphi=$\linebreak
$=(a^2+b^2)\mathbb{Z}$, где равенство следует из того, что $\mu$ и $\varphi$ индуцируют\linebreak
взаимно обратные морфизмы.\newpage
%
%278
%======================================================================
%279

К примеру, $1+i$ делит $x+iy$ тогда и только тогда, когда $x$ и $y$ одной\linebreak
четности. Для $a+ib=9+2i$ имеем $t=38$ и потому $x+iy$ делится на\linebreak
$9+2i$ тогда и только тогда, когда $x+38y$ делится на 85.\newline
\\
\hspace*{15pt}\textbf{d.} $\mathbb{Z}[i]/(a+ib)$: Существуют два очевидных случая, когда кольцо\linebreak
$\mathbb{Z}[i]/(a+ib)$ состоит из $(a^2+b^2)$ элементов. Первый случай --- когда\linebreak
$b=0$, второй --- когда $a$ и $b$ взаимно просты и кольцо $\mathbb{Z}[i]/(a+ib)$ \linebreak
изоморфно $\mathbb{Z}/(a^2+b^2)$. В общем случае, если $d=\Nod(a,b),~a=da'$,\linebreak
$b=db'$ каноническое отображение $\mathbb{Z}[i]/(a+ib)$ в $\mathbb{Z}[i]/(d)$ сюръек­тивно\linebreak
и с ядром, изоморфным $\mathbb{Z}[i]/(a'+ib')$ (каноническая инъекция\linebreak
$\mathbb{Z}[i]/(a'+ib')\rightarrow \mathbb{Z}[i]/(a+ib)$ получается умножением на $d$ и образ --- в\linebreak
точности это кольцо), откуда следует результат.\newline
\\
\hspace*{15pt}\textbf{e.} Кольцо $\mathbb{Z}[\theta]$ снабжено автоморфизмом, который переводит $\theta$ в\linebreak
другой корень $\widetilde{\theta}$ уравнения $X^2-SX+P=0$ и нормой: $N(a+b\theta)=$\linebreak
$=(a+b\theta)(a+n\widetilde{\theta})=a^2+Sab+Pb^2$. Положив $z=a+b\theta$, докажем, что\linebreak
кольца $\mathbb{Z}[\theta]/(z)$ и $\mathbb{Z}/N(z)$ изоморфны.

Для этого достаточно найти в $\mathbb{Z}/N(z)$ элемент $t$, играющий роль $\theta$\linebreak
в $\mathbb{Z}[\theta]/(z)$, т.е. $a+bt\equiv0~(mod~N(z))$. Это возможно, так как $b$ взаимно\linebreak
просты с $N(z)=a^2+Sab+Pb^2$. Следовательно, он обратим по модулю\linebreak
$a^2+Sab+Pb^2$ и потому $t=-ab^{-1}~(mod~N(z))$. Элемент $t$ удовлетворяет\linebreak
тому же уравнению, что и $\theta$:
$$t^2-St+P\equiv0~(mod~N(z)).$$
Докажем теперь, что отображение $\mu:\mathbb{Z}[\theta]\rightarrow\mathbb{Z}/N(z)$, определенное\linebreak
по правилу $\mu(x+y\theta)=x+yt$, является морфизмом колец, который\linebreak
можно пропустить через  $\mathbb{Z}[\theta]/(z)\rightarrow\mathbb{Z}/N(z)$. Впрочем, $N(z)$ делится\linebreak
на z и потому имеется канонический морфизм $\varphi:\mathbb{Z}/N(z)\rightarrow\mathbb{Z}[\theta]/(z)$.\linebreak
Тот факт, что эти морфизмы взаимно обратны, равносилен тому, что\linebreak
$t\equiv\theta~(mod~z)$, и это как раз тот случай, так как $bt\equiv-a\equiv b\theta~(mod~z)$.\linebreak
Последнее равенство можно упростить, сократив на $b$ ($b$ обратим по\linebreak
модулю $z$ ввиду $ua+vb=1$, что приводит к $u(a+b\theta)+(v-u\theta)b=1)$.\linebreak
Отсюда можно сделать вывод, что кольцо $\mathbb{Z}[\theta]/(z)$ состоит из $|N(z)|$\linebreak
элементов для взаимно простых $a$ и $b$, а затем перейти к случаю\linebreak
произвольных $a$ и $b$.\newline
\\
\noindent\textbf{13. НОД в $\mathbb{Z}[i]$ и суммы двух квадратов} \newline 
\\
\hspace*{15pt}\textbf{a.} Специфическое предположение для $\mathbb{Z}[i]$, что $p$ делит\linebreak
(x+i)(x-i). Тогда $z=u+iv=\Nod(p,x+i)$ является \textbf{настоящим}\linebreak
делителем $p$: действительно,$z$ не может быть обратимым (если $\pi$\linebreak
неприводимый элемент в $\mathbb{Z}[i]$, делящий $p$, то он делит $(x+i)(x-i))$.\linebreak
Сле­довательно, $\pi$ или $\pi$ делит $p$ и $x+i$ и $z$ не является ассоциированным\newpage
%
%279
%=====================================================================
%280
%
с $p$ (так как $p\nmid x+i$). Поэтому, если $z'$ такое число, что $zz'=p$, то\linebreak
$$N(z)N(z')=p^2\quad\Rightarrow\quad N(z)=u^2+v^2=p.$$
Используя вычисление НОД в $\mathbb{Z}[i]$, находим:
$$1~301=25^2+26^2,\quad1~000~037=991^2+134^2,\quad 2~000~004~973=39~027^2+21~838^2.$$
\hspace*{15pt}\textbf{b.} Если $z=u+iv=\Nod(n,x+iy)$, числа $u$ и $v$ взаимно просты\linebreak
то можно применить результат упражнения 12. Так как $z$ делит $n$, $z\overline{z}$\linebreak
делит $n$. С другой стороны, так как $z\in n\mathbb{Z}[i]+(x+iy)\mathbb{Z}[i]$, то получаем
\begin{eqnarray*}
z\overline{z}\in(n\mathbb{Z}[i]+(x+iy)\mathbb{Z}[i])(n\mathbb{Z}[i]+(x-iy)\mathbb{Z}[i])\subset\qquad\\
\subset n\mathbb{Z}[i]+(x^2+y^2)\mathbb{Z}[i]=n\mathbb{Z}[i].
\end{eqnarray*}
Целые числа $n$ и $z\overline{z}$ делят друг друга, откуда следует их равенство.\newline
\\
\hspace*{15pt}\textbf{c.} Имеем $y_k=y^{p-1}=1$ (малая теорема Ферма). Для $y\in H$ пусть\linebreak
$i$ --- наибольшее целое число, такое, что $y_i\neq1;~1\leqslant i\geqslant k$, так как, с\linebreak
одной стороны, $y_k=1$, а с другой, $y_1\neq 1$ по предположению. Так как\linebreak
$1=y_{i+1}=y_i^2$ , то получаем, что $y_i=-1$ и $y_{i-1}$ --- корень квадратный\linebreak
из —1 по модулю $p$. Чтобы пересчитать $H$, рассмотрим его дополнение\linebreak
\textit{(плохие элементы)} $G=\{ y\in U(\mathbb{Z}_p),~y^{2q}=1\}$. Это подгруппа \textbf{циклической}\linebreak
группы $U(\mathbb{Z}_p)$. Несложное рассуждение показывает, что $|G|=2q$\linebreak
и, следовательно, $\frac{|G|}{|U(\mathbb{Z}_p)|}=\frac{1}{2^{k-1}}\leqslant \frac{1}{2}$. Вероятность случайным образом\linebreak
выбрать $m$ плохих элементов, следовательно, $\frac{1}{2^m}$. Можно запрограм-\linebreak
мировать вероятностный алгоритм, приведенный ниже (не забывайте\linebreak
вычислять $y^q~mod~p$ при помощи дихотомии!) и сравнить его с детер­-\linebreak
министским алгоритмом, который дает $(\frac{p-1}{2})!~\mod{p}$ как корень\linebreak 
ква­дратный из --1 (который из двух более эффективен?).\\
\begin{lstlisting}[mathescape=true,showspaces=false]
	do{
		$\text{Выбрать}$ $y$ $\text{случайно в}$ $[2...p-2];~y\longleftarrow y^q\mod{p};~y'\longleftarrow y^2$;
	}while( $y'==1$ );
	while( $y'\neq-1\mod{p}$ )
	{		 						//$y'=y^2$
		$y\longleftarrow y'$;
		$y'\longleftarrow y^2$;
	}     				  //$y~-~\text{корень квадратный из -1 по модулю }p$
\end{lstlisting}
\ \newline
\noindent\textbf{14. Делимость сумм $x^2+2y^2$} \newline 
\\
\hspace*{15pt}\textbf{a.} Норма $N$ может быть продолжена на поле $\mathbb{Q}[\sqrt{-2}]$, подполе поля\linebreak
$\mathbb{C}$,\: натянутое\: на\: 1\: и\:\: $\sqrt{-2}$.\:\: $\mathbb{Q}[\sqrt{-2}]$\:\: есть\: расширение\: степени 2 с базой%\linebreak
\pagebreak
%
%280
%====================================================================
%281

\noindent $\{1,\sqrt{-2}\}$, и, конечно, продолженная норма остается \textit{мультипликативной}.\\

Если $c=r+t\sqrt{-2}\in\mathbb{Q}[\sqrt{-2}]$ и $x$, $y~\in~\mathbb{Z}$ выбраны так, что $|r-x|\leqslant\frac{1}{2}$\linebreak
и $|t-y|\leqslant\frac{1}{2}$, то, обозначая $x+y\sqrt{-2}$ через $q$, имеем:
$$ N(c-q)=(r-x)^2+2(t-y)^2\leqslant\frac{1}{4}+\frac{2}{4},$$
откуда $N(c-q)<1$.

Если $a$ и $b$ --- два элемента $\mathbb{Z}[\sqrt{-2}]$, где $b\neq0$, то достаточно при-\linebreak
менить этот результат с $a/b\in\mathbb{Q}[\sqrt{-2}]$, чтобы найти $q\in\mathbb{Z}[\sqrt{-2}]$ такое,\linebreak
что $N(a/b-q)<1$ или $N(a-bq)<N(b)$, что доказывает евклидовость
$\mathbb{Z}[\sqrt{-2}]$ относительно $N$.\newline
\\ 
\hspace*{15pt}\textbf{b.} С помощью рассуждений, совершенно аналогичных доказатель­ству\linebreak
леммы 5, докажем, что для неприводимого числа $z$ из $\mathbb{Z}$ выполнено:\linebreak
$N(z)$ --- простое число. Копируя доказательство предложения 6, мож­но\linebreak
показать, что положительный делитель $x^2+2y^2$, где $x$ и $y$ взаимно\linebreak
просты, имеет форму $u^2+2v^2$.\newline
\\
\hspace*{15pt}\textbf{c.} Если $p$ представляется в виде $p=x^2+2y^2$, то $y$ не нуль по модулю\linebreak
$p$ и $-2=(xy^{-1})^2$ в $\mathbb{Z}/p\mathbb{Z}$, так как $y$ обратим в $\mathbb{Z}_p$; значит $-2$ --- квадрат\linebreak
по модулю $p$.

Обратно, если $-2$ есть квадрат по модулю $p$, то найдется $x$\linebreak 
та­кой, что $p$ делит $x^2+2$. Согласно предыдущему, $p$ представимо в виде\linebreak
$u^2+2v^2$.\newline
\\

\noindent\textbf{15. Делимость целых чисел вида $x^2-2y^2$} \newline 
\\
\hspace*{15pt}\textbf{a.} На этот раз кольцо есть $\mathbb{Z}[\sqrt{2}$. В отличие от уже изученных\linebreak 
слу­чаев это кольцо \textbf{вещественное}: $\{1,\sqrt{-2}\}$ является $\mathbb{Z}$-базой $\mathbb{Z}[\sqrt{-2}]$.\linebreak
Кольцо частных его есть поле $\mathbb{Q}[\sqrt{-2}]$, имеющее инволютивный автомор-\linebreak
физм $z\mapsto\widetilde{z}$, который $z=r+t\sqrt{2}$ ставит в соответствие $\widetilde{z}=r-t\sqrt{2}$. Этот\linebreak
автоморфизм оставляет на месте $\mathbb{Z}[\sqrt{2}]$ и позволяет определить мульти-\linebreak
пликативную норму $N$ через $N(z)=z\widetilde{z}$. Другими словами $N(r+t\sqrt{2})=$\linebreak
$=r^2-2t^2$. Доказательство того, что $\mathbb{Z}[\sqrt{2}]$ является евклидовым для $|N|$,\linebreak
аналогично решению упражнения 14. Заметим, однако, что $N$ может\linebreak
принимать отрицательные значения, откуда и использование абсолют­ного\linebreak
значения $N$.\newline
\\
\hspace*{15pt}\textbf{b.} Заметим, что —1 является нормой: $-1=1^2-2\times1^2=N(1+\sqrt{2})$.\linebreak
Используя рассуждения, аналогичные предложению 6, докажем, что \linebreak
делитель\: (положительный или нет) числа\: вида\: $x^2-2y^2$\: ($x$\: и\: $y$\:\hspace{3pt} взаимно

\pagebreak
%
%281
%========================================================================
%282
%
\noindent простые) имеет вид (с точностью до знака $\pm1$) и $u^2-2v^2$. Но равенство\linebreak
$$-(u^2-2v^2)=N((1+\sqrt{2})(u+v\sqrt{2}))=(u+2v)^2-2(u+v)^2$$
позволяет пренебречь знаком $\pm$. Следуя соответствующему этапу \linebreak
ре­шения упражнения 13, можно доказать, что нечетное простое число\linebreak
$p$ имеет вид $x^2-2y^2$ тогда и только тогда, когда 2 является квадратом\linebreak
по модулю $p$, что эквивалентно $|p|\equiv\pm1~(\mod{8}~)$.\newline
\\

\noindent\textbf{16. Кольца $\mathbb{Z}[\sqrt{-3}]$ и $\mathbb{Z}[\sqrt{10}]$ нефакториальны} \newline 
\\
\hspace*{15pt}\textbf{a.} Простое натуральное число, не являющееся нормой в кольце,\linebreak
остается неприводимым в этом кольце (возьмите норму от произве-\linebreak
дения). Если $p$ и $q$ таковы и $pq$ — норма ($pq=N(z)=z\widetilde{z}$), то z и $\widetilde{z}$\linebreak
неприводимы (используйте норму) и $pq$ разлагается двумя способами:\linebreak
$pq=z\widetilde{z}$. Например, $2\times5=(1+\sqrt{-3})\times(1-\sqrt{-3})$. Это доказывает\linebreak
нефакториальность кольца $\mathbb{Z}[\sqrt{-3}]$ Можно проверить, что элементы\linebreak
$2(1+\sqrt{-3})$ и 10 не имеют $\Nod$ в $\mathbb{Z}[\sqrt{-3}]$ и что идеал, порожденный\linebreak
$2(1+\sqrt{-3})$ и 10, неглавный.\newline
\\
\hspace*{15pt}\textbf{b.} Можно использовать тот же тип рассуждений, что и выше,\linebreak
однако в этом случае норма кольца $\mathbb{Z}[\sqrt{10}]$ уже не является неотрицатель-\linebreak
ным числом... Однако все улаживается, так как —1 является значением\linebreak
нормы: $-1=3^2-10\times1^2=N(3+\sqrt{10})...$ Вот плохое разложение на\linebreak
неприводимые:$2\times3=(4+\sqrt{10})\times(4-\sqrt{10})$ (можно проверить, что ни\linebreak
2, ни 3 не являются нормами, рассуждая по модулю 10).\newline
\\
\noindent\textbf{17. Целозамкнутые кольца} \newline 
\\
\hspace*{15pt}\textbf{a.} Пусть $F(X)$ --- унитарный полином с целыми коэффициентами:
$$F(X)=X^n+a_{n-1}X^{n-1}+...+a_2X^2+a_1X+a_0$$
и $p/q$ рациональное число ($p$ и $q$ взаимно просты), являющееся корнем\linebreak
$F(X)$. Тогда
$$ p^n+a_{n-1}p^{n-1}q+a_{n-2}p^{n-2}q^2+...+a_2p^2q^{n-2}+a_1pq^{n-1}+a_0q^n=0~,$$
откуда следует, ввиду того, что $p$ и $q$ взаимно просты и $q$ делит $p^n$,\linebreak
что $q=\pm1$. Это доказывает целозамкнутость любого факториального\linebreak
кольца.\newline
\\
\hspace*{15pt}\textbf{b.} Нецелозамкнутость $\mathbb{Z}[\sqrt{d}]$ следует из тождества:
$$x^2-x=\frac{1-d}{4}=0\quad \text{с}\quad x=\frac{1+\sqrt{d}}{2}.$$
\newpage
%
%282
%========================================================================
%283
%
\noindent Заметим, что $\pm2$ не может быть нормой в $\mathbb{Z}[\sqrt{d}]$, так как равенство\linebreak
$x^2-dy^2=\pm2$ приводит к тому, что в $\mathbb{Z}/4\mathbb{Z}$ $x^2-y^2=2$, что невоз-\linebreak
можно. Отправляясь от равенства $2=uv$, получаем $4=N(u)N(v)$ и,\linebreak
следовательно, $N(u)=\pm1$ или $N(v)=\pm1$, что показывает неприводи-\linebreak
мость числа 2. Но 2 — непростое число:
$$2\mid(1+\sqrt{d})\cdot(1-\sqrt{d}),\qquad\text{хотя}\quad 2\nmid(1+\sqrt{d})\text{ и }2\nmid(1-\sqrt{d}).$$
\\
\hspace*{15pt}\textbf{c.} В $\mathbb{Z}[2i]$ число 2 неприводимо. В самом деле, из равенства\linebreak
$2=zz'$ получаем $4=N(z)N(z')$ и поскольку $\mathbb{Z}[2i]$ не содержит эле-\linebreak
мента нормы 2 ($a^2+4b^2$ не принимает значение $2$), либо $N(z)=1$, либо\linebreak
$N(z')=1$, откуда следует обратимость $z$ или $z'$.

Элемент 4 может быть разложен двумя способами в произведение\linebreak
неприводимых неассоциированных элементов: $4=2\times2=-2i\times2i$.\linebreak
Действительно, неассоциированность $2i$ и $2$ следует из того, что един-\linebreak
ственным числом, которое могло бы их ассоциировать, является $i$, не\linebreak
являющееся элементом в $\mathbb{Z}[2i]$. Кольцо $\mathbb{Z}[2i]$ не является факториаль­ным.\linebreak

Разложение числа 4 демонстрирует еще один феномен. Существуют\linebreak
два числа $a$ и $b$ такие, что $a^2\mid b^2$ , но $a$ не делит $b$. Кольцо $\mathbb{Z}[2i]$, следо-\linebreak
вательно, не является целозамкнутым. Другая странность, связанная с\linebreak
этим равенством: 2 неприводимо, но не является простым!

Наконец, $\mathbb{Q}[i]$ --- поле частных $\mathbb{Z}[2i]$, однако многочлен $X^2+1$ непри-\linebreak
водим в $\mathbb{Z}[2i][X]$, но не в $\mathbb{Q}[i][X]$. В противном случае его разложение\linebreak
на неприводимые элементы было бы разложением в поле дробей $\mathbb{Z}[2i]$,\linebreak
однако $(X+i)(X-i)$ не является разложением над $\mathbb{Z}[2i]$.\newline
\\
\noindent\textbf{18. Целые элементы; целые квадратичности} \newline 
\\
\hspace*{15pt}\textbf{a.} Пусть $(1,\alpha)$ --- база $K$ над $\mathbb{Q}$. Докажите, что $\alpha$ является корнем\linebreak
квадратного многочлена с коэффициентами из $\mathbb{Z}$. После этого приведи-\linebreak
те число, появляющееся под знаком радикала к такому виду, чтобы у\linebreak
него не было множителей, являющихся полными квадратами.\newline
\\
\hspace*{15pt}\textbf{b.} Целые алгебраические числа являются элементами $\mathbb{Z}$. Другими\linebreak
словами, рациональные алгебраические числа являются целыми рацио-\linebreak
нальными числами.\newline
\\
\hspace*{15pt}\textbf{c.} Если $\frac{1+\sqrt{d}}{2}$ удовлетворяет уравнению $x^2-sx+p=0$, где $s,p\in\mathbb{Z}$,\linebreak
то при $s=1$, $р=\frac{1-d}{4}$. Следовательно, $d\equiv1~(\mod{4})$. Обратно, если\linebreak
$d\equiv1~(\mod{4})$, то $s$ и $p$ определены так:
$$s=\frac{1+\sqrt{d}}{2}+\frac{1-\sqrt{d}}{2}=1,\qquad p=\frac{1+\sqrt{d}}{2}\times\frac{1-\sqrt{d}}{2}=\frac{1-d}{4},$$
\newpage
%
%283
%========================================================================
%284
%
\noindent--- целые числа, и $\frac{1+\sqrt{d}}{2}$ является корнем уравнения $x^2-sx+p=0$.\linebreak
\\
\noindent\textbf{19. Целые числа в $\mathbb{Q}(\sqrt{d}$} \newline 
\\
\hspace*{15pt}\textbf{b.} Равенства:
$$x+y=(z+\sigma(z))(z'+\sigma(z')),\quad xy=(z^2+\sigma(z)^2)z'\sigma(z')+(z'^2+\sigma(z')^2)z\sigma(z)$$
доказывают, что $x+y$ и $xy$ — элементы $\mathbb{Z}$. Следовательно, $x$ и $y$ --- целые\linebreak
алгебраические числа, а так как они принадлежат $\mathbb{Q}$ (они остаются на\linebreak
месте под действием $\sigma$), то $x,y\in\mathbb{Z}$. Итак, доказано, что элементы\linebreak
$zz'+\sigma(zz'),zz'\cdot\sigma(zz')$ и $(z+z')+\sigma(z+z'),(z+z')+\sigma(z+z')$ содержатся\linebreak
в $\mathbb{Z}$. Следовательно, $zz',~z+z'$ — целые алгебраические числа.\newline
\\
\hspace*{15pt}\textbf{c.} Всякий элемент $x$ из $\mathbb{Q}(\sqrt{d})$ является решением квадратного урав-\linebreak
нения над $\mathbb{Q}$. Следовательно, существуют целые $a$, $b$ и с такие, что\linebreak
$ax^2+bx+c=0$, где $a$ и $b$ не равны нулю одновременно. Если, кроме\linebreak
того, $x$ --- целый над $\mathbb{Z}$, то он корень унитарного многочлена с целыми\linebreak
коэффициентами $P$ и тогда $\Nod(P,aX^2+bX+c)$ есть унитарный\linebreak
многочлен степени, не превосходящей 2, аннулирующийся значением $x$.\newline
\\
\hspace*{15pt}\textbf{d.} Пусть $z=a+b\sqrt{d}\in\mathbb{Q}(\sqrt{d})$. Равенства: $z+\sigma(z)=2a$ и $z\sigma(z)=$\linebreak
$=a^2-db^2$ показывают, что $z$ — целое квадратичное число тогда и только\linebreak
тогда, когда $2a\in\mathbb{Z}$ и $a^2-db^2\in\mathbb{Z}$. Правое условие дает $d(2b)^2\in\mathbb{Z}$. Затем\linebreak
(так как $d$ не имеет квадратных множителей), обозначив  $a=u/2$ и $b=v/2$,\linebreak
предыдущее условие можно переписать так: $u^2-dv^2\in4\mathbb{Z}$. Используя\linebreak
то, что квадратами в $\mathbb{Z}/4\mathbb{Z}$ являются лишь 0 и 1, получаем:
$$ z~\text{целое квадратичное}~\Leftrightarrow 
\begin{cases}
u\equiv0~(mod~2),\quad v\equiv0~(mod~2),\\
\qquad\qquad\qquad\qquad\qquad \text{если}~d\equiv2,3~(mod~4),\\
u\equiv v~(mod~2),\quad \text{если}~d\equiv1~(mod~4).
\end{cases}$$
\\
\noindent\textbf{20. Евклидовость квадратичных колец} \newline 
\\
\hspace*{15pt}\textbf{b.} Будем различать два случая в зависимости от того, каков оста­-\linebreak
ток от деления $d$ на 4.\newline
\\
\hspace*{15pt}\textbf{Первый случай.} Пусть $d\not\equiv1~(mod~4)$. Для $z\in\mathbb{Q}(\sqrt{d}),~z=\alpha+\beta\sqrt{d},$\linebreak
где $\alpha,\beta\in\mathbb{Q}$ и $q\in A$ с $q=a+b\sqrt{d}$, имеем: $|N(z-q)|=|(\alpha-a)^2-d(\beta-b)^2|$,\linebreak
откуда извлекаем две оценки:
\begin{eqnarray*}
N(z-q)\leqslant|\alpha-a|^2+|d||\beta-b|^2,\quad\text{и при }d>0\\
|N(z-q)|\leqslant max(|\alpha-a|^2,d|\beta-b|^2),\qquad
\end{eqnarray*}

\pagebreak
%
%284
%========================================================================
%285
%
\noindent
Если выбрать $a,b\in\mathbb{Z}$ такие, что $|\alpha-a|\leqslant{1/2}$ и $|\beta-b|\leqslant{1/2}$, то\linebreak
получаем $|N(z-q)|\leqslant(1+|d|)/4$ и при $d>0: |N(z-q)|\leqslant{max(1/4,d/4)}$.\linebreak
Отсюда $N(z-q)<1$, так как $d\in\{-1,-2,2,3\}$.\\
\hspace*{15pt}\textbf{Второй случай}. Предположим, что $d\equiv{1} (\mod{4})$. Норма вычи-\linebreak
сляется следующим образом:
\begin{center}
$N\left(u+v\dfrac{1+\sqrt{d}}{2}\right)=\left(u+\dfrac{v}{2}\right)^2-d\left(\dfrac{v}{2}\right)^2$.
\end{center}
Для $z\in{Q}(\sqrt{d}), z=\alpha+\beta\frac{1+\sqrt{d}}{2}$ с $\alpha,\beta\in\mathbb{Q}$ и $q\in{A}, q=a+b\frac{1+\sqrt{d}}{2}$, где\linebreak
$a,b\in\mathbb{Z}$, имеем:
\begin{center}
$|N(z-q)|=\left|\left(\alpha-a+\dfrac{\beta-b}{2}\right)^2-d\left(\dfrac{\beta-b}{2}\right)^2\right|$.
\end{center}
Отсюда имеем следующие две оценки $|N(z-q)|$ в зависимости от зна-\linebreak
ка $d$:
\begin{center}
\hspace*{43pt}$d<0 :$\hspace{20pt}$\left(\alpha-a+\frac{\beta-b}{2}\right)^2+|d|\left(\frac{\beta-b}{2}\right)^2$,\hspace{20pt}$d>0 :$\newline
max$\left(\left|\alpha-a+\frac{\beta-b}{2}\right|^2, d\left|\frac{\beta-b}{2}\right|^2\right)$.
\end{center}
Если выбрать $b\in\mathbb{Z}$ так, что $|\beta-b|\leqslant{1/2}$, а затем $a\in\mathbb{Z}$ так, что\linebreak
$\left|\alpha-a+\dfrac{\beta-b}{2}\right|\leqslant{1/2}$, то $|N(z-q)|\leqslant{1/4}+|d|/16$ и при $d>0: |N(z-q)|\leqslant$\linebreak
max$(1/4, d/16)$, что во всех случаях должно давать $|N(z-q)|<1$.\linebreak
Поэтому $d\in\{-11,-7,-3,5,13\}$.\newline
\begin{center}
\begin{lstlisting}[mathescape=true]
$u+v\theta\mathrel{\stackrel{\rm def}=}{z'}\bar{z}$;
$u\longleftarrow{LeastRem(v,|N(z)|)}$; $x\longleftarrow{LeastRem}$
// $y\equiv v~(mod~N(x))$ и$~x\equiv u~(mod~N(z))$ с$~|y|,|x|<|N(z)|/2$
$\displaystyle r\longleftarrow x+y\theta;~r\longleftarrow\frac{rz}{N(z)};~q\longleftarrow\frac{(z'-r)\overline{z}}{N(z)};$
\end{lstlisting}
\textbf{Алгоритм 6.} Евклидово деление $z'$ на $z$ в $\mathbb{Z}[\theta]$,\newline
где $\theta=\sqrt{d}$ и $d=-1, -2, 2, 3$.
\end{center}
\hspace*{15pt}Конечно, возможна реализация евклидова деления, использующая\linebreak
только целочисленные вычисления. Элементы кольца $A$ кодируются сво-\linebreak
ими координатами в базе $\{1,\theta\}$ с $\theta=\sqrt{d}$, если $d\equiv2$ или $3 (\mod{4}$,\linebreak
$\theta=\dfrac{1+\sqrt{d}}{2}$, если $d\equiv1 (\mod{4})$. Для вычисления частного и евклидова\linebreak
остатка $z'$ для $z$, вычисляем $z'\bar{z}$ на целое число $N(z)$. Затем делим (точ-\linebreak
ным образом) полученные результаты на $\bar{z}$. Нам необходима функция\linebreak

\pagebreak
%
%285
%========================================================================
%286
%
\noindent{\it LeastRem:} Z$\times N^{\ast} \longrightarrow Z$,  для которой r = {\it LeastRem(a, b)} — наименьший\linebreak
остаток от деления а на b (|r|$\leqslant$ 6/2). Алгоритм 6 рассматривает более\linebreak
простой первый случай, когда d $\equiv$ 2 или 3 (mod 4).

Второй случай $d\equiv1$ (mod 4) (алгоритм 7) более сложен. Он использует\linebreak
переменные целые числа $x$ и $y$, предназначенные для установки в них,\linebreak
в соответствии со значениями переменных $a$ и $b$ из предыдущего\linebreak
доказательства, следующим образом: $y=b$, $x=2a+b$, $a=(x-y)/2$.

\def\MYdef{\mathrel{\stackrel{\rm def}=}}

\begin{lstlisting}[mathescape=true]
u+v$\theta \MYdef z'\overline{z}$
$y \longleftarrow LeastRem(v,|N(z)|);x \longleftarrow LeastRem(2u+y,2 \times |N(z)|);$
$y\equiv v (mod N(z))$ и $2u+y\equiv x (mod 2N(z))$
$\quad$ $c|y|<|N(z)|/2$ и $|x|<|N(z)|$
$r \longleftarrow (x-y)/2 +y^{\theta} ; r\longleftarrow rz/N(z); q\longleftarrow (z'-r) \overline{z}/N(z);$
\end{lstlisting}
\begin{center}
\parbox{10cm}{
{\bf Алгоритм 7.} Евклидово деление в $Z[\theta]$ при $\theta = \frac{1+\sqrt{d}}2$ и 
 $\hspace*{70pt} d = -11, -7, -3, 5, 13.$}
\end{center}
\ \\
\noindent\textbf{21. Нахождение колец мнимых квадратичностей}\\
\\
\hspace*{15pt}{\bf a.} Элемент $z\in A$ обратим тогда и только тогда, когда $N(z)=1$.\linebreak
Отсюда следует, что $U(A)={-1,1}$, кроме, возможно, $d=-1,-3$. Для\linebreak
$d=-1,~A=\mathbb{Z}[i]$ выполнено: $U(A)$ — циклическая группа порядка 4,\linebreak порожденная $i$; для $d=—3,~A=\mathbb{Z}[i]$ и $U(A)$ — циклическая группа,\linebreak 
порожденная элементом $j$ порядка 6.\newline
\\
\hspace*{15pt}{\bf b.} Пусть $b\in B^{\ast}$ — $U(B)$, для которого $\varphi(b)$ имеет наименьшее значе-\linebreak
ние. Если $a\in B$, то $a = bq + r$, где $\varphi(r)<\varphi(b)$, что приводит к $r\in U(B)$\linebreak
или $r=0$. Но так как $U(B)$ предполагается редуцированной к ${-1,1}$,\linebreak 
то $r=0,\pm1$ и, следовательно, $B/(b)=\{\overline{\mbox{0}},\overline{\mbox{1}},\overline{\mbox{ -1}}\}$, откуда и заключение.\newline
\\
\hspace*{15pt}{\bf c.} Для упомянутых значений $d$ мы видели (упражнение 20), что $A$ —\linebreak
евклидово кольцо. Докажем обратное. Предположим, что $A$ евклидово, и докажем, что $d\in\{ —11, —7, —3, —2, —1\}$. Можно считать, что $d\neq$\linebreak
$\neq—1,~—3$. Это случаи, когда группа единиц редуцируется к $\{—1,1\}$. Тогда\linebreak 
существует такой элемент  $z\in A$, что $|A/(z)|=2$ или $3$. Но $|A/(z)|=$\linebreak
$=|N(z)|$ (упражнение 12) и, следовательно,записав $N(z)=2$ или $3$. Читатель\linebreak
может сделать вывод самостоятельно, записав $N(z) = a^2 + |d|b^2$ при\linebreak
$d\equiv2$ или $3~(mod~4)$, или $4N(z) = a^2 + |d|b^2$ ($a$ и $b$ одной четности) при\linebreak
$d\equiv1~(mod~4)$.\newline
\\
\noindent\textbf{22. Вычисление НОД с помощью двоичных операций}\\
\\
\hspace*{15pt} Необходимое соотношение, конечно, НОД$(a, b) =2^{inf(\alpha , \beta)}$ НОД$(a', b')$.\linebreak
Итак,\: вычисление\: НОД\: двух\: целых\: чисел\: приводит\: после возможного
\newpage
%
%286
%========================================================================
%287
%
\noindent деления на степени двойки к вычислению НОД для их нечетных частей.
Используя к тому же свойство НОД (a, b) = НОД (a — b, b), получаем
следующий алгоритм.
\begin{leftbar}
\begin{lstlisting}[frame=none, mathescape=true]
int Binary_God(a,b$\in\mathbb{N}^{*}$){
	Reduce(a,$\alpha$,a'); Reduce(b,$\beta$,b');
	while(a'$\;$!=$\;$b'){$\;\;\;//\;a'\;\text{и}\;\Nod(a,b)=2^{\text{inf}(\alpha,\beta)}\;\Nod(a',b')$
		if(a'$\;$>$\;$b'){ a'-=b'; Reduce(a',$\gamma$,a'); }
		else{ b'-=a'; Reduce(b',$\gamma$,b'); }
	}
	if ($\alpha$ > $\beta$) return 2$^{\beta}$a';
$\;\;\;\;\;\;\:\textbf{else return}$ 2$^{\alpha}$a';
}				
\end{lstlisting}
\end{leftbar}
\noindent в котором процедура $Reduce(a, \alpha, a')$, начиная с первого аргумента, вы­дает для $a$ нечетное число $a'$, такое, что $a = 2^{\alpha} a'$. Этот алгоритм заканчивается за конечное число шагов, так как количество пар $(a', b')$,
строго положительных целых чисел убывает на каждой итерации (сле­дует заметить, что разность $|a' — b'|$ может не убывать. Например, для
$a = 459$ и $b = 309$).

Этот алгоритм, примененный к числам $1610$ и $1000$, более быстрый
(по числу итераций), чем алгоритм Евклида, использующий деление с
наименьшим остатком, что не противоречит теореме Лазара, сформу­лированной в разделе 6.2. Впрочем, этот алгоритм заметно более медленный, чем алгоритм Евклида для пары $(509,3)$.

Внимание: деление с четным остатком существует только тогда,
когда $a$ и $b$ одинаковой четности. В любом случае требуемая програм­ма будет использовать процедуру $Reduce$, и, следовательно, необходимо
наличие этого деления, когда $a$ и $b$ нечетные. Учитывая, что деление
на $2$ — очень быстрая операция, можно предполагать, что полученный
таким образом алгоритм, как правило, эффективнее, чем обычный ал­горитм Евклида. Но насколько?
\\\\
\noindent\textbf{23. Другое соотношение для последовательности Фибоначчи}
\\

Требуемое соотношение доказывается с помощью простой индук­ции. Если вспомнить, что два соседних числа Фибоначчи взаимно про­сты, то отсюда легко выводится, что $\Nod F_{n}$ и $F_{m}$ равен
$\Nod(F_{n}, F_{n + m})$ и тогда можно применять метод Евклида, опираясь на
значения индексов.

Соотношений для последовательности Фибоначчи очень много
(Кнут [99] приводит их в большом количестве). Можно заметить, что
последовательность, используемая в доказательстве, есть немедленное
\newpage
%
%287
%========================================================================
%288
%
\noindent следствие аналогичного соотношения для многочленов континуант в\linebreak
упражнении 5.
\\\\
\noindent\textbf{24. Вычисление НОД $n$-ки целых чисел}\\
\\
\hspace*{15pt}\textbf{b.} Вот алгоритм, отвечающий на вопрос:
\begin{lstlisting}[mathescape=true]
Number_Of_Zeroes = 0;
for (i = 0; i != n; n++){
	Repere = (Repere + 1) % n;
	if (u$_{Repere}$ != 0) break;
	Number_Of_Zeroes += 1;
	}
if (Number_Of_Zeroes >= n - 1) break;
Modulus = u$_{Repere}$;
for (i=0; i != n; i++){
	u$_{i}\;$=$\;$u$_{i}$ % Modulus;
}
u$_{Repere}\;$=$\;$Modulus;
\end{lstlisting}
\textbf{c.} Главное в этом алгоритме состоит в том, чтобы уравнять два ре­
пера, называемые левым и правым, ненулевыми элементами массива $u$.
Эти два репера стремятся друг к другу, и, как только они совпадают,
вычисления заканчиваются. Избежим в этом алгоритме повторяющих­
ся критериев обращения в нуль компонентов и и некоторых делений
(редукция с помощью $Modulus$). Вот несколько строчек алгоритма:
\begin{lstlisting}[mathescape=true]
while (left$\;$<$\;$правый$\;$&&$\;$u$_{левый}$=0){
	left+=1;
}
if (left$\;$>$\;$right) break;
	for (i=left; i<=right; i++){	$u_{\text{i}}\;$=$\;u_{\text{i}}\;\text{mod}\;u_{\text{left}}$; }
......		
\end{lstlisting}
\noindent Продолжение есть не что иное, как повторение этого фрагмента с переменой ролей \textit{левый} и \textit{правый} и с заменой прибавления единицы на вычитание единицы.
\\\\
\noindent\textbf{25. Странный алгоритм Евклида}
\\

Для всякого элемента $b\in\mathbb{N}$ существует система представителей из
$\mathbb{Z}/b\mathbb{Z}$, элементы которой $r$ удовлетворяют соотношению $\varphi(r)<\varphi(r)$.\linebreak
\pagebreak
\end{document}
