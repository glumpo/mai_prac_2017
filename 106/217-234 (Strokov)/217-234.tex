\subsection{Квазиевклидовы кольца}
\noindent Мы только что доказали, что оценка, даваемая теоремой Ламе, опти-\linebreak
мальна только в некоторых особых случаях. Но даже если бы выраже-\linebreak
ние, даваемое этой теоремой, было наилучшим, вопрос об оптимально-\linebreak
сти алгоритма Евклида нахождения НОД двух целых чисел все равно\linebreak
остался бы. Действительно, обычное евклидово деление не приводит\linebreak
к оптимальному алгоритму Евклида, как видно из раздела 3.4. Цель\linebreak
данного раздела — найти деления, которые оптимизируют сложность\linebreak
этого алгоритма. До настоящего момента мы рассматривали, главным\linebreak
образом, три класса колец, связанные следующими включениями:
$$ \left\lbrace
\begin{array}{c}
\text{Евклидовы кольца} \\
\text{без делителей нуля}
\end{array}
\right\rbrace \subsetneq
\left\lbrace
\begin{array}{l}
\text{Кольца главных} \\
\text{идеалов (КГИ)}
\end{array}
\right\rbrace \subsetneq
\left\lbrace
\begin{array}{l}
\text{Факториальные} \\
\text{кольца}
\end{array}
\right\rbrace .$$
\\
Главные их характеристики, которые нас интересуют, следующие:
\begin{itemize}


\item\textit{Наличие} алгоритма Евклида и возможность эффективного \textit{вычи}-\linebreak
\textit{­сления} НОД. Прототипами евклидовых колец являются $\mathbb{Z}$ и мно­жество многочленов над полем.
\item\textit{Наличие} НОД и разложения Безу без эффективного метода вычисления. Кольцо целых чисел из $\mathbb{Q}\sqrt{-19}$ является неевклидо­вым кольцом главных идеалов, в котором, между прочим, суще­ствует метод вычисления коэффициентов Безу [141] (кольцо це­лых $\mathbb{Q}\sqrt{-19}$, состоящее из элементов, которые являются корнями
унитарных многочленов с коэффициентами из $\mathbb{Z}$).
\item\textit{Наличие} и \textit{единственность} разложения на простые множители
(основная теорема арифметики). Кольцо $A[X]$ многочленов с коэффициентами из $A$ факториально, если таковым является $A$, но
не является КГИ, если $A$ не является телом.
\end{itemize}

Хотя понятие евклидова кольца более интересное с точки зрения
эффективности, понятие алгоритма Евклида значительно сильнее. На
практике оно ограничено методами, которые были представлены выше:
\begin{itemize}


\item В КГИ известно существование НОД, но нет, вообще говоря, простой эффективной процедуры его вычисления.

\item Как будет видно из следующей главы, посвященной модулям над
КГИ, что является основным содержанием главы, важным явля­ется не вычисление НОД с помощью деления, а вычисление коэф­фициентов Везу (что, конечно, приводит к нахождению НОД).

\item В кольце главных идеалов наличие НОД зависит не столько от то­го, что всякий идеал главный, сколько от того, что он конечного
типа (этого достаточно).
\newpage
\item Наконец, как показывают нижеследующие результаты, схо-\linebreak
ди­мость некоторого метода такого, как алгоритма Евклида, не обя-\linebreak зательно связано с существованием алгоритма Евклида в рассма-\linebreak триваемом кольце.
\end{itemize}
\begin{determ}
\hspace*{0.5cm}
Пусть $A$ — коммутативное унитарное кольцо. \textbf{Квазиалгоритм} на\linebreak
$A$ есть отображение $\varphi$ множества $A\times A$ во вполне упорядоченное мно-\linebreak жество, обладающее следующим свойством:
\begin{center}
$\forall(a,b)\in A\times A^*,\; \exists(q,r)\in A\times A\;\;\text{такая, что}\;\;a = bq + r\;\;\text{и}\;\;\varphi(b,r)<\varphi(a,b)$
\end{center}
Это равенство называется делением $a$ на $b$. Кольцо $A$\linebreak
называется \textbf{квазиевклидовым}, если оно допускает квазиалгоритм $\varphi$.\linebreak
Говорят также, что $A$ квазиевклидово относительно $\varphi$
\end{determ}
\begin{mynote}
Так как в случае евклидовых колец, термин \textit{алгоритм}\linebreak
обозначал отображение, а не эффективный метод вычисления,\linebreak
то квазиалгоритм также будет полностью формальным\linebreak
объектом. Эта терминология нежелательна в работе, которая\linebreak
рас­сматривает алгоритмы в «информатическом» смысле.
\end{mynote}
\hspace*{15cm}
\begin{predl}
\hspace*{0.5cm}
(i) Всякое евклидово кольцо является квазиевклидовым.

(ii) В квазиевклидовом кольце всякий идеал конечного типа главный\linebreak
(что приводит к наличию НОД двух элементов). Это означает, что\linebreak
всякое квазиевклидово кольцо является кольцом Везу.

(iii) В частности, всякое нётерово квазиевклидово кольцо без дели­-\linebreak
телей нуля является КГИ (в нётеровом всякий идеал конечного типа).
\end{predl}
\begin{myproof}[Доказательство (только для (ii))]
\\
Пусть идеал $A$ порожден двумя элементами. Допустим, что\linebreak
$(a, b)\in A \times A$ — пара образующих идеала $I, I = Aa + Ab$, где $b$\linebreak
отличен от нуля, для которой $\varphi$ имеет наименьшее значение. Мож-\linebreak
­но осуществить квазиевклидово деление $a$ на $b$ и записать $a=bq+r$,\linebreak
где $\varphi(b,r) < \varphi(a, b)$. Это приводит, в частности, к $Aa+Ab=Ab+Ar$\linebreak
и противоречит выбору пары $(a,b)$. Следовательно, такой пары с\linebreak
$b\neq0$ не существует, т.е. $b=0$. Это запускает механизм индукции,\linebreak
которая не вызывает особых трудностей. Наличие НОД теперь вы-\linebreak
водится из того, что $Ad = Aa + Ab \Rightarrow[\delta|d \Longleftrightarrow \delta|a$ и $\delta|b]$.
\end{myproof}
\newpage
\begin{mynotice}
Конечно, лучшее понимание квазиевклидова деления, основного для вычисления НОД, необходимо. Однако оно
не позволяет провести эти вычисления. Как показывает преды­дущее доказательство, НОД двух элементов кольца определяется
единственным образом (это нулевой элемент пары, порождающий
сумму идеалов, для которой значение квазиалгоритма минималь­но, что не является эффективным средством вычисления).\\
\end{mynotice}

Алгоритм Евклида остается допустимым для квазиевклидовых ко­лец и обладает той же сходимостью, что и в евклидовых кольцах.

\begin{predl}
\hspace*{0.5cm}
Коммутативное унитарное кольцо А является квазиевклидовым то­гда и только тогда, когда оно удовлетворяет следующему условию:

\begin{center}
$\forall(r_{0},r_{1})\in A\times A,\;\;\exists n\in\mathbb{N},\;\;\exists(q_{1},\ldots,q_{n})\in A^n,\;\;\exists(r_{2},\ldots,r_{n+1})\in A^n,$\linebreak
$\text{такие, что:}\;\forall i\in[1,n]\; : \; r_{i-1}=r_{i}q_{i}+r_{i+1}\;\;\;\text{и}\;\;\;r_{n+1} = 0$.
\end{center}
Кроме того, отображение $\varphi$ которое co всякой парой $(r_{0},r_{1})\in A\times A$ ассоциирует наименьшее целое $n$, для которого существует цепь псевдоделений, оканчивающаяся нулевым остатком, является самым малым
квазиалгоритмом, определенным на А.
\end{predl}
\begin{myproof}
Согласно второму пункту предшествующего замечания, условие необходимо. Поэтому надо показать его достаточность. Итак, пусть
$A$ — кольцо, удовлетворяющее условию предложения $50$. Ясно, что
отображение $\varphi$ есть квазиалгоритм для $A$. Действительно, пусть $a$,
$b$ и $r$ такие, что минимальная цепь псевдоделений для пары $(a,b)$
начинается с $a=bq+r$. Тогда, принимая во внимание минималь­ность $\varphi$, имеем $\varphi(b,r)+1\leqslant\varphi(a,b)$ и, следовательно, $\varphi(b,r) < \varphi(a,b)$.
Проверка того, что указанный квазиалгоритм минимален, является простой формальностью.
\end{myproof}

Итак, данное предложение позволяет построить квазиалгоритм для
квазиевклидова кольца. Это построение (если оно эффективно) опре­деляет самый быстрый метод вычисления НОД через алгоритм «по Евклиду» в квазиевклидовом кольце. Действительно, Лазар [112] доказал
следующие свойства:
\begin{thm}[Лазара]
\hspace*{0.5cm}
(i) Обычное евклидово деление в $K[X]$ является евклидовым делением, согласно минимальному квазиалгоритму в $K[X]$. Алгоритм Евклида, следовательно, является самым быстрым методом вычисления $\Nod$ двух многочленов с коэффициентами в поле через последовательные
деления.

(ii) В $\mathbb{Z}$ всякое евклидово деление с самым малым остатком является делением согласно минимальному кваэиалгоритму в $\mathbb{Z}$.

(iii) Точнее, в $\mathbb{Z}$ деление $a = bq+r$ есть деление по минимальному квазиалгоритму тогда и только тогда, когда $|r| < |b|/\phi$ ($\phi$ является золотым числом и $1/\phi\approx0,6180339\ldots)$.
\end{thm}

\begin{myproof}
Доказательство пункта \textit{(i)} очень простое и фигурирует в упражне­ниях 42 и 43, находящихся в конце главы. Пункты \textit{(i)} и \textit{(iii)} не очень
интересны для доказательства и не представляют больших трудно­стей. Например, можно проиллюстрировать пункт \textit{(iii)}. Пусть для
вычисления НОД даны числа $4215$ и $1177$. Вот различные этапы ал­горитма Евклида. Слева используется деление с наименьшим остат­ком, а справа деление, для которого отношение остатка к частному
может превысить $0,5$, все еще не превышая $1/\phi$:

\begin{tabular}{c|c}

$\begin{array}{rcl}
\;\\
4215 & = & 4 \times 1177 + (-493),\\
1177 & = & (-2 )\times(-493)+191,\\
-493 & = & (-3)\times 191+80,\\
191  & = & 2\times 80+31,\\
80   & = & 3\times 31+(-13),\\
31   & = & (-2)\times(-13)+5,\\
-13  & = &(-3)\times 5+2,\\
5    & = & 3\times 2+(-1),\\
2    & = & (-2)\times(—1)+0,\\
\;
\end{array}$ &
$\begin{array}{rcl}
\;\\
4215 &=& 4 \times 1177 + 684,\hspace*{0.5cm}(*)\\
1177 &=& 2\times 684 + (-191),\\
684 & = & (-3)\times (-191)+111,\hspace*{0.5cm}(*)\\
-191  & = & (-2)\times 111+31,\\
111 & = & 3\times 31+18,\hspace*{0.5cm}(*)\\
31   & = & 2\times 18+(-5),\\
18  & = &(-3)\times(-5)+3,\hspace*{0.5cm}(*)\\
-5    & = & (-2)\times 3+1,\\
2    & = & 3\times1+0,\\
\;
\end{array}$
\end{tabular}
В решении по этому последнему алгоритму 4 деления, отмеченные
звездочкой, дают остатки, абсолютное значение которых больше
половины делителя, оставаясь в границах теоремы Лазара, а число
итераций остается равным 9 (значение минимального квазиалгоритма для этих двух целых чисел).
\end{myproof}
\subsection{Вычисление НОД нескольких целых чисел: теорема Дирихле}
\noindent Когда необходимо вычислить НОД нескольких чисел, а не только двух,
можно применить несколько методов:
\newpage
\begin{itemize}
\item Распространение алгоритма Евклида, базирующегося на следую­щих свойствах:\\
\textit{(i) $\Nod(0,\ldots, 0, a, 0 ,\ldots, 0) = a$,\\
(ii) $\Nod(u_{1},\ldots,u_{i},\ldots,u_{n}) = \Nod(u_{1}\;\text{mod}\;u_{i},\ldots,u_{i},\ldots,\\
u_{n}\;\text{mod}\;u_{i})\;\text{при}\;u_{i}\neq0.$}

\noindent За подробностями этого метода читатель может обратиться к\linebreak
упр. 24.

\item Следующий метод заключается в повторном применении алгорит­ма\linebreak
Евклида для двух целых чисел. Он основывается на следую­щем\linebreak
свойстве: НОД($u_{1},\ldots,u_{n}$) = НОД($u_{1}$,НОД($u_{2},\ldots,u_{n}$)),\linebreak
ко­торое порождает рекурсивный алгоритм вычисления НОД. Имен-\linebreak
но, НОД($u_{1},\ldots,u_{n}$) = НОД(НОД($u_{1},\ldots,u_{n}),u_{3},\ldots,\u_{n}))$, что являет-\linebreak
ся основой соответствующего итеративного алгоритма.
\end{itemize}

Этот последний метод не только упрощает реализацию вычисле-\linebreak
­ния — действительно, достаточно несколько раз применить уже реа-\linebreak
лизованный алгоритм — но и имеет неоспоримое достоинство с точки\linebreak
зрения эффективности. Неформально говоря, главное заключается в\linebreak
следующем: выбирают два числа в последовательности, для которой\linebreak
надо вычислить НОД. Затем, сделав первое вычисление, заменяют два\linebreak
выбранные числа на их НОД и повторяют алгоритм. Выигрыш в эф-\linebreak
­фективности получается из того, что как только находят НОД, рав-\linebreak
ный единице, вычисление может быть прервано. Неиспользованные чи-\linebreak
сла ничего не могут добавить к полученным результатам. К тому же\linebreak
это явление довольно распространенное, потому что, как утверждает\linebreak
теория Дирихле, более, чем в 60\% случаев два целых числа, взятые слу-\linebreak
­чайно, взаимно просты. Продолжение этого раздела посвящается двум\linebreak
доказательствам теоремы Дирихле. Одно — эвристическое (короткое\linebreak
и неправильное), а другое — более длинное, но верное. Второе доказа­-\linebreak
тельство требует введения функции Мёбиуса, и мы воспользуемся слу-\linebreak
чаем доказать формулу обращения Мёбиуса — ту формулу, которая\linebreak
уже была использована в разделе 4.2.
\begin{thm}[Дирихле]
\hspace*{0.5cm}Если $u$ и $v$ — два натуральных числа, выбранные случайно, то вероятность того, что они взаимно просты, равна $6/\pi^2\approx 0,607927$. Более формально, если
$$H_{1}^{n}=\{(u,v)\in\mathbb{N}^{*2}/1\leqslant u\leqslant n,1\leqslant v\leqslant n\;\text{и}\;\Nod(u,v)=1\}$$
то $p=\lim\limits_{n\to\infty}\frac{\#H_{1}^{n}}{n^2}=\frac{6}{\pi^2}$, где $\#H_{1}^{n}$ означает мощность множества $H_{1}^{n}$
\end{thm}
\newpage
Обозначения, использующиеся в следующих ниже доказательствах,
таковы. Для натурального числа $d$ и вещественного положительного $x$
определим:

\hspace*{1cm}$H_{d}=\{(u,v)\in\mathbb{N}^{*2}/$ НОД$(u,v)=d\}$,

\hspace*{1cm}$H_{d}^x=\{(u,v)\in\mathbb{N}^{*2}/\;1\leqslant u\leqslant x,\;1\leqslant v, \leqslant x$ и НОД$(u,v)=d\}.$
\\

\noindent В этих обозначениях $x$ часто будет заменяться на натуральное число,
как в формулировке теоремы Дирихле. Множество $H_{1}$ необходимо для
оценки функции распределения в $\mathbb{N}^{*2}$.

\begin{myproof}[Эвристическое доказательство (теоремы Дирихле).]
Утверждение НОД$(u,v) = d$ равносильно тому, что $u$ и $v$ кратны
$d$ и что НОД$(u/d,v/d) = 1$ (т.е. $(u/d,v/d)\in H_{1}$). К тому же для
всякого натурального $n$ множества $H_{d}^{nd}$ и  $H_{1}^n$ имеют одну и ту же
мощность. Следовательно, для $x > 0$:
$$\frac{\#H_{d}^x}{x^2}=\frac{\#H_{1}^{x/d}}{x^2}=\frac{\#H_{1}^{x/d}}{(x/d)^2}=\frac{\#H_{1}^{x/d}}{(x/d)^2}\times\frac{1}{d^2}$$
Переходя к пределу, получим:
$$\lim\limits_{x\to\infty}\frac{\#H_{d}^x}{x^2}=\frac{1}{d^2}\times\left(\lim\limits_{x\to\infty}\frac{\#H_{1}^x}{x^2} \right) = \frac{p}{d^2},$$
где последнее число — «вероятность» того, что два числа имеют
наибольший общий делитель $d$. С другой стороны, можно запи­сать $\mathbb{N}^{*2}=\cup_{d=1}^{\infty}H_{d}$, где
 объединение является объединением непересекающихся множеств ($H_{d}$ — есть множество пар целых натуральных чисел с НОД равным $d$). Тогда можно заключить, что\\
$1 =\sum\nolimits_{d=1}^{\infty} p/d^2 = p\sum\nolimits_{d=1}^{\infty}1/d^2=p\pi^2/6$.
\end{myproof}

Настоятельно просим читателя найти ошибку в этом интуитивном
доказательстве.

А сейчас переходим к доказательству теоремы Дирихле. Для этого
доказательства нужна функция Мёбиуса вне связи с теорией арифме­тических функций, где она обычно появляется.

\begin{property}
\hspace*{0.5cm}Назовем функцией Мёбиуса функцию $\mu$, определенную на $\mathbb{N}^{*}$ следу­ющим образом:
$$\mu(k)=
\left\lbrace
\begin{array}{ll}
1,&\text{если}\;k=1,\\
(-1)^r,&\text{если}\;k=p_{1}p_{2}\ldots p_{r},\;\text{где}\;p_{i}=p_{j}\;\text{при}\;i\neq j\;\text{— простые числа,}\\
0&\text{в противном случае.}
\end{array}
\right.$$
\textit{Эта функция тесно связана с частичным упорядочиванием на множе­стве целых чисел с помощью отношения делимости. Для целого числа
$d>1$ функция $\mu$ удовлетворяет соотношению $\Sigma_{k|d}\:\mu(k)=0$.}
\end{property}
\begin{myproof}
Пусть $d=p_{1}^{\alpha_{1}}\ldots p_{r}^{\alpha_{r}}$
 — каноническое разложение $d$. Достаточно
рассмотреть только делители $d$, свободные от квадратов, так как
функция $\mu$ на других делителях исчезает, т.е. такие делители числа
$d$, которые разлагаются в произведение простых $p_{i}$ с показателями
0 или 1. Следовательно, чтобы найти такие делители, достаточно
выбрать $j$ различных чисел $р_{i}$ и получить
$$\sum\limits_{k|d}\mu(k)=\sum\limits_{j=0}^r(-1)^j\times
\begin{pmatrix}
r\\
j
\end{pmatrix}
=(1+(-1))^r,$$
согласно определению $\mu$.
\end{myproof}

Теперь мы получим формулу обращения Мёбиуса в не совсем при­вычной форме

\begin{predl}
Пусть $f$ и $g$ — две функции от $\mathbb{R}_{+}^{*}$ со значениями в некоторой ад­дитивной абелевой группе. Тогда
$$f(x)=\sum\limits_{k=1}^{|x|} g\left(\frac{x}{k}\right) \Longleftrightarrow g(x)=\sum\limits_{k=1}^{|x|}\mu(k)\times f\left(\frac{x}{k}\right).$$
\end{predl}
\begin{myproof}
Используемый метод заключается в перенесении выражения от $f$,
задаваемого первой формулой, во вторую:
$$\begin{array}{rcc}
\sum\limits_{k=1}^{|x|}\mu(k)\times f\left(\frac{x}{k}\right)&=&\sum\limits_{k=1}^{|x|}\left(\mu(k)\times\sum\limits_{k=1}^{\lfloor x/k \rfloor} g\left(\frac{x/k}{p}\right)\right)\\
&=&\sum\limits_{hzhz}\mu(k)\times f\left(\frac{x}{kp}\right)
\end{array}$$
Учитывая, что = $\lfloor\lfloor x \rfloor/k\rfloor = \lfloor x/k\rfloor$, можно сделать следующую замену
переменных: $h=kp$ c $1\leqslant h\leqslant x$ и $k|h$ , что дает
\newpage
$$\sum\limits_{k=1}^{\lfloor x \rfloor}\times f\left(\frac{x}{k}\right)=\sum_{h=1}^{\lfloor x\rfloor}\left( g\left(\frac{x}{h}\right)\times\sum\limits_{k|h}\mu(k)\right)$$
Согласно свойству 53, в этой сумме есть только одно ненулевое слагаемое, именно то, которое отвечает значению $h=1$ и, следовательно $\sum\nolimits_{k=1}^{\lfloor x\rfloor}\mu(k)\times f(x/k)=g(x)$.
\end{myproof}
Доказательство теоремы Дирихле будем осуществлять в три этапа.
\begin{lemma}
\hspace*{0.5cm}Пусть $x$ — вещественное положительное число. Обозначим через $q_{x}$
число элементов множества $H_{1}^x$. Тогда $q_{x}=\sum\nolimits_{k\geqslant 1}\mu(k)\times\lfloor x/k\rfloor^2$, фор­
мула, в которой, на первый взгляд, бесконечное число слагаемых, но
только конечное их число отлично от нуля.
\end{lemma}
\begin{myproof}
Пусть $q_{d,x}$ — множество элементов множества $H_{d}^x$. Множество пар
натуральных чисел, не превосходящих $x$, есть, как это было видно
в эвристическом доказательстве, теоретико-множественная сумма
непересекающих подмножеств $H_{d}^x$, где $d$ изменяется от 1 до $\lfloor x\rfloor$: $\lfloor x\rfloor^2=\sum\nolimits_{d=q}^{\lfloor x\rfloor}q_{d,x}=\sum\nolimits_{d=1}^{\lfloor x\rfloor}q_{\lfloor x/d\rfloor}$, так как $\#H_{d}^x=\#H_{1}^{\lfloor x/d\rfloor}$. Применим к этому выражению формулу обращения, фигурирующую в
предложении 54, отождествляя функцию $f$ с функцией $x\mapsto\lfloor x\rfloor^2$
 и функцию $g$ с функцией $x\mapsto q_{x}$, и получим искомый результат.
\end{myproof}

Следующий этап доказательство требует (это было неизбежно) вычисления пределов и суммы ряда.
\begin{lemma}
\hspace*{0.5cm}В предшествующих обозначениях для натурального числа $n$ имеем
$$\lim\limits_{n\to\infty}\frac{q_{n}}{n^2}=\sum\limits_{k=1}^{\infty}\mu(k)/k^2.$$
\end{lemma}
\begin{myproof}
Ряд, фигурирующий в правой части формулы, является, очевидно,
абсолютно сходящимся, так как функция Мёбиуса мажорируется по
абсолютной величине единицей. Итак, достаточно оценить разность
между общими членами этих двух последовательностей и показать,
что она стремится к нулю. Имеем:
\newpage
$$\sum\limits_{k=1}^{n}\frac{\mu(k)}{k_{2}}-\frac{q_{n}}{n^2}=\sum\limits_{k=1}^n\mu(k)\times \left(\frac{1}{k^2}-\left\lfloor\frac{n}{k}\right\rfloor^2\times\frac{1}{n^2}\right).$$
Кроме того, для всякого вещественного положительного числа $x$\linebreak
имеем $0\leqslant x-\lfloor x\rfloor <1$ и, следовательно, $0\leqslant 1/k-\lfloor n/k\rfloor/n\leqslant 1/n$. В\linebreak
этих условиях
$$0\leqslant\frac{1}{k^2}-\frac{1}{n^2}\times\left\lfloor\frac{n}{k}\right\rfloor^2=\left(\frac{1}{k}-\frac{1}{n}\times\left\lfloor\frac{n}{k}\right\rfloor\right)\times\left(\frac{1}{k}+\frac{1}{n}\times\left\lfloor\frac{n}{k}\right\rfloor\right)\leqslant\frac{1}{n}\times\frac{2}{k}.$$
Перенося эти значения в разность для мажорирования, получаем:
$$\left|\frac{q_{n}}{n^2}-\sum\limits_{k=1}^{n}\frac{\mu(k)}{k^2}\right|\leqslant\frac{2}{n}\times\sum\limits_{k=1}^{n}\frac{1}{k}\leqslant\frac{2\log n}{n}$$
величина, стремящаяся к нулю, когда $n$ стремится к бесконечно­сти. Итак, последовательность $(q_{n}/n^2)_{n\in\mathbb{N•}}$. сходится и имеет тот же предел, что и ряд.
\end{myproof}

Для того, чтобы закончить доказательство теоремы Дирихле, оста­ется вычислить сумму ряда с общим членом $\mu(k)/k^2$. Для этого докажем, что $(\sum\nolimits_{k=1}^{\infty}\mu(k)/k^2)\times(\sum\nolimits_{k=1}^{\infty}1/k^2)=1$.

Оба рассматриваемых ряда — абсолютно сходящиеся, и потому можно изменить порядок суммирования следующим образом:
$$\left(\sum\limits_{k=1}^{\infty}\frac{\mu(k)}{k^2}\right)\times\left(\sum\limits_{m=1}^{\infty}\frac{1}{m^2}\right)=\sum\limits_{k=1}^{\infty}\sum\limits_{m=1}^{\infty}\frac{\mu(k)}{m^2 k^2}=\sum\limits_{d=1}^{\infty}\left(\sum\limits_{k|d}\mu(k)\right)\times\frac{1}{d^2}.$$
По уже доказанному свойству 53 самая внутренняя сумма нулевая, за
исключением случая, когда $d=1$. Сумма ряда с общим членом $1/k^2$
равна $\pi^2/6$. Теорема Дирихле доказана.
\\

Конец этого раздела посвящен классической формуле обращения
Мёбиуса.

Рассмотрим множество $\mathbb{N}^*$, упорядоченное с помощью отношения
делимости. В этой структуре $1$ — наименьший элемент и всякий ин­тервал $[a,b]$ конечен. ($\mathbb{N}^*, |)$ — упорядоченное множество, являющееся
локально конечным.

Поэтому на множестве функций $\digamma$, определенных на $\mathbb{N}^*$ со значени­ями в $A$, можно ввести внутренний закон композиции.
\newpage
\begin{determ}
\hspace*{0.5cm}На $\digamma$ определен закон внутренней композиции *, называемый арифметическим произведением, по следующему правилу:
$$\forall f\in\digamma,\forall g\in\digamma,\forall n\in\mathbb{N}^{*},\;\;\;(f*g)(n)=\sum\limits_{d|n}f(d)g\left(\frac{n}{d}\right).$$
\end{determ}
\begin{property}[произведения *]
\hspace*{0.5cm}(i) Произведение ассоциативно и коммутативно.

(ii) Функция Кронекера $\delta$, определяемая как $\delta(1)=1$ и $\delta(n)=0$, если
$n>1$, есть нейтральный элемент для произведения $*$.

(iii) Элемент $f\in\digamma$ обратим для операции $*$ тогда и только тогда,
когда $f(1)$ обратим.\\
(iv) Множество $\digamma$, наделенное обычным сложением функций и операцией $*$, является коммутативным унитарным кольцом.
\end{property}
\begin{myproof}[Доказательство (только для пункта (iii)).]
Пусть $f\in\digamma$ такой, что $f(1)\in U(A)$. Определим $g$ по индукции следующим образом:
$$g(1)=f(1)^{-1}\;\;\;\text{и}\;\;\;g(n)=-f(1)^{-1}\sum_{\substack{d|n{}\\d\neq n}
}g(d)f\left(\frac{n}{d}\right)\;\;\;\text{при}\;n>1$$
Простая проверка показывает, что $g$ — обратный элемент для $f$.
Остальные утверждения теоремы немедленно выводятся из опреде­ления арифметического произведения.
\end{myproof}
\begin{property}
\hspace{0.5cm}Пусть $\xi$ — элемент из $\digamma$, определяемый по правилу $\xi(n)=l,\forall n\in\mathbb{N}^*$. Тогда в $(\digamma,*)$ функции $\xi$ и$\mu$ обратны друг другу.
\end{property}

Проблема, решаемая с помощью формулы обращения Мёбиуса, следующая. Пусть $g$ — функция из $\mathbb{N}^*$ в $A$ и пусть $f$ — функция, определенная по правилу $\sum\nolimits_{d|n}g(d)$ для $n\in\mathbb{N}^*$. Можно ли в этом случае выразить функцию $g$ через $f$? Другими словами, можно ли найти обращения этой формулы? Ответ дает следующая
\begin{thm}[Формула обращения Мёбиуса]
\hspace{0.5cm}Пусть $f$ и $g$ — две функции в $\digamma$ , такие, что для любого $n\in\mathbb{N}^*$ справедливо соотношение $f(n)\;=\;\sum\nolimits_{d|n}g(d)$. Тогда можно выразить $g$
через функцию $f: g(n)=\sum\nolimits_{d|n}\mu(d)f(n/d)$, где $\mu$ — функция Мёбиуса.
\end{thm}
\newpage
\begin{myproof}[Доказательство (формулы обращения Мёбиуса).]
Выражение $f$ через функцию $g$ описывается в терминах умножения
$*: f = \xi*g$, а так как $\xi$ и $\mu$ взаимно простые элементы относительно
 операции * (свойство 59), то получаем $g= \mu*f$.
\end{myproof}

Более общие сведения по теории арифметических функций можно
получить, обратившись к монографии Бержа [19].
\section{Расширенный алгоритм Евклида}
\noindent Этот раздел посвящен изучению эффективного метода получения ко-\linebreak
­эффициентов Безу в евклидовом и квазиевклидовом кольце. Надо от­-\linebreak
метить, что квазиевклидовый случай — не единственная возможность\linebreak
для построения таких алгоритмов (известным примером является не-\linebreak
­евклидово кольцо главных идеалов кольца целых алгебраических чисел\linebreak
в $\mathbb{Q}(\sqrt{-19})$). В следующей главе мы увидим, что наличие коэффициен-\linebreak
­тов Безу является главным ключом к классификации модулей над коль-\linebreak
цом главных идеалов (теория инвариантных множителей): кто умеет их\linebreak
вычислять, тот умеет решать эффективным образом задачи линейной\linebreak
алгебры над кольцом главных идеалов.
\subsection{Вычисление коэффициентов Безу
в квазиевклидовом кольце}
\noindent Для квазиевклидова кольца $A$ разновидность алгоритма Евклида, пред-\linebreak­ложенная в разделе 3.2, позволяет вычислить коэффициенты Безу. Ис-\linebreak
­пользуемые обозначения те же, что в разделе 3.2. Алгоритм, при-\linebreak
ме­ненный к паре чисел $a,b$, порождает последовательность $(r_{i}){0\leqslant i\leqslant n+1}$\linebreak
такую, что\\
$$r_{i-1}=r_{i}q_{i}+r_{i+1}\;\;\text{для}\;1\leqslant i\leqslant n,\;\;\text{где}\;r_{0}=a,r_{1}=b,r_{n+1}=0.$$\\
Элемент $r_{i+1}$ является линейной комбинацией $r_{i}$ и $r_{i-1} (r_{i+1}\in Ar_{i}+$\linebreak
$+Ar_{i-1})$. Так как $r_{0}=1\cdot a+0\cdot b$, $r_{1}=0\cdot a+1\cdot b$, то по предыдущему\linebreak
рекуррентному соотношению для г< получаем, что $r_{n} = \text{НОД}(a,b)$ —\linebreak
линейная комбинация $a$ и $b$. Точнее, предполагая, что $r_{i}=u_{i}a+v_{i}b$,\linebreak
получаем:\\
$$r_{i+1}=r_{i-1}-q_{i}r_{i}=(u_{i-1}-q_{i}u_{i})a+(v_{i-1}-q_{i}v_{i})b.$$
\newpage
\noindent Из этих формул легко получается рекуррентная последовательность:

$$\left\lbrace\begin{array}{l}
u_{0}=1,\;\;\;v_{0}=0,\;\;\;r_{0}=a,\\
u_{1}=0,\;\;\;v_{1}=1,\;\;\;r_{1}=b,\\
u_{i+1}=u_{i-1}-q_{i}u_{i},\;v_{i+1}=v_{i-1}-q_{i}v_{i},\;r_{i+1}=r_{i-1}-q_{i}r_{i}
\end{array}\right.$$

\noindent из которой теперь и следует классический результат: $r_{n} = \Nod(a, b) =$\linebreak
$=u_{n}a+v_{n}b$. Эти соотношения приводят, к тому же, к рекуррентному
алгоритму, изображенному ниже, в котором тройка $(u,v,r)$ соответ­ствует $(u_{i}, v_{i}, r_{i})$ и тройка $(u', v', r')$ соответствует $(u_{i+1},v_{i+1},r_{i+1})$. Переменная $i$, бесполезная для алгоритма, присутствует в комментариях
только для того, чтобы придать смысл утверждениям.
\begin{leftbar}
\begin{lstlisting}[frame=none,mathescape=true]
int Bezout ((a,b)$\in$ A){
	$\begin{pmatrix}
u\\
u'
\end{pmatrix}\longleftarrow
\begin{pmatrix}
1\\
0
\end{pmatrix};\;\;\;
\begin{pmatrix}
v\\
v'
\end{pmatrix}\longleftarrow
\begin{pmatrix}
0\\
1
\end{pmatrix};\;\;\;
\begin{pmatrix}
r\\
r'
\end{pmatrix}\longleftarrow
\begin{pmatrix}
a\\
b
\end{pmatrix};$
	i = 0;
	while(r'$\;$!=$\;$0){$\;\;\;\;\;//\;\;(u,v,r)=(u_{i},v_{i},r_{i}),\;(u',v',r')=(u_{i+1},v_{i+1},r_{i+1})$
		i++;$\;\;\;\;\;//\;\;(u,v,r)=(u_{i-1},v_{i-1},r_{i-1}),\;\;\;(u',v
,r')=(u_{i},v_{i},r_{i})$
		q = r/r';$\;\;\;\;\;//\;\;q=q_{i}$
		$\begin{pmatrix}
u & v & r\\
u'& v'& r'
\end{pmatrix}\longleftarrow
\begin{pmatrix}
u' & v' & r'\\
q-qu' & v-qv' & r-qr'
\end{pmatrix};$
	}
return (u,v);$\;\;//\;\;$Коэффициенты Безу$\;$для$\;$пары$\;$(a,b)
}
\end{lstlisting}
\end{leftbar}
Вот другое доказательство, основанное на эквивалентном предста­влении того же алгоритма. Для этого все рекуррентные соотноше­ния (6) запишем в матричной форме:
$$\begin{array}{rcl}
\begin{pmatrix}
u_{i} & v_{i} & r_{i}\\
u_{i+1} & v_{i+1} & r_{i+1}
\end{pmatrix}&=&
\begin{pmatrix}
0 & 1\\
1 & -q_{i}
\end{pmatrix}
\begin{pmatrix}
u_{i-1} & v_{i-1} & r_{i-1}\\
u_{i} & v_{i} & r_{i}
\end{pmatrix}\\
\;\\
\text{и}\;\;\;
\begin{pmatrix}
u_{0} & v_{0} & r_{0}\\
u_{1} & v_{1} & r_{1}
\end{pmatrix}&=&
\begin{pmatrix}
1 & 0 & a\\
0 & 1 & b
\end{pmatrix}.
\end{array}$$
Эти равенства дают:
$$\begin{vmatrix}
u_{i} & v_{i}\\
u_{i+1} & v_{i+1}
\end{vmatrix} =-
\begin{vmatrix}
u_{i-1} & v_{i-1}\\
u_{i} & v_{i}
\end{vmatrix}\;\;\;\Rightarrow\;\;\;
\begin{vmatrix}
u_{i} & v_{i}\\
u_{i+1} & v_{i+1}
\end{vmatrix}=(-1)^i$$
Затем:
$$\begin{pmatrix}
u_{i} & v_{i}\\
u_{i+1} & v_{i+1}
\end{pmatrix}
\begin{pmatrix}
a\\
b
\end{pmatrix}=
\begin{pmatrix}
r_{i}\\
r_{i+1}
\end{pmatrix},\;\text{и его «обращение»}$$
\newpage
$$\begin{pmatrix}
a\\
b
\end{pmatrix}
=(-1)^i
\begin{pmatrix}
v_{i+1} & -v_{i}\\
-u_{i+1} & u_{i}
\end{pmatrix}
\begin{pmatrix}
r_{i}\\
r_{i+1}
\end{pmatrix}.$$
\begin{framed}

\begin{lstlisting}[frame=none, mathescape=true, caption=Алгоритм Безу для квазиевклидова кольца]
int Bezout(a,b$\;\in\;$A){
$\begin{pmatrix}
u\\
u'
\end{pmatrix}\longleftarrow
\begin{pmatrix}
1\\
0
\end{pmatrix};\;\;\;
\begin{pmatrix}
v\\
v'
\end{pmatrix}\longleftarrow
\begin{pmatrix}
0\\
1
\end{pmatrix};\;\;\;
\begin{pmatrix}
r\\
r'
\end{pmatrix}\longleftarrow
\begin{pmatrix}
a\\
b
\end{pmatrix};$
while (r'$\;$!=$\;$0){
	$\begin{pmatrix}
u & v\\
u' & v'
\end{pmatrix}
\begin{pmatrix}
a\\
b
\end{pmatrix}=
\begin{pmatrix}
r\\
r'
\end{pmatrix},\;\;\;
\begin{vmatrix}
u & v\\
u' & u
\end{vmatrix}=\pm 1$
	q=r/r';
	$\begin{pmatrix}
u & v & r\\
u' & v' & r'
\end{pmatrix}\longleftarrow
\begin{pmatrix}
0 & 1\\
1 & -q
\end{pmatrix}\begin{pmatrix}
u & v & r\\
u' & v' & r'
\end{pmatrix}$
	}
return (u,v);	$ua+vb\;—\;$есть$\;\Nod\;a\;$и$\;b$
}
\end{lstlisting}
\end{framed}

Следовательно, для $i=n$ имеем: $a=(-1)^nv_{n+1}r_{n},\;b=(-1)^{n+1}u_{n+1}r_{n}$ и $r_{n}=u_{n}a+v_{n}b$. Последние соотношения \textit{явно} показывают, что $r_{n}$ является, с одной стороны, общим делителем, а с другой — линейной
комбинацией $a$ и $b$. Это порождает новое \textit{эффективное} доказательство,
поскольку $r_{n}$ является НОД $a$ и $b$.

Этот подход позволяет построить самодостаточный алгоритм (3),
в котором больше не фигурирует переменная $i$.
\begin{table}[h!]
\centering
\begin{tabular}{|c|rrrrrrr|}
\hline
$i$ & $q_{i}$ & $u_{i}$ & $v_{i}$ & $r_{i}$ & $u_{i+1}$ & $v_{i+1}$ & $r_{i+1}$ \\ \hline
$0$ &            & $1$        & $0$        & $1292$     & $0$          & $1$          & $798$        \\
$1$ & $0$        & $0$        & $1$        & $798$      & $1$          & $-1$         & $494$        \\
$2$ & $1$        & $1$        & $-1$       & $494$      & $-1$         & $2$          & $304$        \\
$2$ & $1$        & $-1$       & $2$        & $304$      & $2$          & $-3$         & $190$        \\
$3$ & $1$        & $2$        & $-3$       & $190$      & $-3$         & $5$          & $114$        \\
$4$ & $1$        & $-3$       & $5$        & $114$      & $5$          & $-8$         & $76$         \\
$5$ & $1$        & $5$        & $-8$       & $76$       & $-8$         & $13$         & $38$         \\
$6$ & $2$        & \underline{$-8$}       & \underline{$13$}       & \underline{$38$}       & $21$         & $-34$        & $0$          \\ \hline
\end{tabular}
\caption{Вычисление коэффициентов Безу}
\end{table}

В таблице 3 приведен пример вычисления коэффициентов Безу в $\mathbb{Z}$. Этот пример может быть полезен для понимания следующего парагра­фа.
\newpage
\noindent В рассматриваемом примере $a = 1292$, $b = 798$, их $\Nod = 38$ и найденные коэффициенты Безу $u = — 8$ и $v = 13$ (подчеркнутые числа).

Коэффициенты Безу часто применяются для вычисления обратного элемента в $\mathbb{Z} /n\mathbb{Z}$. Пусть, например, требуется обратить класс $34$ в $\mathbb{Z}/235\mathbb{Z}$ ($34$ \linebreak
взаимно просто с $235$, следовательно, обратимо по модулю $235$): алгоритм Безу дает соотношение $1 = 11\times235 — 76\times34$, и
обратным к $34$ по модулю $235$, следовательно, является $—76 = 159$. Опе­рация обращения часто необходима в модулярной арифметике. Иногда эта конструкция требуется и в других кольцах, например, в кольце целых чисел Гаусса. Так, алгоритм Безу, примененный в $\mathbb{Z}[i]$ к числам $23 + 14i$ и $7 + 5i$, дает $1=(—3 + 2i)\times(23+14i)+$\linebreak$+(9—7i)\times(7+5i)$ и, сле­довательно, обратным к элементу $7 + 5i$ по модулю $23+14i$ будет $9—7i$.
\subsection{Мажорирование коэффициентов Безу в $\mathbb{Z}$}
\noindent Равенства $ua+vb=(u-kb)a+(v+ka)b$ и для $d$, делящего $a$ и $b$, $ua+vb=$\linebreak$(u-kb/d)a+(v+ka/d)b$ показывают, что существует много пар $(u,v)$, для которых НОД$(a,b)=ua+vb$. Расширенный алгоритм Евклида, полученный в предыдущем разделе, позволяет вычислить такую пару $(u,v)$, что, \textit{за исключением лишь некоторых особых случаев,}выполняются неравенства $|u|\leqslant|b/2d|$ и $|v|\leqslant|a/2d|$.

Эти оценки являются объектом исследования для следующего предложения. Единственность такой пары $(u,v)$, удовлетворяющей указанным неравенствам (упр. 33), доказывает, что пара Безу, получаемая
алгоритмом Евклида, является самой «красивой».
\begin{predl}
\hspace*{0.5cm}(i) Пусть $a$ и $b$ — различные строго положительные целые числа, и пусть $d$ их НОД. Пусть $(u_{i})_{0\leqslant i\leqslant n+1}$ — последовательно­сти, полученные расширенным алгоритмом Евклида. В этих условиях последовательности $|u_{i}|_{1\leqslant i\leqslant n+1}$ и $|v_{i}|_{0\leqslant i\leqslant n+1}$ являются возрастающими, не переполняют разрядную сетку машины — в предположении, что $a$ и $b$ представимы машинными кодами — и указанный алгоритм дает коэффициенты Безу $u$, $v$, удовлетворяющие оценкам:\\
$$|u|\leqslant|b/2d|,\;\;\;|v|\leqslant|a/2d|.\eqno(7)$$
\\

(ii) Если $(a, b)$ — пара целых чисел, отличная от $(0,a)$, $(a, 0)$ и\linebreak
$(a,\pm а)$, то существуют коэффициенты Безу, удовлетворяющие неравен-\linebreak
­ствам (7)
\end{predl}
\newpage
\begin{myproof}
Напомним классические обозначения:
$$r_{i-1}=r_{i}q_{i}+r_{i+1},\;\;u_{i+1}=u_{i-1}-u_{i}-u_{i}q_{i},\;\;v_{i+1}=v_{i-1}-v_{i}q_{i},\\\text{и}\;\;u_{0}=v_{1}=1,\;\;u_{1}=v_{0}=0.$$
Легко убедиться, что $u_{2i}\geqslant0$ и $u_{2i+1}\leqslant0$; значит, $|u_{i+1}\geqslant|u_{i}q_{i}|$,\linebreak
откуда видно (ввиду $q_{i}>0$), что последовательность $(|u_{i}|)$ возра-\linebreak
стающая для $i\geqslant1$. В конце алгоритма имеем $|u_{n+1}|\geqslant|q_{n}u_{n}|$, где\linebreak
$q_{n}\geqslant2$, что неверно только для случаев, выписанных в явном виде\linebreak
в (\textit{ii}). Однако $|u_{n+1}|=a/d$, что заканчивает доказательство (для $v_{i}$\linebreak
доказательство аналогично.
\end{myproof}
\section{Факториальность кольца многочленов}
Прежде чем закончить эту главу, «пробежимся» по кольцам многочленов, что позволит построить приемлемые алгоритмы вычисления НОД с эффективными оценками трудоемкости. Но сначала немного теории.
\begin{thm}
\hspace*{0.5cm}(i) Если $A$ — унитарное нётерово коммутативное кольцо, то кольцо
многочленов $A[X]$ нётерово. То же верно и для кольца $A[X_{1},\ldots,X_{n}]$.

(ii) Если $K$ — поле, то $K[X_{1},\ldots,X_{n}]$ нётерово.

(iii) Кольцо многочленов $\mathbb{Z}[X_{1},\ldots,X_{n}]$ с целыми коэффициентами нётерово.
\end{thm}
Для доказательства теоремы нам понадобятся некоторые простые результаты. Пусть $n$ — натуральное число, $I$ — идеал в $A[X]$. Обозна­чим через $dom_{n}(I)$ часть $A$, состоящую из коэффициентов при старших (доминирующих) членах многочленов из $I$, имеющих степень в точности равную $n$, и к которой добавлена константа $0$.
\begin{lemma}
\hspace*{0.5cm} (i) $dom_{n}(I)$ — идеал в $A$.

(ii) Если $n\leqslant m$, то $dom_{n}(I)\subset dom_{m}(I)$(рассмотреть $X^{m-n}P$ для $Р$ в $I$, имеющего степень $n$).

(iii) Если $I\subset J$, то $dom_{n}(I)\subset som_{n}(J)$.
\end{lemma}
\begin{lemma}
\hspace*{0.5cm} Пусть $I\subset J$ — два идеала в $A[X]$, такие, что для всякого $n$:\linebreak
$dom_{n}(I) = dom_{n}(J)$. Тогда $I=J$.
\end{lemma}
\newpage
\begin{myproof}
Пусть $P$ — элемент $J$. Если $P$ степени $0$, то очевидно (так как $dom_{0}(I)=dom_{0}(J)$), что $P\in I$. В остальных случаях будем исполь­зовать индукцию по степени $n$ полинома $P$. Пусть $P=aX^n+\ldots$ и $a\in dom_{n}(J)=dom_{n}(I)$. Поэтому существует $Q\in I$, такой, что $Q=aX^n+\ldots$. Многочлен $P — Q$ имеет степень, меньшую, чем $n$, и принадлежит $J$. По предположению индукции получаем $Р — Q\in I$, а тогда $P\in I$.
\end{myproof}
\begin{myproof}[Доказательство теоремы 62]
Рассмотрим возрастающую последовательность $(I_{i})$ идеалов в $A[X]$. Семейство идеалов $(dom_{n}(I_{i}))_{i,n}$ имеет максимальный элемент (но не максимум на данный момент) $dom_{n_{0}}(I_{i_{0}})$. Следовательно, для всякого $n\geqslant n_{0}$ и для всякого $i\geqslant i_{0}\:dom_{n}(I_{i})=dom_{n_{0}}(I_{i_{0}})$. Рассмотрим таблицу:
$$\begin{array}{cccccccc}
dom_{1}(I_{1}) & \subset & dom_{2}(I_{1}) & \subset\cdots\subset & dom_{n_{0}}(I_{1}) & \subset & dom_{n_{0}+1}(I_{1})&\subset\;\cdots\\
\cap&&\cap&&\cap&&\cap&\\
dom_{1}(I_{2}) & \subset & dom_{2}(I_{2}) & \subset\cdots\subset & dom_{n_{0}}(I_{2}) & \subset & dom_{n_{0}+1}(I_{2})&\subset\;\cdots\\
\cap&&\cap&&\cap&&\cap&\\
\vdots&&\vdots&&\vdots&&\vdots&\\
dom_{1}(I_{i_{0}}) & \subset & dom_{2}(I_{i_{0}}) & \subset\cdots\subset & dom_{n_{0}}(I_{i_{0}}) & \subset & dom_{n_{0}+1}(I_{i_{0}})&\subset\;\cdots\\
\cap&&\cap&&\cap&&\cap&\\
dom_{1}(I_{i_{0}+1}) & \subset & dom_{2}(I_{i_{0}+1}) & \subset\cdots\subset & dom_{n_{0}}(I_{i_{0}+1}) & \subset & dom_{n_{0}+1}(I_{i_{0}+1})&\subset\;\cdots\\
\cap&&\cap&&\cap&&\cap&\\
\vdots&&\vdots&&\vdots&&\vdots&
\end{array}$$
Существование $i_{0}$ и $n_{0}$ означает, что столбцы таблицы, ранг которых превышает $n_{0}$, стабилизируются, начиная с линии $i_{0}$. Более того, стабилизируется всякий столбец с номером $n<n_{0}$. Поэтому, строки предыдущей таблицы, начиная с некоторого индекса $q$, совпадают: для всякого $i\geqslant q$ имеем $dom_{n}(I_{i})=dom_{n}(I_{q})$, и по лемме 64 это доказыва­ет, что $I_{i}=I_{q}$. Последовательность идеалов в $A[X]$ стабилизируется. Следовательно, $A[X]$ нётерово.
\end{myproof}

Перейдем теперь к свойствам разложения.
\begin{lemma}[Гаусса]
\hspace*{0.5cm} Пусть простой элемент $p$ кольца $A$ делит произведение многочленов
$P$ и $Q$ над $A$. Тогда $p$ делит $P$ или $Q$.
\end{lemma}
\newpage
\begin{myproof}
Пусть $p$ не делит ни $P$, ни $Q$. Обозначим через $a_{i}$ и $b_{j}$ такие коэф­фициенты $P$ и $Q$, соответственно, что $i$ и $j$ — наименьшие номера, для которых $р\nmid a_{i}$ и $р\nmid b_{j}$. Тогда $р\nmid\sum\nolimits_{k+l=i+j}a_{k}b_{l}$, так как $p$ делит все слагаемые этой суммы, кроме первого. Противоречие. В действительности лемма Гаусса не утверждает ничего, кроме того, что «если $А/(р)$ без делителей нуля, то это же утверждение верно и для $A[X]/(p)$».
\end{myproof}
\begin{determ}
\hspace*{0.5cm}Пусть $A$ — факториальное кольцо. Назовем \textbf{содержанием} многочлена $P$ с коэффициентами из $A$ $\Nod$ его коэффициентов и обозначим его через $c(P)$. Многочлен $P$ называется \textbf{примитивным}, если его коэффициенты взаимно просты, т.е. если его содержание равно 1. \textbf{Примитивная часть} $P$ равна $P/c(P)$, это примитивный множитель.
\end{determ}
\begin{sled}
\hspace*{0.5cm}(i) Произведение примитивных многочленов является примитив­
ным.

(ii) Содержание произведения двух многочленов ассоциировано с
произведением содержаний этих многочленов: $c(PQ)~c(P)c(Q)$.
\end{sled}
\begin{myproof}
Пункт $(i)$ является непосредственным следствием леммы Гаусса.
Что касается пункта $(ii)$, то можно заметить, что $P = c(P)Р'$
и $Q = c(Q)Q'$, где $Р'$ и $Q'$ — примитивные многочлены. Отсю­да получаем, что $c(PQ) = c(P)c(Q)c(P'Q')$, которое эквивалентно $c(P)c(Q)$, согласно пункту $(i)$.
\end{myproof}
\begin{sled}
\hspace*{0.5cm} Пусть Р — \textbf{примитивный} многочлен с коэффициентами в факториальном кольце $A, Q$ — другой многочлен. Если $P$ делит $Q$ над полем частных кольца $A$, то он делит $Q$ и в $A[X]$. В частности, если для $a\in A^*\;\;P$ делит $aQ$, то $P$ делит $Q$
\end{sled}
\begin{thm}[Гаусса]
\hspace{0.5cm}Пусть $A$ — факториальное кольцо, $K$ — его поле частных, $S_{a}$ — система представителей неприводимых элементов из $A$ (т.е. такая си­стема, по которой можно единственным образом разложить любой эле­мент из $A$). Пусть $S'$ — система представителей неприводимых многочленов в $K[X]$ с коэффициентами из $A$, являющихся примитивными. Тогда $S'\cup S_{A}$ — система представителей неприводимых элементов в
$A[X]$. В частности, $A[X]$ факториально.
\end{thm}
\newpage
\begin{myproof}
Пусть $P\in A[X]$ — многочлен положительной степени (в противном случае $P$ раскладывается по системе $S_{A}$). В $K[X]$, являющемся кольцом главных идеалов, а следовательно, факториальным, многочлен $P$ можно разложить в произведение неприводимых:
$$P=a\prod\limits_{Q\in S'}Q^{\alpha_{Q}},\;\;\text{где}\;\;a\in K^*\;\text{и}\;\alpha_{Q}\in\mathbb{N},$$
$a$ можно записать в виде $a=p/q$, где $p,q\in A$. Следовательно, $qP=p\prod Q^{\alpha_{Q}}$, что является равенством в $A[X]$. Согласно следствию 68 $\prod Q^{\alpha_{Q}}$являющийся примитивным многочленом, делит $qP$, а потому делит $P$ и $a\in A$ (в силу единственности разложенияв $K[X]$). Но тогда получим разложение в $A[X]$!

\noindent Разложение в $K[X]$ единственно, так как $K[X]$ факториально. Следовательно, разложение в $A[X]$ единственно.
\end{myproof}
\begin{sled}
\hspace*{0.5cm}(i) Если $A$ — факториальное кольцо, то это же верно и для $A[X_{1},\ldots,X_{n}]$ и результат, разумеется, верен, если $А$ — поле.

(ii) В частности, $\mathbb{Z}[X_{1},\ldots,X_{n}]$ — факториальное кольцо.
\end{sled}
\begin{mynote}

1. Теорема Гаусса позволяет охарактеризовать неприводимые элементы в $A[X_{1},\ldots,X_{n}]$. А именно:
\begin{itemize}
\item неприводимые константы в $A$,
\item неприводимые примитивные многочлены над полем дробей кольца $A$.
\end{itemize}

2. Всякое кольцо многочленов над факториальным кольцом факториально. Однако кольцо многочленов над КГИ не является, вообще говоря, КГИ. ($A[X]$ — кольцо главных идеалов тогда и только тогда, когда $A$ — поле).

Идеал $I=(X+2)\mathbb{Z}[X]+X\mathbb{Z}[X]$ в кольце $\mathbb{Z}[X]$ не является главным, хотя он и максимален, так как это ядро сюръективного морфизма $\chi$ из $\mathbb{Z}[X]$ на $\mathbb{Z}/2\mathbb{Z}$, который каждому многочлену ставит в соответствие класс четности его постоянного коэффициента. Итак, $\mathbb{Z}[X]/I$ тело, и $I$ — максимальный.
\end{mynote}
\hspace*{15cm}

Мы закончим эту, немного абстрактную, часть критерием неприводимости многочлена в факториальном кольце: критерий Эйзенштейна.
\newpage
