% \documentclass{mai_book}

% \defaultfontfeatures{Mapping=tex-text}
% \setdefaultlanguage{russian}

% \clearpage
% \setcounter{page}{235} % ВОТ ТУТ ЗАДАТЬ СТРАНИЦУ
% Эти счетчики достаточно задать один раз, обновляются дальше сами


% \begin{document}

\begin{predl}[критерий Эйзенштейна]
Пусть $A$ — факториальное кольцо и $K$ — его поле дробей. Пусть
$P = a_nX^n+ \\ +...+a_1X+a_0$ — многочлен с коэффициентами из $A$, такой,
что для некоторого неприводимого $p \in A$ выполнено: $p |a_0,p| a_1,...,p |a_{n-1},$ но $p \dagger a_n$ и $p^2 \dagger a_0$. Тогда $P$ неприводим в $K[X]$, а следовательно, и в $A[X]$.
\end{predl}

\begin{myproof}
Предположим, что $P=(b_qX^q+...+b_0)(c_rX^r+...+c_0), q > 0$ и $r > 0$.
Так как $p|a_0$ и $p^2 \dagger a_0$, то можно предположить, что $p|b_0$ и $p^2 \dagger c_0$. Кроме того, из $p^2 \dagger a_n$, следует, что $p^2 \dagger b_q$. Итак, можно найти такое целое число $s \le q$, что $p|b_i$ для всякого $i < s$ и $p^2 \dagger b_s$. Так как $s \le q < n$, то $p$ делит $a_s$, которое равно $b_sc_0+b_{s-1}c_1+...+b_kc_{s-k}$ с $k = min(s,r)$. Так как $p$ делит все $b_i$ с $i < s$, то он делит первый
член суммы $b_sc_0$. Так как он не делит $b_s$, то $p$ делит $c_o$, откуда
получаем противоречие, ибо $p^2$ не делит $a_0$.
\end{myproof}

\noindent \textit{Примеры.}

\textbf{1.} Пусть $p$ — простое число и Ф$_p(X) = X^{p-1}+X^{p-2}+...+X+1$.
Тогда Ф$_p$ неприводим в $\mathbb{Q}[X]$. Действительно, Ф$_p(X+1) = (X+1)^p-1 = \sum _{i>0} \begin{pmatrix}
p \\
i
\end{pmatrix} X^i$ — многочлен, удовлетворяющий критерию Эйзенштейна.
Ф$_p$ - циклотомический многочлен уровня $p$.

\textbf{2.}Однако для всякого непростого $n > 1$ многочлен $P_n = X^{n-1}+X^{n-2}+...+ \\ +X+1$ не является неприводимым. Чтобы это увидеть,
достаточно записать, полагая $n = ab$:
\[
P_{ab} = \frac{X^{ab}-1}{X-1} = \frac{(X^a)^b-1}{X^a-1} \frac{X^a-1}{X-1}.
\]

\textbf{3.}Рассмотрим теперь для простого числа $p$ циклотомические 
многочлены Ф$_{p^ \alpha} = X^{(p-1)p^{\alpha -1}}+X^{(p-2)p^{\alpha -1}}+...+X^{p^{\alpha -1}} + 1 = $ Ф$_p(X^{p^{\alpha -1}})$.
Эти многочлены неприводимы над $\mathbb{Z}$. Осуществим ту же самую 
замену переменных $X \to X+1$, что и для Ф$_p$, и без труда докажем, что
$p$ — свободный член многочлена Ф$_{p^ \alpha}(X+1)$ и $X^{(p-1)p^{\alpha -1}}$ — его старший член. Затем рассмотрим $\mathbb{Z}/p \mathbb{Z}[X]$, где имеем формальное равенство $(X+Y)^p = X^p+Y^p$. Тогда
\[
\text{Ф}_{p^ \alpha}(X+1) = \frac{(X+1)^{p^ \alpha}-1}{(X+1)^{p^{\alpha - 1}}} = \frac{X^{p^ \alpha}}{X^{p^{\alpha -1}}} = X^{(p-1)p^{\alpha -1}}.
\]

\pagebreak

\noindent Следовательно, в $\mathbb{Z}[X]$ имеем Ф$_{p^ \alpha}(X+1) = X^{(p-1)p^{\alpha -1}}+pQ$, где $Q$ —
многочлен с целыми коэффициентами, имеющий степень, строго 
меньшую $(p-1)p^{\alpha -1}$. Критерий Эйзенштейна тогда применяется 
напрямую (можно посмотреть упражнение $52$, которое доказывает 
неприводимость всех циклотомических многочленов).
\\

Прежде чем вычислять НОД двух многочленов, рассмотрим 
алгоритм, позволяющий осуществить \textit{псевдоделение} в кольце без делителей
нуля.

Напомним, что обычное евклидово деление многочленов возможно
в $A[X]$, если старший коэффициент делителя обратим в $A$. Чтобы 
избежать этого предположения, умножим делимое на подходящую 
степень старшего коэффициента делителя и вместо обычного равенства
$P = QW+R$ получим, например, тождество $\alpha P = QW+R$.

\begin{lstlisting}[caption="Евклидово псевдоделение многочленов
над кольцом без делителей нуля"]
int pseudo_division(vector* A, vector* B, vector* Q, vector* R)
{
    int n = deg(A); int m = deg(B);
    create_vector(R, n + 1); create_vector(Q, n-m + 1);
    int b_m = B->data[0];
    int alpha = 1;
    int i = 0, k = 0;
    for (i = 0; i <= n; i++){
        R->data[i] = A->data[i];
    }
    for (i = 0; i <= n-m; i++){
        Q->data[i] = 0;
    }
    for (k = n-m; k >= 0; k--){
        for (i = 0; i <= k-1 ; i++){
            R->data[i] = b_m * R->data[i];
        }
        Q->data[k] = b_m * R->data[m+k];
        for (i = k; i <= m+k-1 ; i++){
            R->data[i] = b_m * R->data[i] - Q->data[k] * B->data[i-k];
        }
        alpha *= b_m;
    }
    return alpha;
}
\end{lstlisting}

При применении алгоритма к многочленам с целыми 
коэффициентами (как это и будет сделано далее) коэффициенты 
промежуточных результатов растут чрезмерно быстро (элемент $\alpha$ равен $b_m^{n-m+1}$), и при желании уменьшить этот рост можно заменить множитель $b_m$ при умножении коэффициентов на $b_m$/НОД($b_m, r_{m+k}$). Это ничего не
изменит в инвариантах, но зато несколько ограничит рост 
коэффициентов.

Чтобы разработать алгоритм «а lа Евклид» для вычисления НОД,
надо убедиться, что метод, заключающийся в итерированном повторении псевдоделений, сохраняет НОД в некотором смысле, который
предстоит определить.

Рассмотрим два примитивных многочлена $A$ и $B$ и сделаем 
псевдоделение $A$ на $B$: $\alpha A=BQ+R$. Очевидно, что делитель $A$ и $B$ является делителем $R$. Обратно, если $D$ делит $B$, то $D$ примитивен, так как $B$ является примитивным. Если к тому же $D$ делит $R$, то он делит и
$\alpha А$, а следовательно, делит $A$. Итак, псевдоделение $A$ на $B$ сохраняет НОД для примитивных многочленов. Для итерирования этой 
процедуры можно рассматривать впоследствии только примитивную часть $R$.
Действительно, в предыдущих обозначениях НОД($A$,$B$) и НОД($B$,$R$)
имеют одну и ту же примитивную часть. С другой стороны, 
содержание НОД двух многочленов есть НОД содержаний.

Алгоритм вычисления НОД двух многочленов с коэффициентами в
(факториальном) кольце заключается, следовательно, в вычислении $d$,
НОД содержаний двух многочленов. Затем, в выполнении 
псевдоделений примитивных частей исходных многочленов. Повторяют операцию,
заменяя полученный остаток его примитивной частью, и т.д. Алгоритм
останавливается, когда полученный остаток нулевой или постоянный.
В этом случае НОД двух многочленов — примитивная часть 
последнего ненулевого остатка, умноженного на постоянную $d$, вычисленную в
начале алгоритма.
\\

\noindent \textit{Пример.}

Сейчас мы вычислим НОД двух многочленов (пример заимствован
у Кнута):
\\

$P = X^8+X^6-3 X^4-3 X^3+8 X^2+2 X-5$ и $Q = 3 X^6+5 X^4-4 X^2-9 X+21.$
\\

Эти два многочлена примитивны. Следовательно, никакие поправки 
после вычислений не должны вноситься в полученный результат. Сделаем
первое псевдоделение:
\\

$27P = Q \cdot (9X^2 - 6) + (-15X^4 + 3X^2 - 9),$
\\

\noindent и сохраним только примитивную часть полученного остатка:
$—5X^2 + X^2 — 3$. Затем повторим эти действия и получим следующую
последовательность псевдоделений:
\\

$27(X^8 + X^6 - 3X^4 - 3X^3 + 8X^2 + 2X - 5)=\\ \indent
= (3X^6 + 5X^4 - 4X^2 - 9X + 21)W_1 + (-15X^2 + 3X^2 - 9),\\ \indent
125(3X^6 + 5X^4 - 4X^2 - 9Х + 21) = (5X^4 - X^2 + 3)W_2+\\ \indent
+ (-585X^2 - 1125X + 2205),\\ \indent
2197(5X^4-X^2+3)=(13X^2+25X-49)W_3+(-233150X+307500),\\ \indent 21743569(13X^2+25X-49)=(4663X-6150)W_4+143193869.$
\\

\noindent Два исходных многочлена, следовательно, взаимно просты. Отметим,
что после каждого псевдоделения сохраняется только примитивная
часть остатка. Это приводит к большому количеству вычислений, 
которые могут существенно замедлить алгоритм. Посмотрим, что стало
бы с последовательностью псев до делений, если не осуществлять этого
сокращения на каждом этапе.
\\

$27(X^8+X^6-3X^4-3X^3+8X^2+2X-5)=\\ \indent
= (3X^6+5X^4-4X^2-9X+21)W_1+(-15X^2+3X^2-9),\\ \indent
3375(3X^6+5X^4-4X^2-9X+21)= \\ \indent
= (-15X^2+3X^2-9)W_2+(15795X^2+30375X-59535),\\ \indent
3940568584875(-15X^2+3X^2-9) = (15795X^2+30375X-59535)W_3+\\ \indent
+(1254542875143750X - 1654608338437500),\\ \indent
1573877825573946701583164062500(15795X^2 + 30375X - 59535) =\\ \indent
= (1254542875143750X- 1654608338437500)W_4+\\ \indent
+12593338795500743100931141992187500.$
\\

\noindent Это апокалиптично! Но нужно осознать, что вычисления с 
гигантскими множителями, появляющимися в левой части равенств, не являются
необходимыми. В частности, никакие действительные умножения 
многочлена, который делится, не имеют места. Важны лишь полученные в
псевдоделениях остатки.

В действительности, есть другое решение для сокращения 
полученных коэффициентов, которые не дают все-таки лучшие результаты,
чем сокращения на НОД — без всякого вычисления НОД — но это
изложение выходит за рамки, которые нами зафиксированы (см. , 
например, Кнут [$99$]).

\section{Вместо заключения}

\noindent Начав эту главу с очень простого введения (вычисление НОД двух це­лых чисел), мы изучили более сложные арифметические понятия, касающиеся колец, отличных от кольца целых чисел, и использовали не­сколько алгоритмов и методов вычисления. Вот (без всякого доказа­тельства) краткий обзор нескольких приложений, некоторые из кото­рых будут развернуты в следующих главах.

\pagebreak

Арифметика кольца $\mathbb{Z}[\sqrt{3}]$ тесно связана с применением критерия
простоты Лукаса — Лемера. Этот критерий, касающийся чисел Мерсенна, т.е. чисел вида $2^q—1$, позволяет найти самые большие известные
к настоящему времени простые числа. Например, в $1985$ г. доказана
простота числа $2^{216091}—1$ (числа, имеющего $65050$ десятичных цифр).
Доказательство успешно сочетало арифметику кольца $\mathbb{Z}[\sqrt{3}]$, изобрета­тельность Лукаса и Лемера и, конечно, быстроту самых мощных ком­пьютеров, таких как CRAY.

Однако вычисления, составляющие критерий Лукаса — Лемера, зна­чи-
тельно более простые, чем вычисления, применяемые ординарным
методом, приводят к необходимости умножения больших чисел (напри­мер, $10000$ десятичных цифр), делающих невозможным использование
наивных умножений. Это удается сделать использованием результатов
о преобразовании Фурье (Кули, Тьюки, Поллард), китайской теоре­мы об остатках (для которой вычисление коэффициентов Безу играет
основную роль), которая позволяет программировать умножения, зна­
чительно уменьшающие время вычислений. В этом случае алгебраиче­ские структуры, вводимые в игру, есть вычеты $\mathbb{Z}/p\mathbb{Z}$, богатые корнями
из единицы. Можно, впрочем, вместо факторов $\mathbb{Z}$ использовать факто­
ры евклидова кольца $\mathbb{Z}[i]$: это объект современных исследований.

Опишем другое поразительное применение арифметики кольца
главных идеалов (не евклидова) $\mathbb{Z}[\frac{1+\sqrt{-163}}{2}]$, кольца целых чисел
$\mathbb{Q}(\sqrt{—163})$. Индийский математик Рамануджан нашел, в частности, ря­ды, быстро сходящиеся к $1/\pi$. Вот один из них:
\[
\frac{1}{\pi}=12\times\sum_0^\infty(-1)^n\frac{(6n)!}{(n!)^3(3n)!}\frac{13~591~409 + 545~140~134 \times n}{(640~320^3)^{n+\frac{1}{2}}},
\]
который сходится при точности до $15$ десятичных знаков на слагаемое
(основное), но дает тысячи десятичных знаков $\pi$. В действительности,
число $640320^3$ связано с арифметикой поля $\mathbb{Q}(\sqrt{-163})$ (механизм этой
связи слишком сложен, чтобы быть воспроизведенным здесь). В неко­
тором смысле $\mathbb{Q}(\sqrt{—163})$ есть то, «что можно сделать лучше»: $163$ — самое большое натуральное число $d$, такое, что кольцо целых чисел в $\mathbb{Q}(\sqrt{-d})$ является КГИ. Невероятное применение абстрактной арифметики к конкретным числовым вычислениям.

Упомянем также теорию кодов, обнаруживающих (и исправляющих)
ошибки, для которой конечные поля, неприводимые многочлены над
этими полями, в особенности над $\mathbb{Z}/2\mathbb{Z}$, — основные инструменты.

Закончим замечанием исторического плана. Уравнение Ферма ($1665$)
было глубокой мотивацией для изучения арифметики в циклотомиче-

\noindent ском кольце $\mathbb{Z}[\sqrt[n]1]$ (кольцо, порожденное корнями $n$-й степени из единицы в $\mathbb{C}$) и это может рассматриваться как исходная точка в развитии теории чисел. Куммер, Ламе, Дирихле, затем Дедекинд, Кронеккер и многие другие математики XIX - XX веков изучали знаменитую «теорему» Ферма:
\\

\begin{thm}[Великая "теорема" Ферма.]
Для $n \ge 3$ уравнение $x^n + y^n = z^n$ не имеет нетривиальных 
решении в целых числах (т.е. решений, отличных от таких, где одно из
неизвестных $x$, $y$ или $z$ равно нулю).
\end{thm}

Эта проблема, не решенная до настоящего времени \footnote{B настоящее время проблема Ферма решена [$195$]. Последнюю точку в длинной
и драматичной истории поставил английский математик Эндрю Уайлэ. Би Би Си
посвятило этому событию телевизионную программу, показанную в США в конце
$1997$ г. На эту же тему имеется книга [$194$], излагающая историю открытия, из которой видно, что в подготовке приняли участие многие математики. Для 
интересующихся читателей можно также рекомендовать книгу [$191$] на русском языке, а также книгу [$193$], вопрос о переводе которой на русский язык обсуждался. — Прим. ред.}, была (и 
остается еще) особым мотором в теории чисел. Большой прогресс и 
эффективность разработанных методов, связанная с использованием мощных
компьютеров, позволяют проверить справедливость теоремы Ферма до
$n \le 125000$.
\\

Все сказанное, должно быть, убедило читателя, что изучение
абстрактных понятий вовсе не расходится, а находится в согласии с
изучением методов эффективных вычислений.
\\

\newpage

%\begin{english}

\hangindent=3cm \hangafter=0
\textit{Although it is not well known, Kummer at one time believed he had found a complete proof of Fermat's theorem... Seeking the
best critic for his proof, Kummer sent his manu\-script to Dirichlet...
After a few days, Dirichlet replied with the opinion that the proof
was excellent and certainly correct, provided the numbers in $\alpha$ could
not only be decomposed into indecom\-posable factors, as Kummer
proved, but that this could be done in only one way. If however,
the second hypothesis couldn't be satisfied, most of the theorem for
the arithmetic of numbers in $\alpha$ would be unproven and the proof
of Kummer's theorem would fall apart. Unfortunately, it appeared to him that the numbers in $\alpha$ didn't actually possess this property in
general \footnote{Хотя это и не очень хорошо известно, Куммер некоторое время был уверен, что нашел полное доказательство теоремы Ферма... Желая найти лучшего критика для своего доказательства, Куммер послал рукопись Дирихле... Вскоре Дирихле ответил, что, по его мнению, доказательство великолепно и без сомнения верно при условии, что числа в $\alpha$ могут быть не только разложены в произведение неразложимых сомножителей, как доказано Куммером, но что это может быть сделано единственным образом. Однако, если второе предположение не выполнено, то большая часть теоремы об арифметике чисел в $\alpha$ останется недоказанной и доказательство теоремы Куммера рухнет. К сожалению, ему кажется, что для чисел в $\alpha$ это свойство,
вообще говоря, не выполнено. \\ \indent Курт Генэель, Празднование столетия со дня рождения Куммера ($1910$) [$153$]}.}

\begin{flushright}
\textit{Kurt Hensel,}

\textit{Commemoration of the first centennial of Kummer's birth ($1910$ [$153$])}
\end{flushright}

%\end{english}

\newpage

\begin{center}
\Large\textbf{Упражнения}
\end{center}
\cleartop

\vspace{20pt}

\noindent \textbf{1. Десятичные цифры простых чисел}
\\

Теорема об арифметической прогрессии Дирихле утверждает, что
для каждой пары ($a, b$) целых простых чисел существует бесконечно
много простых чисел вида $an+b$. 

Использовать этот результат, чтобы доказать, что какова бы ни была последовательность $B$ десятичных цифр, существует бесконечное множество простых чисел, десятичная запись которых включает $В$.
\\

\noindent \textbf{\textit{Пример.}}

Выберем $B = 1991$, которое поместим в предпоследнюю позицию.
Вот несколько простых чисел, содержащих $1991$:

$219917, 519917, 1319917, 1919917, 2319917,$

$2619917, 3219917, 3419917, 3519917, 4719917, ...$
\\

\noindent \textbf{2. Вычисление НОД}
\\

Пусть $a$ и $b$ — два целых взаимно простых целых числа. Доказать,
что

\[
\text{НОД}(a^m-b^m,a^n-b^n)=a^{\text{НОД(m,n)}}-b^{\text{НОД(m,n)}}.
\]
\\

\noindent \textbf{3. Алгоритм Евклида и непрерывные дроби}
\\

Обозначим через $[a_0,a_1,a_2,...,a_{n-2},a_{n-1},a_{n}]$ непрерывную дробь

\[
x = a_0+\dfrac{1}{a_1+\dfrac{1}{a_2+\dfrac{1}{...}}}
\]

\noindent Так как $[0,a_1,...,a_n] < 1$ (исключая дробь $[0,1] (n=1,a_1=1$), то $a_0$
можно найти по числу $x: a_0=[x]$. Другой способ найти значения $a_i$,
содержится в упражнении.

\pagebreak

\textbf{a.} Доказать, что всякое рациональное число может быть записано
в этой форме с $a_i>0$ для $i \ne 0$.

\textbf{b.} Доказать, что если $[c_0,...,c_m]=[d_0,...,d_n]$ и если $c_m>1,d_n>1$, то $n=m$ и $c_i=d_i$.

\textbf{c.} Всякая конечная непрерывная дробь, очевидно, представляет 
рациональное число. Доказать, что всякое рациональное число можно
представить непрерывной дробью и притом двумя способами 
(значения, участвующие в разложении, положительны, кроме, возможно, 
первого). Каноническая форма представления в непрерывную дробь для
рационального числа — самая короткая из этих форм (естественно,
предполагается, что последнее частное отлично от $1$).

\textbf{d.} Вычислить рациональные числа, разлагающиеся в непрерывную
дробь $[a_0,a_1,...,a_n]$ для $n=1,2,3,4$. Вычислить разложения в 
непрерывную дробь чисел $F_4/F_3,F_5/F_4$, где $F_i$ — числа Фибоначчи.
\\

\restoretop
\newtoplo{Упражнения}

\noindent \textbf{4. Многочлены континуанты}
\\

Определим последовательность формальных полиномов для 
бесконечного числа переменных следующим образом: $K_{-1} = 0, K_0 = 1$ и
$K_n(X_1,...,X_n)= \\ =X_nK_{n-1}(X_1,...,X_{n-1})+K_{n-2}(X_1,...,X_{n-2})$. Многочлены $K_n(X_1,...,X_n)$ называются \textbf{континуантами}. По определению, континуанта индекса $n$ — это многочлен от $n$ переменных $X_1,...,X_n$.

\textbf{a.} Вычислить первые члены последовательности континуант. Каковы соотношения между континуантами и числами Фибоначчи?

\textbf{b.} Доказать, что многочлен Кп есть сумма всех одночленов, 
начиная с произведения $X_1,...,X_n$, полученных вычеркиванием 
всевозможных мономов и непересекающихся пар соседних переменных в этом 
одночлене.

\textbf{c.} Вывести из этого другое рекуррентное правило, определяющее
последовательность $K_n$ и следующее тождество между рациональными
дробями:

\[
\frac{K_n(X_1,...,X_n)}{K_{n-1}(X_2,...,X_n)} = X_1+\frac{K_{n-2}(X_3,...,X_n)}{K_{n-1}(X_2,...,X_n)}
\]

\noindent Какое заключение можно отсюда сделать?
\\

\noindent \textbf{5. Континуанты (продолжение)}
\\

\textbf{a.} Выразить функцию полиномов-континуант через произведения
матриц

\[
\begin{pmatrix}
X_1 & 1\\
1 & 0
\end{pmatrix} \begin{pmatrix}
X_2 & 1\\
1 & 0
\end{pmatrix} ... \begin{pmatrix}
X_n & 1\\
1 & 0
\end{pmatrix}.
\]

\pagebreak

\textbf{b.} Доказать, что

\[
K_n(X_1,...,X_n)K_n(X_2,...,X_{n+1})-K_{n+1}(X_1,...,X_{n+1})K_{n-1}(X_2,...,X_n) = (-1)^n.
\]

\noindent Что можно отсюда вывести, если $K_n(a_1,...,a_n)$ и $K_{n-1}(a_2,...,a_n)$ являются целыми?

\textbf{c.} Рассматривая произведение матриц

\[
\begin{pmatrix}
X_{n+2} & 1\\
0 & 1
\end{pmatrix} \begin{pmatrix}
K_{n+1}(X_1,...,X_{n+1}) & K_n(X_2,...,X_{n+1})\\
K_n(X_1,...,X_n) & K_{n-1}(X_2,...,X_n)
\end{pmatrix},
\]

\noindent доказать соотношение:
\[
K_{n-1}(X_2,...,X_n)K_{n+2}(X_1,...,X_{n+2})-K_n(X_1,...,X_n)K_{n+1}(X_2,...,X_{n+2}) = (-1)^{n+1}X_{n+2}.
\]

\newtopre{II\quad Евклид и основная теорема арифметики}

\noindent \textbf{6. Разложение в непрерывную дробь}
\\

Если $x \in \mathbb{R}$, то можно определить последовательности $(x_n)$ и $(a_n)$ следующим образом: положим $x_0 = x, a_0 = [x_0]$ и для $n>0$

\[
x_{k+1} = \frac{1}{x_k-a_k} \text{ и } a_{k+1} = [x_{k+1}].
\]

\noindent (в этой последовательности все элементы $a_k$ положительны, кроме,
при необходимости, первого). Эта последовательность конечна тогда
и только тогда, когда $x$ — рациональное число, и дает разложение $x$ в
непрерывную дробь (это понятие, очевидно, совпадает с определением
упражнения 3, если $x$ рационально).

Если $f = [a_0,a_1,a_2,...]$ — непрерывная дробь (конечная или 
бесконечная), то $n$-членный отрезок этой дроби, представляющий 
рациональное число $[a_0,...,a_n]$, называют подходящей дробью для непрерывной дроби $f$, или приближением $f$.

\textbf{a.} Выразить $n$-ую подходящую дробь для $f$ через функцию 
многочленов континуант.

\textbf{b.} В предыдущих обозначениях доказать, что $x = [a_0,...,a_n,x_{n+1}]$. Вывести отсюда, что последовательность подходящих дробей для 
вещественного числа $x$ сходится к $x$.

Начиная с этого момента будем отождествлять непрерывную дробь
и ее \textit{значение}.

\pagebreak

\textbf{c.} Вывести из вопроса $\textbf{(b)}$ упражнения $5$ алгоритм вычисления $n$-й подходящей дроби для $x$, приводящий ее к неприводимому виду. Выразить алгоритм в явном виде, как последовательность, сходящуюся к
непрерывной дроби.

\textbf{d.} Вычислить разложение в непрерывную дробь числа золотого 
сечения $\phi$. Вычислить последовательные подходящие дроби для этого 
разложения.
\\

\noindent \textbf{7. Аппроксимация вещественных чисел с помощью
непрерывных дробей}
\\

Пусть $[a_0,a_1,a_2,...]$ — разложение в непрерывную дробь 
иррационального числа $x$ (в действительности все, что доказывается, 
остается верным и для рациональных чисел, но необходимо учитывать 
конечность разложения, что излишне усложняет доказательство). Мы не
доказываем факт, что разложение в непрерывную дробь 
единственно. В дальнейшем, чтобы упростить обозначения, мы обозначим 
через $p_n$ и $q_n$ числитель и знаменатель $n$-й подходящей дроби (имеем
$p_n = K_{n+1}(a_0,...,a_n)$ и $q_n = K_n(a_1,...,a_n)$).

\textbf{a.} Используя соотношения между континуантами из упражнения $5$,
доказать, что последовательность $q_n$ строго возрастающая, и 
вычислить знаки выражений $(p_{n+1}/q_{n+1} - p_n/q_n)$ и $(p_{n+1}/q_{n+1} -p_{n-1}/q_{n-1})$. Вывести из этого, что последовательность упорядоченных четных пар строго возрастающая, а последовательность с нечетными номерами
строго убывает и $x$ заключен между этими последовательностями.

Доказать, что подходящие дроби для непрерывной дроби 
иррационального числа дают наилучшие аппроксимации этого числа в 
следующем смысле:

\[
\forall q, 0<q \le q_n, \frac{p}{q} \ne \frac{p_n}{q_n}: |p_n-xq_n|<|p-xq|,
\]
откуда, конечно, следует, что $|x-p_n/q_n|<|x-p/q|$. Можно 
предполагать, что $p$ и $q$ взаимно просты в этом случае.

\textbf{b.} Доказать с помощью равенства $(11)$, фигурирующего в решении
упражнения $6$, следующее утверждение:

\[
\frac{1}{q_nq_{n+2}}<|x-\frac{p_n}{q_n}|<\frac{1}{q_nq_{n+1}}.
\]
Вывести, что $|p_n-xq_n| < |p_{n-1}-xq_{n-1}|$, так что $|x-p_n/q_n|<|x-p_{n-1}/q_{n-1}|$.

\pagebreak

Для того чтобы доказать результат, можно предполагать (начиная
с этого момента), что $q_{n-1} < q \le q_n$.

\textbf{c.} Пусть $q = q_n$. Доказать утверждение $(9)$, опираясь на 
формулу $(12)$, фигурирующую в решении упражнения $6$.

\textbf{d.} Пусть $q_{n-1}<q<q_n$. Используя матричное выражение $(8)$ из
упражнения $5$, доказать, что если $p$ линейно выражается через $p_n$ и
$p_{n-1}$ и $q$ является линейной функцией $q_n$ и $q_{n-1}$, то коэффициенты для выражения $q$ те же, что и для выражения $p$. Вывести отсюда 
предложение $(9)$.

\begin{mynotice}
Есть и другие результаты по аппроксимации вещественных чисел
с помощью непрерывных дробей. В частности, известно, что для двух
последовательных подходящих дробей в разложении $x$ хотя бы одна
удовлетворяет соотношению $|x-p/q| < 1/2q^2$. Известно также, что
иррациональное число обладает бесконечным множеством 
аппроксимаций, удовлетворяющих соотношению $|x-p/q| < 1/q^2 \sqrt{5}$ и $\sqrt{5}$ — наилучшая возможная константа. Кроме того, среди трех последовательных подходящих дробей для $x$ по меньшей мере две удовлетворяют 
соотношению $|x-p/q| < 1/q^2 \sqrt{5}$. Наконец, подходящие дроби для числа
$x$ — единственные \textit{хорошие аппроксимации} $x$ в том смысле, что если
$|x-p/q| < 1/2q^2$, то $p/q$ — подходящая дробь для $х$. Детали можно
найти также у Левека $[119]$, Харди и Райта $[80]$, Кнута $[99]$ и $[103]$.
\end{mynotice}

\noindent \textit{Примеры.}

Вот разложения в непрерывную дробь и подходящие дроби для 
некоторых известных чисел.

\textbf{e.} $\sqrt{2} = [1,2,2,2,2...] = 1,414213...$; первые подходящие дроби $3/2 = 1,5, 7/5 = \\ = 1,4, 17/12 \approx 1,4166..., 41/29 \approx 1,4137$ и т.д. Как и следовало ожидать, таким способом не получим быстро сходящуюся
последовательность к $\sqrt{2}$, по крайней мере, по-началу.

\textbf{f.} $\sqrt{3} = [1,1,2,1,2,1,2...] = 1,732050$. Первые подходящие дроби $2, 5/3, 7/4$ и т.д.

Заметим, что для последних двух случаев разложение в непрерывную дробь оказалось периодическим. В действительности это общее свойство: разложение в непрерывную дробь квадратичной иррациональности периодично.

\textbf{g.} $\pi = [3,7,15,1,292,1,1,1,2,1,3,1,14,2,1,1,2,...] = 3,141592653...$ Это разложение уже не периодическое, так как сформулированное 
выше свойство на самом деле — необходимое и достаточное условие. Если вычислить последовательные подходящие дроби, то найдем хорошо известные аппроксимации: вторая подходящая дробь $22/7 \approx 3,142$, 
четвертая — $355/113 \approx 3,1415929$.

\pagebreak

\textbf{h.} Наконец,

\[
е = [2,1,2,1,1,4,1,1,6,1,1,8,1,1,10,1,1,12,...] = 2,718 281828459045...
\]

\noindent Это разложение, кажется обладает некоторой периодичностью, и 
действительно доказано, что разложение $e$ есть $[...,2\pi,1,1,2\pi+2,1,1,...]$. Однако никакой результат того же типа не доказан для $\pi$.
\\

\noindent \textbf{8. Факториал и простые числа}
\\

\textbf{a.} Доказать, что если $n > 4$ не является простым, то $(n — 1)! \equiv 0 \text{ } (\text{mod } n)$.

\textbf{b.} Доказать, что для любого числа $n$ существует $n$ 
последовательных натуральных чисел, ни одно из которых не является простым. 
Указание: рассмотреть число $(n + 1)! + 2$.

\textbf{c.} Доказать, что для любого натурального $n$ в интервале $]n, n! + 1]$ существует простое число.

\textbf{d.} Предыдущие задачи наводят на мысль рассмотреть 
последовательность $(e_n)$, определенную следующим образом: $e_1 = 2$ и
$e_n = e_1e_2...e_{n-1}+1$. Все ли эти числа просты? Они взаимно просты?
\\

\noindent \textbf{9. Каноническое разложение $n!$}
\\

Доказать следующую формулу, называемую \textbf{разложением Лежандра}:

\[
n! = \prod_{p \text{ простое}} p^{\sum_{i=1}^\infty[n/p^i]}.
\]
(Несмотря на видимость противного и в сумме и в произведении, 
входящих в эту формулу, присутствует лишь конечное число членов.)
\\

\noindent \textbf{10. Уравнение Ферма для $n = 2$ и $n = 4$}
\\

Найдем все решения в целых числах $x, y, z$ уравнения $x^2 + y^2 = z^2$.

\textbf{a.} Доказать, что $x$ и $y$ не могут быть оба нечетными. Почему можно
предполагать, что $x$ и $y$ взаимно просты?

\textbf{b.} Доказать, что в $\mathbb{Z}[i]$ элемент $x + iy$ делится на $1 + i$ тогда и только тогда, когда $x \equiv y \text{ } (\text{mod } 2)$. Вывести, используя факториальность 

\pagebreak

\noindent кольца $\mathbb{Z}[i]$, что если $x$ и $y$ — решения уравнения Ферма, то существуют два целых взаимно простых числа $u$ и $v$ такие, что

\[
(x,y) \text{ или } (y,x) = (u^2-v^2, 2uv), \text{ } z=u^2+v^2,
\]
и обратно, каждая такая тройка дает решение уравнения. Дайте 
примеры, а затем найти форму решений исходного уравнения.

\textbf{c.} Показать, как можно просто перейти в $\mathbb{Z}[i]$.

\textbf{d.} Пусть два целых числа $x, y > 0$. Показать, что $x^4 + y^4$ не является квадратом. В частности, уравнение $x^4 + y^4 = z^4$ не имеет 
нетривиальных решений в целых числах.
\\

\noindent \textbf{11. Простое диофантово уравнение}
\\

Диофантовы уравнения — это уравнения в целых числах.

\textbf{a.} Найти решение уравнения $x^2 — 3 y^2 + 1 = 0$ в $\mathbb{Z}[i]$. Доказать, что оно не имеет целочисленных решений.

\textbf{b.} Найти все нетривиальные решения уравнения $x^2 — 5 y^2 + z^2 = 0$.

\textbf{c.} Обобщить: при каких условиях уравнение $x^2 —py^2 + z^2 = 0$ имеет решение в целых числах?
\\

\noindent \textbf{12. Кольцо $\mathbb{Z}[\theta] / (a + \theta b), \text{ } \theta$ — квадратичная иррациональность,} \\ $\text{НОД}(a,b) = 1$
\\

Пусть $a$ и $b$ — два целых взаимно простых числа.

\textbf{a.} Доказать, что отображение $\varphi:\mathbb{Z}\to\mathbb{Z}[i]/(a+ib)$, определяемое по правилу $\varphi(m)=[m]_{a+ib}$, сюръективно, выразив в явном виде элемент $t$, для которого $\varphi(t)=[i]_{a+ib}$.

\textbf{b.} Как связаны равенство $\text{Ker }\varphi=(a^2+b^2)\mathbb{Z}$ и сравнение $t^2\equiv-1 \text{ } (\text{mod } a^2+b^2), a+tb\equiv0 \text{ } (\text{mod } a^2+b^2)$? Справедливы ли они? Можно ли
apriori найти элемент в $\mathbb{Z}/(a^2 + b^2)$, квадрат которого равен $—1$. Как? Сравнить с уже полученным выражением.

\textbf{c.} Доказать, что $\varphi$ индуцирует изоморфизм кольца $\mathbb{Z}/(a^2 + b^2)$ на $\mathbb{Z}[i]/(a+ib)$. Доказать, что если $a + ib$ делит целое число $m$ (в $\mathbb{Z}[i]$), то $a^2 + b^2$ делит $m$ (в $\mathbb{Z}$). Найдя в явном виде обратный изоморфизм, представьте линейную форму $\mu:\mathbb{Z}^2\to\mathbb{Z}$, удовлетворяющую соотношению:

\[
a+ib|x+iy\Longleftrightarrow a^2+b^2|\mu(x,y).
\]
Примените соотношение $(10)$ к следующим примерам: $a + ib = 1 + i$,
$a + ib = 9 + 2i$.

\pagebreak

\textbf{d.} Для произвольных $a, b$ (не обязательно взаимно простых) 
доказать, что $\mathbb{Z}[i]/(a+ib)$ есть кольцо, состоящее из $a^2 + b^2$ элементов.

\textbf{e.} Пусть $\theta$ — квадратичное целое, т.е. элемент в $\theta \in \mathbb{C}\setminus\mathbb{Z}$, удовлетворяющий уравнению $X^2 — SX + P = 0$. Обобщить предыдущее на кольцо $\mathbb{Z}[\theta] / (a + \theta b)$. В частности, число элементов кольца — абсолютное значение нормы $(a + \theta b)$.
\\

\noindent \textbf{13. НОД в $\mathbb{Z}[i]$ и суммы двух квадратов}
\\

\textbf{a.} Пусть $p \in \mathbb{N}$ — простое число, для которого $p \equiv 1$ (mod $4$), $x \in \mathbb{Z}$ такой, что $x^2 \equiv —1$ (mod $p$) (способ нахождения такого $x$ предложен в с). Доказать, что если $u + iv = $НОД$(p, x + i)$, то $p = u^2 + v^2$. Зная корень квадратный $x$ из $-1$ по модулю $p$, найти эффективный метод представления $p$ в виде суммы двух квадратов. Записать в виде суммы двух квадратов следующие простые числа: $1301, 1000037$ и $2 000 004 973$, зная, что:
\[
51^2 \equiv -1 \text{ } (\text{mod } 1301), 320900^2 \equiv -1 \text{ } (\text{mod } 1000037), 106540073^2 \equiv -1 \text{ } (\text{mod } 2000004973).
\]

\textbf{b.} Обобщить результат пункта \textbf{a}, рассматривая целое число $n$, делитель $x^2 + y^2$, где $x$ и $y$ взаимно просты. Если $u+iv = $НОД$(n, x + iy)$, то показать, что $n=u^2+v^2$ (можно использовать результат 
упражнения $12$: если $a + ib$ с $a \wedge b = 1$ делит целое число $m$, то $N(a + ib) = (a + ib)(a — ib)$ делит $m$).

\textbf{c.} Пусть $p = 1$ (mod $4$). Запишем $p—1 = 2^kq$, где $q$ нечетно и $k \ge 2$. С $y \in [1,p—1]$ ассоциируем последовательность $(y_i)_{0\le i\le k}$ элементов из $U(\mathbb{Z}_p)$ следующим образом: $y_0 = y^q$ mod $p, y_{i+1} = y^2_i$ mod $p = y^{2^iq}$ mod $p$. Пусть $H \subset U(\mathbb{Z}_p)$ — подмножество тех $y \in U(\mathbb{Z}_p)$, что $y_1 = y^{2q}$ mod $p \ne
1$. Для $y \in H$ доказать, что один из $y_i$ есть корень квадратный из $—1$.
Сколько элементов в $H$? Вывести отсюда вероятностный алгоритм 
вычисления корня квадратного из $—1$ по модулю $p$.
\\

\noindent \textbf{14. Делимость сумм $x^2+2 y^2$}
\\

\textbf{a.} Доказать, что кольцо $\mathbb{Z}[\sqrt{-2}]$ (это подкольцо порождено $1$ и $\sqrt{-2}=i\sqrt{2}$) евклидово с нормой $N$, определяемой через $N(x+y\sqrt{-2}) = x^2+2y^2$ при $x,y \in \mathbb{Z}$. Указание: порассуждайте в поле $\mathbb{Q}(\sqrt{-2})$ \footnote{Вообще, если $A$ — кольцо, то $A[x_i,x_2,...]$ обозначает над-кольцо $А$ (расширение
кольца $А$), порожденное $x_i,x_2,...$; то же обозначение применяется, если $A$ — поле. Если $K$ — поле, то обозначение $K(х_1,x_2,...)$ определяет расширение $K$ с помощью элементов (над-поле) поля $x_1,x_2,...$ Здесь, так как $Q[\sqrt{—2}]$ уже является полем ($\sqrt{—2}$ алгебраический для $\mathbb{Q}$), имеем совпадение $Q(\sqrt{—2})$ и $Q[\sqrt{— 2}]$.}, поле частных $\mathbb{Z}[\sqrt{-2}]$.

\textbf{b.} Доказать результат относительно сумм $x^2 + 2 y^2$, где $x,y \in \mathbb{Z}$ взаимно просты.

\pagebreak

\textbf{c.} Пусть $p$ — простое целое число, отличное от $2$. Показать, что
$p$ может быть записано в виде $x^2 + 2 y^2$ тогда и только тогда, когда
$—2$ есть квадрат по модулю $p$. Заметим, что последнее эквивалентно
$p = 1$ или $3$ (mod $8$).
\\



\noindent \textbf{15. Делимость целых чисел вида $x^2 — 2 y^2$}
\\

\textbf{a.} Проверить, что кольцо $\mathbb{Z}[\sqrt{-2}]$ евклидово для абсолютного значения нормы $|N|$, определенной соотношением
\[
N(x+y\sqrt{-2})=x^2-2 y^2, \text{ } x,y \in \mathbb{Z}.
\]

\textbf{b.} Обоснуйте результат, касающийся сумм $x^2 — 2 y^2$ и нечетных
простых чисел $p$, выражающихся в этом виде.
\\

\noindent \textbf{16. Кольца $\mathbb{Z}[\sqrt{-3}]$ и $\mathbb{Z}[\sqrt{10}]$ нефакториальны}
\\

\textbf{a.} Доказать нефакториальность кольца $\mathbb{Z}[\sqrt{-3}]$, предъявив элемент, разлагающийся двумя различными способами в произведение 
неприводимых. Указание: найти два целых простых числа, не являющиеся
нормами (в данном кольце) и рассмотреть их произведение.

\textbf{b.} Тот же вопрос для кольца $\mathbb{Z}[\sqrt{10}]$.
\\

\noindent \textbf{17. Целозамкнутые кольца}
\\

\textbf{a.} Доказать, что рациональный корень унитарного многочлена с
целыми коэффициентами есть целое число. Если этот многочлен не
имеет целых корней, то он не имеет и рациональных. Вывести отсюда,
что если $a \in \mathbb{N}$ не является корнем $n$-й степени в $\mathbb{N}$, то $\sqrt[n]{a}$ — иррациональное число.

Пусть $A$ — кольцо целых чисел, $K$ — его поле частных. Говорят, что
$K$ целозамкнуто, если элемент из $K$, являющийся корнем унитарного
многочлена с коэффициентами из $A$, есть элемент из $A$. Отсюда, 
кольцо $\mathbb{Z}$ целозамкнуто. Для каких колец указанное свойство (доказанное для $\mathbb{Z}$) может быть обобщено?

\textbf{b.} Пусть $d \in \mathbb{Z}$ не является квадратичным и удовлетворяет 
соотношению $d \equiv 1$ (mod $4$). Доказать, что кольцо $\mathbb{Z}[\sqrt{d}]$ не целозамкнуто (и потому не факториально). Доказать также, что $2$ — неприводимый элемент, но непростой.

\pagebreak

\textbf{c.} Найти в $\mathbb{Z}[\sqrt{2i}]$ неприводимый элемент, не являющийся простым; элемент, разлагающийся двумя различными способами в произведение неприводимых, и многочлен, неприводимый над $\mathbb{Z}[\sqrt{2i}]$, который не остается неприводимым над полем частных.
\\

\noindent \textbf{18. Целые элементы; целые квадратичности}
\\

\textbf{a.} Пусть $K$ — подполе поля $\mathbb{С}$, имеющее размерность $2$ над $\mathbb{Q}$. Доказать существование и единственность такого $d \in \mathbb{Z}$, что $K$ — поле,
порожденное над $\mathbb{Q}$ элементами $1$ и $\sqrt{d}$:
\[
K = \mathbb{Q}(\sqrt{d}) = \mathbb{Q} \oplus \mathbb{Q}(\sqrt{d}).
\]

\noindent Проверить существование и единственность автоморфизма $\sigma$ поля $K$,
оставляющего на месте $\mathbb{Q}$, такого , что $\sigma (\sqrt{d}) = -\sqrt{d}$. Доказать, что автоморфизм $\sigma$ инволютивный и множество его неподвижных точек совпадает с $\mathbb{Q}$.

\textbf{b.} Пусть два кольца $A$ и $B$ таковы, что $A \subset B$. Будем говорить, что элемент из $B$ \textbf{целый над} $A$ степени $\le n$, если он является корнем унитарного многочлена степени $\le n$ с коэффициентами из $A$. Элементы из $\mathbb{C}$, целые над $\mathbb{Z}$, называются целыми алгебраическими. Квадратичные целые являются целыми алгебраическими степени. Каковы целые алгебраические степени $1$? При каких условиях рациональное число является целым алгебраическим?

\textbf{c.} Пусть $d$ не имеет нетривиальных множителей, являющихся полными квадратами. Доказать, что $\frac{1+\sqrt{d}}{2}$ является целым 
квадратичным тогда и только тогда, когда $d \equiv 1$ (mod $4$).
\\

\noindent \textbf{19. Целые числа в $\mathbb{Q}(\sqrt{d}$}
\\

Обозначим через $d$ элемент из $\mathbb{Z}$, не имеющий нетривиальных 
множителей, являющихся полными квадратами, и $\sigma$ — инволютивный 
автоморфизм $\mathbb{Q}(\sqrt{d})$, переводящий $\sqrt{d}$ в $- \sqrt{d}$.

\textbf{a.} Пусть $z \in K = \mathbb{Q}(\sqrt{d})$. Показать, что $z$ — целая квадратичность тогда и только тогда, когда $z+\sigma (z)in \mathbb{Z}$ и $z\sigma (z) \in \mathbb{Z}$.

\textbf{b.} Доказать, что множество целых квадратичностей в $K$ 
является подкольцом $K$. Указание: если $z$ и $z'$ — целые квадратичности, 
показать, что $x=z\sigma(z')+z'\sigma(z)$ и $y=zz'+\sigma(zz')$ — элементы из $\mathbb{Z}$ (рассмотреть $x + y$ и $xy$).

\pagebreak

\textbf{c.} Используя свойства кольца $\mathbb{Z}[X]$ из раздела $8$, показать, что целые алгебраические числа из $K = \mathbb{Q}(\sqrt{d})$ являются целыми квадратичностями. Множество таких элементов является кольцом целых алгебраических чисел из $K$.

\textbf{d.} Доказать, что кольцо $A$ целых поля $\mathbb{Q}(\sqrt{d})$ совпадает с:
\[
\mathbb{Z}(\sqrt{d}), \text{ если } d \equiv 2 \text{ или } 3 \text{ } (\text{mod } 4), \text{ или } \\ \mathbb{Z}[\frac{1+\sqrt{d}}{2}], \text{ если } d \equiv 1 \text{ } (\text{mod } 4),
\]

соответственно, \{$u+v \sqrt{d} | u,v \in \mathbb{Z}$\} и \{$(u+v \sqrt{d}) / 2 | u,v \in \mathbb{Z}, u \equiv v \text{ } (\text{mod } 2)$\}.
\\

\noindent \textbf{20. Евклидовость квадратичных колец}
\\

Норма $N$ для квадратичного расширения $\mathbb{Q}(\sqrt{d})$ является 
мультипликативной функцией со значениями в $\mathbb{Q}$ и определяется следующим образом: $N(z) = z\sigma(z)$ для $z \in \mathbb{Q}(\sqrt{d})$. Она принимает целые значения на кольце $A$ целых алгебраических чисел в $\mathbb{Q}(\sqrt{d})$ (см. предыдущее упражнение).

\textbf{a.} Доказать, что $A$ является евклидовым для нормы $|N|$ тогда и
только тогда, когда для всякого $z \in \mathbb{Q}(\sqrt{d})$ существует такое $q \in A$, что $|N(z-q)| < 1$.

\textbf{b.} Доказать, что $A$ евклидово для нормы $|N|$, когда $d$ имеет одно
из следующих значений: $—11, —7, —3, —2, —1, 2, 3, 5$ и $13$.

% \noindent \textbf{\textit{Замечания.}}

\begin{mynotice}
\\
\textbf{1.} Для $d < 0$ (поля мнимых квадратичностей) нетривиальный 
результат утверждает, что соответствующее кольцо $A$ является КГИ в
точности для следующих значений $d$:
\[
d = -163, -67, -43, -19, -11, -7, -3, -2, -1.
\]

\noindent Наиболее легкая часть доказательства состоит в проверке того, что эти
$9$ колец — действительно КГИ и что для $4$ простых чисел ($4$ первых)
не евклидовы. Обратное намного труднее. Когда-то, впрочем, 
считали, что могло существовать десятое $d$, такое, что $—5,10^9 < d < —163$,
для которого кольцо целых чисел в $\mathbb{Q}(\sqrt{d})$ является КГИ. Но из этого ничего не получилось, как доказал Старк в $1967$ $[166]$. Об остальных 
деталях можно проконсультироваться у Харди и Райта $[80]$, Эстерле $[138]$,
Дьедонне $[62]$ или Пуату $[145]$.
\end{mynotice}

\pagebreak

% \end{document}