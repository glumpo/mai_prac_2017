\begin{document}

\begin{predl}
\hspace*{0.5cm}

\textit{Пусть M — модуль конечного типа над кольцом А главных идеалов. Если N — подмодуль M, то N конечного типа и p(N) $\leqslant $ p(M).}
\end{predl}
\begin{myproof}
Пусть ($\mu_1, \mu_2, ... ,\mu_m$) - система образующих \textit{M}c \textit{m = p(M).}
Существует одно и только одно линейное отображение \textit{u} из $A^m$ в \textit{M}, удоовлетворяющее условию $u(e_i) = \mu_i$ для \textit{i} = 1,2, ..., \textit{m}. Оно сюръективно, поскольку $\mu_i$ порождают $M$.
Для $N \subset M $ верно равенство $N = u(u^{-1}(N))$. Подмодуль $u^{-1}(N)A^{m}$
имеет базис из $n$ элементов с $n \leqslant m$~(предложение 28 раздела 3.2).\\
Отсюда следует, что \textit{N} порождено \textit{n} элементами, и, как следствие, $p(N) \leqslant n \leqslant m.$ 
\end{myproof}
\begin{mynotice}
 Неравенство для \textit{p} не будет справедливым для модулей конечного типа над произвольным коммутативным кольцом. Достаточно рассмотреть идеалы коммутативного кольца (не кольца главных идеалов), чтобы в этом убедиться. 

 Можно также убедиться в том, что подмодуль модуля конечного типа не обязан быть конечного типа. Для этого достаточно рассмотреть идеалы коммутативного не нётерова кольца, например, кольца полиномов $\mathbb{Q}$[$X_1, X_2, ..., X_i$,...] с бесконечным числом неизвестных.
 \end{mynotice}
\sectiontop
\section{Приведение матрицы}
\noindent В определении 15 была введена эквивалентность двух последовательных целых чисел $(a_i)_{1\leqslant i\leqslant n}$ и $(b_j)_{1 \leqslant j \leqslant n}$ через существование автоморфизма в $\mathbb{Z}^n$, переводящего подгруппу $\prod a_i \mathbb{Z}$ в подгруппу $\prod b_j \mathbb{Z}$. Аналогичная эквивалентность существует для матриц.

\begin{determ}
\hspace*{0.5cm}

\textit{ Две матрицы A и B, не обязательно квадратные, но одинаковых размеров, называются эквивалентными, если существуют две обратимые матрицы L и R такие, что L A R = B. Они (матрицы A и B) называются специально эквивалентными, если матрицы L и R имеют определители, равные 1.}
\end{determ}
Прочитав ~это~ определение, ~можно~ подумать, ~что ~две~ квадратные~ диагональные~ матрицы ~эквивалентны ~тогда и только~ тогда,~ когда последовательности~ целых~ чисел,~ фигурирующие~ на~ диагоналях,~ эквивалентны. Это конечно так,~ но мы~ не можем~ легко доказать необходимое

\pagebreak

\noindent условие: если две квадратные диагональные матрицы эквивалентны, то последовательности целых чисел на диагоналях эквивалентны. Действительно, отношение $L A = B R^{-1}$ показывает, что модули $L(Im A)$ и $Lm B$ равны. Матрица \textit{L} определяет тогда изоморфизм $\varphi$ из определения 15.

В этом разделе мы покажем, что \textbf{любая} матрица (не обязательно квадратная) эквивалента диагональной матрице, последовательность диагональных элементов которой является возрастающей последовательностью \textit{по отношению к делимости}. Этот результат фундаментален и приводит на этот раз к классификации \textbf{всех} подмодулей окружения $\mathbb{Z}^n$ и, таким образом, к классификации \textbf{всех абелевых групп конечного типа} и, в частности, всех абелевых конечных групп. Эти результаты даны в виде алгоритма, применяемого к кольцам главных идеалов, в которых коэффициенты Безу вычисляемы. Со строго математической точки зрения этот раздел посвящен классическим результатам теории модулей над кольцами главных идеалов.
\begin{determ}
\hspace*{0.5cm}

\textit{ Матрица $X = (x_ij)$ с n строками и m столбцами называется \textbf{приведенной,} если выполнены следующие условия}:
\parindent=20ex
$x_ij = 0$ \textit{для} $i \ne j$
\parindent=24.8ex
и $x_{ii} ~| ~ x_{i+1, i+1}$ \textit{для} $ 1 \leqslant i \leqslant $ inf(\textit{n,m}). \\
\[ X= \begin{pmatrix}
x_{11} & 0 & \dots & & & & 0 & 0 & \dots & 0\\
0 & x_{22} & 0 & & & & & 0 & \dots & 0 \\
0 & 0 & x_{33} & & & & & 0 & \dots & 0 \\
\vdots & & & & & & \vdots & \vdots & & 0 \\
0 & & 0 & & & & x_{nn} & 0 & \dots & 0 \\
\end{pmatrix}. 
\] 
\parindent=3ex

\textit{Если в приведенной матрице один из элементов $x_{ii}$ обратим, то \textbf{предшествующие} ему диагональные элементы также обратимы (так как они делят $x_{ii}$). Аналогично, если $x_{ii}$ — ноль, то все \textbf{следующие} за ним диагональные элементы нулевые.}
\end{determ}
Для начала приведем следствие из результатов раздела 2.3, касающееся единственности нормального разложения последовательности элементов коммутативного кольца.
\begin{sled}
\hspace*{0.5cm}
\textit{Пусть $X, X^{'}$ — две приведенные эквивалентные матрицы с n строками и m столбцами и элементами в кольце A. Тогда для $ 1 \leqslant i \leqslant $ inf(\textit{n,m}) идеалы $Ax_{ii}$ и $Ax^{'}_{ii}$ равны (т.е элементы $x_{ii}$ и $x^{'}_{ii} $~соответствуют друг другу. В частности, если A без делителей нуля, то диагональный элемент $x_{ii}$ матрицы X равен элементу $x^{'}_{ii}$, и обратно.}\\\\\\
\end{sled}

\begin{myproof}
По определению эквивалентности матриц существуют две обратимые матрицы L и R такие ,что $X^{'} = L X R$. Тогда можно применить следствие 23 к двум подмодулям Im X и Im $X^{'}$ из $A^{n}$. Действительно, матрицы $X$ и $X^{'}$ будут приведенными:
$$ Im X = x_{11} A \times x_{22} A \times \cdot \cdot \cdot \times x_{rr} A \times 0 \cdot A \times \cdot \cdot \cdot \times 0 \cdot A \subset A^{n}, $$
$$ Im X^{'} = x_{11}^{'} A \times x_{22}^{'} A \times \cdot \cdot \cdot \times x_{rr}^{'} A \times 0 \cdot A \times \cdot \cdot \cdot \times 0 \cdot A \subset A^{n}, $$
В этих равенствах \textit{r} обозначается inf{n,m}, а число дополняющих нулей (т.е. 0) равно n — r. Кроме того, что \textit{L} представляет изоморфизм из $A^{n}$ на $A^{n}$, переводящий $Im X$ в $Im X^{'}$:
$$ Im X^{'} = L X R(A^{m}) = L X (A^{m}) = L(Im X). $$
Итак, следствие 23 дает нужный результат.\\
\end{myproof}
\begin{thm}[Теорема приведения]
\hspace*{0.5cm}
($i$) Существует алгоритм, который будучи применен к матрице X размеров $n \times m $ с целыми элементами, дает приведенную матрицу $X^{'}$,специально эквивалентную матрице $X$, т.е. обладающую свойством: существуют $ L \in S L_{n}(\mathbb{Z})$ и $R \in S L_{m}(\mathbb{Z})$ такие, что $X^{'} = L X R$.\\

($ii$) Результат остается верным и в кольце главных идеалов.
\end{thm}
Доказательство приводится в конце раздела. Алгоритм приведения матриц использует несколько под-алгоритмов, которые будут изложены сейчас в виде лемм. В описании этих алгоритмов используется следующее определение.

\begin{determ}
\hspace*{0.5cm}

\textit{В кольце A главных идеалов \textbf{длиной} элементов $a \in A$ (обозначается long(a)) называется длина разложения на простые элементы. Для ненулевого элемента a, если $a = p_1p_2 ... p_k, p_i$ - простые, не обязательно различные элементы, то long(a) = k. По соглашению длина 0 принимается равной $\infty$. Отсюда следует, что для двух элементов $a, b \in A - \{0\}:$}

$(i)~ long(a) = 0 \Longleftrightarrow a \in U(A),$

$(ii)~ long(ab) = long(a) + long(b),$

$(iii)~ a~|~b \Rightarrow long(a) \leqslant long(b), $

$(iv)~ a~|~b$ и $long(a) = long(b) ~~ \Rightarrow ~~ a = \epsilon b, ~~ \epsilon \in U(A). $
\end{determ}
\begin{lemma}[обнуление подстолбца]
\hspace*{0.5cm}

\textit{ Алгоритм 4, примененный к $n \times m$ - матрице X с целыми элементами и с парой $(i_0, j_0)$ индексов строки и столбца, строит матрицу $X^{'}$ той же природы, специально эквивалентную слева матрице X, такую, что $x^{'}_{ij_0} = 0$ для $i > i_0$. Кроме того, выполняются условия:}

\textit{($i$) если $x_{i_0j_0}$ делит каждое $x_{ij_0}$ для $i > i_0$ , то строка $i_0$ матрицы X неизменна ( $x^{'}_{i_0j}$ для $ 1 \leqslant j \leqslant m $),}

\textit{($ii$) если $x_{i_0j_0}$ не делит ни одно из $x_{ij_0}$ для $i > i_0$ , то $long(x^{'}_{i_0j}) < long(x_{i_0j_0})$.}
\end{lemma}

\begin{lstlisting}[mathescape=true]
	$X^{'} \in M_{nm} (\mathbb{Z}) ~~~ \textbf{Cancel\_Sub\_Column}(X \in M_{nm} ~ i_0 \leqslant n ~ j_0 \leqslant m) $ {
		$l_1(X^{'}), l_2(X^{'}), ..., l_n(X^{'}) \text{ обозначают строки матрицы } X^{'}$
		$X^{'} \leftarrow X $;
		for (i = $i_0$ + 1; i < n; ++i) {
			$ \text{Вычисление} \begin{pmatrix} \alpha~\beta \\ \gamma ~ \delta \end{pmatrix} \text{ удовлетворяющей условиям:}$
			$ \gamma x_{i_0j_0}^{'} + \beta x_{ij_0}^{'} = 0,~~~\alpha \beta - \beta \gamma = 1;$

			$ \text{Если } x_{i_0j_0}^{'} \text{ делит } x_{ij_0}^{'}, \text{ то } \beta = 0,~ \alpha = \delta = 1 $ 

			$\begin{pmatrix} l_{i_0}(X^{'}) \\ l_{i}(X^{'})\end{pmatrix}  \leftarrow \begin{pmatrix} \alpha l_{i_0}(X^{'}) + \beta  l_{i}(X^{'}) \\
			\gamma l_{i_0}(X^{'}) + \delta l_{i}(X^{'}) \end{pmatrix};$ 
		}
		return $ X^{'} $;
	}
\end{lstlisting}
\begin{algo}[\textit{Обнуление подстолбца}]
\end{algo}

Можно схематизировать алгоритм 4 следующим образом:

\[
\makebox[\displaywidth][l]{$
  \begin{pmatrix}
x_{11} & & x_{1j_0} & & x_{1m}\\
& & \vdots & & & &\\
x_{i_01} & \dots & x_{i_0j_0} & & x_{i_0m}\\
& & \vdots & &\vdots&\\
x_{n1} & & x_{nj_0} & & x_{nm}\\ 
\end{pmatrix} \xrightarrow{Cancel\_Sub\_Column} 
$}
\]

\[
\makebox[\displaywidth][r]{$
 \xrightarrow{Cancel\_Sub\_Column} \begin{pmatrix} 
x^{'}_{11} & & x^{'}_{1j_0} & & x^{'}_{1m}\\
& & \vdots & & & &\\
x^{'}_{i_01} & \dots & x^{'}_{i_0j_0} & & x^{'}_{i_0m}\\
& & \vdots & &\vdots&\\
x^{'}_{n1} & & 0 & & x^{'}_{nm}\\ 
\end{pmatrix} 
$}
\]
%\begin{myproof}
\textbf{\textit{Доказательство.}}

\begin{leftbar}
\begin{wrapfigure}{r}{0.3\linewidth} $\begin{pmatrix} x^{'}_{i_0j_0}\\ 0\\ \vdots \\0 \end{pmatrix} = L \begin{pmatrix} x_{i_0j_0}\\ {i_0+1 j_0}\\ \vdots \\x_{nj_0} \end{pmatrix} $\end{wrapfigure} 
Возьмем матрицу \textit{L} с определителем 1, удовлетворяющую равенству. Следовательно, $x^{'}_{i_0j_0}$ является наибольшим общим делителем 
$x_{i_0 j_0}$,~$ x_{i_{0+1} j_0}$, ... ,$ x_{n j_0}$. Если $x_{i_0j_0}$ делит  $x_{i j_0}$ для $i > i_0$, то строка $i_0$ матрицы $X^{'}$ не изменяема (по отношению к строке $i_0$ матрицы $X$), так как матрицы перехода имеют вид$\begin{pmatrix} 
1 & 0 \\ \gamma & 1 \end{pmatrix}_{i_0 i} $. Если $x_{i_0 j_0}$ не делит $x_{i j_0}$, то $x_{i_0 j_0}^{'}$ является \textbf{точным делителем} $x_{i_0 j_0}$: длина строго уменьшается.\\
\end{leftbar}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~$\blacksquare$
\begin{lemma}[обнуление подстроки]
\hspace*{0.5cm}

\textit{Алгоритм 5, аналогичный алгоритму 4, оперирует со строками вместо столбцов и, примененный к матрице $X$, дает матрицу $X^{'} = X R$, где $R \in S L_m (\mathbb{Z})$. Кроме того:}

\textit{($i$) если $x_{i_0 j_0}$ делит каждое $x_{i_0 j}$ для $j > j_0$, то столбец $j_0$ матрицы $X$ не изменится ($x_{i j_0}^{'} = x_{i j_0}$ для $1 \leqslant i \leqslant n$),}

\textit{($ii$) если $x_{i_0 j_0}$ не делит ни одно из $x_{i_0 j}$ для $j > j_0$, то
$long(x_{i_0 j_0}^{'}) < long(x_{i_0 j_0})$.}
\begin{lstlisting}[mathescape=true]
$X^{'}\in M_{nm}(\mathbb{Z})~\textbf{Cancel\_Sub\_Row\_And\_Sub\_Column}(X \in M_{nm}(\mathbb{Z}) i_0 \in [i, n] j_0 \in [1, m])$ 
{
	$X^{'} \leftarrow X $;	
	if (!($\text{подстолбец }X^{'}(i_0 + 1 .. n, j_0) \text{ нулевой})$) {
		$X^{'} \leftarrow Cancel\_Sub\_Row~(X^{'}, i_0, j_0)$;	
	}
	if (!($\text{подстрока }X^{'}(i_0, j_9 +1 .. m) \text{ нулевая})$) {
		$X^{'} \leftarrow Cancel\_Sub\_Column~(X^{'}, i_0, j_0)$;	
	}
	return $ X^{'} $;
}
\end{lstlisting}
\end{lemma}
\begin{algo}[Обнуление подстроки и подстолбца]
\end{algo}
\begin{lemma}[обнуление подстроки и подстолбца]
\hspace*{0.5cm}

\textit{Алгоритм 5, примененнный к $n \times m$- матрице $X$ с целыми элементами и с парой $(i_0, j_0)$ индексов строки и столбца, дает матрицу $X^{'}$, специально эквивалентную матрице $X$, такую , что $x_{i j_0}^{'} = x_{i_0 j}^{'} = 0 $ для $ i > i_0 $ и $ j > j_0$. Кроме того,}

\textit{($i$) если $x_{i_0 j_0}$ делит $x_{i j_0}$ и $x_{i_0 j}$ для $i > i_0$,
$j>j_0$, то $x_{i_0 j_0}^{'} = x_{i_0 j_0}$,}\\

\textit{($ii$) если $x_{i_0 j_0}$ не делит ни $x_{i j_0}$, ни $x_{i_0 j}$ для $i$ или $j$, удовлетворяющих неравенству $i > i_0$, $j > j_0$, то $long(x_{i_0 j_0}^{'}) < long(x_{i_0 j_0})$.}\\

\textit{Следующая схема иллюстрирует это преобразование:}
\[
\makebox[\displaywidth][l]{
$\begin{pmatrix} 
x_{11} & & x_{1j_0} & & x_{1m}\\
& & \vdots & & &\\
x_{i_01} &  & x_{i_0j_0} & \dots & x_{i_0m}\\
& &\vdots &\ddots &\vdots&\\
x_{n1} & & x_{nj_0} & \dots & x_{nm}\\ 
\end{pmatrix} \xrightarrow[And\_Sub\_Column] {Cancel\_Sub\_Row}
$}\]\[
\makebox[\displaywidth][r]{$
\xrightarrow[And\_Sub\_Column] {Cancel\_Sub\_Row}
 \begin{pmatrix} 
x_{11}^{'} & & x_{1j_0}^{'} & & & x_{1m}^{'}\\
& & \vdots & & & &\\
x_{i_01}^{'} &  & x_{i_0j_0}^{'} & 0 & & 0\\
& & 0 & x_{i_0+1,j_0+1}^{'} & & x_{i_0+1 m}^{'}\\
& & \vdots & \vdots & & \vdots \\
x_{n1}^{'} & & 0 & x_{n,j_0+1}^{'} & & x_{nm}^{'}\\ 
\end{pmatrix} 
$}
\]
\end{lemma}

\begin{myproof}
Цикл обнуляет подстроку $i_0$, затем подстолбец $j_0$, затем снова подстроку $i_0...$ Величина $long(x^{'}_{i_0j_0})$ не может строго уменьшаться до бесконечности. Итак, $x^{'}_{i_0j_0}$ делит все $x^{'}_{i_0j}$ (соответстветственно все $x^{'}_{ij_0}$) и, следовательно, подстолбец $j_0$ (соответственно подстрока $i_0$) не изменяется после извлечения информации из $Cancel\_Sub\_Row$ (соответственно из $Cancel\_Sub\_Column$), будучи обнуленным на предыдущем этапе извлечением информации из $Cancel\_Sub\_Column$. Итак, этот подстолбец (соответственно подстрока) ненулевой и цикл останавливается.

\noindent Анализ заканчивается аналогичными рассуждениями, что и в доказательстве леммы 45.\\
\end{myproof}
\begin{lemma}[приведение подстроки и подстолбца]
\hspace*{0.5cm}

\textit{Алгоритм 6, будучи применен к $n \times m$-матрице $X$ с целыми элементами и с парой $(i_0,j_0)$ индексов строки и столбца, дает матрицу $X^{0}$, специально эквивалентную матрице $X$, удовлетворяющую условию:}
$$ x^{'}_{ij_0} = x^{'}_{i_0j} = 0 \text{ для } i > i_0, j > j_0.$$
Кроме того, имеется отличие от алгоритма 5: $ x^{'}_{i_0j_0} $ делит все элементы подматрицы $(x^{'}_{ij})_{i>i_0,~j>j_0}.$
\end{lemma}
\begin{myproof}
Для начала нужно заметить, что преобразование
$$ l_{i_0}(X^{'}) \leftarrow l_{i_0}(X^{'}) + l_{i}(X^{'}) $$
эквивалентно умножению слева матрицы $X^{'}$ на элементарную матрицу. С другой стороны, это преобразование эквивалентно также действию \\ $x^{'}_{i_0 j} \leftarrow x^{'}_{i j}$ для $j = j_0 + 1, j_0 + 2$, ..., из этого следует, что подстрока \\ $X^{'}(i_0, j_0+1 .. m)$ нулевая. Итак, одно такое преобразование матрицы $X^{'}$ является преобразованием коэффициентов $ x^{'}_{ij}$ в позиции $(i_0, j)$, и в этом случае в результирующей матрице $ x^{'}_{i_0j_0} $ не делит ни одно $ x^{'}_{i_0j}$: применение \\ $Cancel\_Sub\_Row\_And\_Sub\_Column$ будет тогда строго уменьшать $long(x^{'}_{i_0j_0})$.

\noindent Конец доказательства аналогичен концу доказательства предыдущей леммы. В каждом проходе тела цикла, за исключением может быть первого раза, значение $long(x^{'}_{i_0j_0})$ строго уменьшается ... а в $\mathbb{N}$ не существует бесконечной строго убывающей последовательности.
\end{myproof}
Ниже показан конечный алгоритм приведения матриц, который позволит нам доказать теорему 43.\\
\begin{lstlisting}[mathescape=true]
$X^{'} \leftarrow X ; r \leftarrow \inf(n, m)$;
for (i = 1; i < r; ++i) {
	$X^{'} \leftarrow ~\text{Reduce\_Sub\_Row\_And\_Sub\_Column}(X^{'}, i, j)$;
}
\end{lstlisting}
\newpage
\noindent\textbf{\textit{Доказательство теоремы 43}}\\

Ясно, что в результирующей матрице недиагональные элементы нулевые. Чтобы убедиться в отношении делимости, предположим, что имеется $n \times m$-матрица вида $ X = \begin{pmatrix} 
x_{11} & 0 \\ 0 & Y \end{pmatrix}$ элемент которой $x_{11}$ делит все элементы матрицы $Y$, и что матрица $Y$ приводится к матрице $Y^{'}$. Тогда матрица  $ X^{'} = \begin{pmatrix} x_{11} && 0\\ 0 && Y^{'} \end{pmatrix}$ эквивалентна матрице $X$ и $x_{11}$ делит все элементы матрицы $Y^{'}$. Действительно, достаточно заметить, что когда элемент делит все элементы  матрицы $Y$, он делит также все элементы любой матрицы $L Y R$, так как эти последние элементы являются линейными комбинациями первых.\\

\noindent\textbf{\textit{Пример приведения целочисленной матрицы}}\\

Покажем здесь все этапы приведения $3 \times 4$-матрицы. В этом процессе\\

\begin{lstlisting}[mathescape=true]
$X^{'} \in M_{nm}(\mathbb{Z})~\textbf{Reduce\_Sub\_Row\_And\_Sub\_Column}(X \in M_{nm}(\mathbb{Z}) i_0 \in [i, n] j_0 \in [1, m])$ 
{
	$l_1(X^{'}), l_2(X^{'}),..., l_n(X^{'}) \text{ обозначают строки матрицы } X^{'}$
	$X^{'} \leftarrow X $;	
	while(true) {
		$X^{'} \leftarrow \text{Reduce\_Sub\_Row\_And\_Sub\_Column}(X^{'}, i_0, j_0)$;
		if ($x^{'}_{i_0j_0} \text{ делит подматрицу } X^{'}_{i_0 .. n, j_0 .. m}$) {
			break;
		}
		$\text{Выбрать } i > i_0 \text{ так, чтобы подстрока } X^{'}(i, j_0 .. m)$
		$\text{ содержала элемент, не делимый на} x^{'}_{i_0j_0}$;
		$l_{i_0}(X^{'}) \leftarrow l_{i_0}(X^{'}) + l_{i}(X^{'})$;
	}
	return $ X^{'} $;
}
\end{lstlisting}

\begin{algo}[Приведение подстроки и подстолбца]
\end{algo}
\noindent приведения мы представим только те матрицы, в которых элемент только что обнулился. Начальная матрица — это матрица $X$:
$$\begin{pmatrix} 
6 & 8 & 4 & 20 \\
12 & 12 & 18 & 30 \\ 
18 & 4 & 4 & 10 \\ \end{pmatrix},  
\begin{pmatrix} 
2 & \underline{0} & 4 & 20 \\
0 & -12 & 18 & 30 \\ 
-14 & -60 & 4 & 10 \\ \end{pmatrix},
\begin{pmatrix} 
2 & 0 & \underline{0} & 20 \\
0 & -12 & 18 & 30 \\ 
-14 & -60 & 32 & 10 \\ \end{pmatrix},$$
$$\begin{pmatrix} 
2 & 0 & 0 & \underline{0} \\
0 & -12 & 18 & 30 \\ 
-14 & -60 & 32 & 150 \\ \end{pmatrix},  
\begin{pmatrix} 
2 & 0 & 0 & 0 \\
0 & -12 & 18 & 30 \\ 
\underline{0} & -60 & 32 & 150 \\ \end{pmatrix},
\begin{pmatrix} 
2 & 0 & 0 & 0 \\
0 & 6 & \underline{0} & 30 \\ 
0 & -28 & 116 & 150 \\ \end{pmatrix},$$
$$\begin{pmatrix} 
2 & 0 & 0 & 0 \\
0 & 6 & 0 & \underline{0} \\ 
0 & -28 & 116 & 290 \\ \end{pmatrix},  
\begin{pmatrix} 
2 & 0 & 0 & 0 \\
0 & -2 & -116 & -290 \\ 
0 & \underline{0} & -348 & -870 \\ \end{pmatrix},
\begin{pmatrix} 
2 & 0 & 0 & 0 \\
0 & -2 & \underline{0} & -290 \\ 
0 & 0 & -348 & -870\\ \end{pmatrix},$$
$$\begin{pmatrix} 
2 & 0 & 0 & 0 \\
0 & -2 & 0 & \underline{0} \\ 
0 & 0 & -348 & -870 \\ \end{pmatrix},  
\begin{pmatrix} 
2 & 0 & 0 & 0 \\
0 & -2 & 0 & 0 \\ 
0 & 0 & -174 & \underline{0}\\ \end{pmatrix}.$$

\noindent Вот левая \textit{(L)} и правая \textit{(R)} матрицы перехода:\\\\
$~~~~~~~ L = \begin{pmatrix} 
1 & 0 & 0 \\
-7 & -5 & -1 \\ 
-21 & -14 & -3 \\ \end{pmatrix} $
и  
$ R = \begin{pmatrix} 
-1 & -2 & 62 & 0 \\
1 & 1 & -34 & -5 \\ 
0 & 1 & -30 & 0 \\ 
0 & 0 & 1 & 2 \\
\end{pmatrix}.$
\\


Доказательство следующего следствия мы оставляем читателю (можно дать элементарное доказательство, используя упражнение 8). \\
\begin{sled}
\hspace*{0.5cm}
\textit{Линейное отображение u: $ \mathbb{Z}^{n} \rightarrow \mathbb{Z}^{n} $ инъективно тогда и только тогда, когда $ \det~u \ne 0$, или еще тогда и только тогда, когда факторгруппа
$ \mathbb{Z}^{n} ~/~ \Im~u $ конечна, и (в этом случае) $ \card~ \mathbb{Z}^{n} ~/~ \Im~u = |\det~u|.$} \end{sled}

\section{Модули конечного типа над кольцом главных идеалов}

В этом разделе мы снова вернемся к некоторым естественным результатам предыдущего раздела. Будет рассмотрена более абстрактная точка зрения, и алгоритмические результаты всех предыдущих разделов относящихся к векторам из $A^{n}$ или матрицам из $M_{n m}(A)$, будут теперь переформулированы в случае модулей над кольцом главных идеалов.

Для поля $K$ хорошо известно, что класс изоморфизмов векторного пространства (конечного типа) характеризуется целым числом (его размерностью). Два векторных $K$-пространства изоморфны тогда и только тогда, когда они имеют одинаковую размерность. Для кольца главных идеалов классификация модулей конечного типа немного сложнее. Мы покажем, что класс изоморфизмов модуля $M$ конечного типа характеризуется конечной последовательностью элементов $a_1, a_2, ...a_m$, в которой $a_i$ делит $a_{i+1}; a_i$, равные 1, определяют свободную компоненту модуля $M$ (изоморфную $A^{n}$) и другие компоненты кручения $M$. Последовательность $a_1, a_2, ...a_m$, которая полностью определяет структуру $M$. Способ получения этой классификации состоит в описании $M$ в виде $E~/~M$, где $E$ — свободный модуль конечного ранга. Итак, это приводит нас к изучению классификации пар $(E,F)$ (две пары $(E,F)$ и $(E^{'},F^{'})$) изоморфны, если существует изоморфизм из $E$ на $E^{'}$, который преобразует $F в F^{'}$) и понятию множителей $F$, инвариантных \textit{относительно E.}

\subsection{Дополнение, свобода и кручение}

\noindent Подмодуль $N$ модуля $M$ не обязан иметь дополнение в $M$. Например, $2\mathbb{Z}$ не имеет дополнения в $\mathbb{Z}$. Приведем без доказательства несколько соотношений между прямыми суммами и проекциями.\\

\begin{lemma}
\hspace*{0.5cm}

\textit{($i$) Пусть $N \oplus N^{'}$ — разложения модуля M в прямую сумму. Тогда проекция $\pi_N$ и $\pi_{N^{'}}$ на N и $N^{'}$ соответственно, рассматриваемые как эндорфизмы M, удовлетворяют соотношениям:}
$$\pi^{2}_{N} = \pi_{N},~~~~ \pi^{2}_{N^{'}} = \pi_{N^{'}},
~~~~\pi_{N} + \pi_{N^{'}} = Id_m,~~~~  \pi_{N} \circ \pi_{N^{'}} = \pi_{N^{'}} \circ \pi_{N} = 0. $$

($ii$) И обратно, пусть $\pi$ — проекция на M, т.е. эндоморфизм M, удовлетворяющий условию $\pi^{2} = \pi$. Тогда разложение $x = \pi(x) + x - \pi(x)$ $ x \in M$, дает разложение в прямую сумму: $M = Im \pi \oplus \Ker ~\pi$. Кроме того, $Id_m - \pi$ также проекция, и верны равенства:
$$ \pi \circ (Id_{M} -\pi) = (Id_{M} -\pi) \circ \pi = 0, $$
$$ Im~\pi = \Ker(Id_{M} -\pi), (Id_{M} -\pi) = \Ker~ \pi $$
\end{lemma}
\begin{lemma}[существование дополнения]
\hspace*{0.5cm}

\textit{($i$) Подмодуль N является прямым слагаемым в M тогда и только тогда, когда существует линейное отображение $r: M \rightarrow N$ такое, что $r(x) = x$ для всех $x \in N$. Любое дополнение для N в M изоморфно $M~/~N$.}

\textit{($ii$) Если $\pi: M \rightarrow P$ — линейное \textbf{сюръективное} отображение, то $\Ker~\pi$ является прямым слагаемы в M тогда и только тогда, когда $\pi$ имеет сечение $\sigma$, т.е. существует линейное отображение $\sigma: P \rightarrow M$, удовлетворяющее условию $\pi \circ \sigma = Id_P$. В этом случае $Im~ \sigma$ является дополнением для $\Ker~\pi$.}\\
\end{lemma}

\newpage

\begin{myproof}
Если $N$ — прямое слагаемое в $M$, проекция из $M$ на $N$ относительно разложения $M = N \circ N^{'}$ является линейным отображением $r$, которое и отвечает на наш вопрос. Обратно, если $r$ удовлетворяет условию леммы, то $M = N \circ \Ker~r$. Действительно, для $x \in M$ можно написать:
$$x = x_1 + x_2, x_1= r(x), x2 = x - r(x),$$
где $x_1 \in N, x_2 \in \Ker~r$. Кроме того, $N \cap \Ker~r = 0$, в чем легко убедиться. Речь идет о разложении, встречающемся в предыдущей лемме, примененной к проекции $r$ — образу $N$.

\noindent Пункт $(ii)$ является только переформулировкой пункта предыдущей леммы.
\end{myproof}

\begin{sled}
\hspace*{0.5cm}
\textit{Пусть P — свободный модуль, а $\pi$ — линейное сюръективное отображение из M на P. Тогда $\Ker~\pi$ является прямым слагаемым в M, и любое дополнение $\Ker~\pi$ изоморфно P и, следовательно, свободно.}
\end{sled}
\begin{myproof}
Пусть ($e_i$) — базис $P$, $x_i$ — элементы $M$ такие, что
$\pi(x_i) = e_i$. Тогда отображение $\sigma$ из $P$ в $M$, определенное равенством $\sigma(e_i) = x_i$, является сечением $\pi$. Это доказывает, что $ \Ker~\pi$ - прямое слагаемое в $M$, из дополнения $\bigoplus Ax_i$.\\
\end{myproof}
\begin{determ}
\hspace*{0.5cm}
\textit{($i$) Пусть дан модуль M над кольцом без делителей нуля A. Определим подмодуль кручения tors(M) модуля M равенством:}
\begin{center}
tors\textit{(M) = \{x $\in$ M | $\exists a \in$ $A -\{0\}$  такое, что  $ax = 0$}. \}
\end{center}

\noindent\textit{То, что tors(M) будет подмодулем M, следует из условия на кольцо A (без делителей нуля).}

\textit{ ($ii$) Модуль M называется \textbf{модулем без кручения}, если tors(M) = 0. Другими словами, если}
\begin{center}
\textit{для $a \in A$ и $x \in M$ имеем: $ax = 0 \Rightarrow a = 0$ или $ x = 0$.}
\end{center}

\textit{ ($iii$) Модуль M называется \textbf{периодическим}, если tors(M) = M. Или:}
\begin{center}
$\forall x \in M, \exists a~ \in~ A - \{0\}$ такое, что $ax = 0$
\end{center}

\textit{ ($iv$) Пусть дан подмодуль N модуля M. \textbf{Замыканием} N в M называется подмодуль $\overline{N}$ из M, определенный равенством:}
\begin{center}
$\overline{N}$ $=$ {$x \in M | \exists a \in A - {0}$ такое, что $ax \in N$}.
\end{center}

\textit{Этот подмодуль, очевидно, содержит N. Действительно, 
$\overline{N}$ — единственный подмодуль M, содержащий N и удовлетворяющий условию\\ $ \overline{N}~/~N = tors(M~/~N)$.}
\end{determ}
\noindent\textbf{Примеры}

Абелева группа $\Omega$ может рассматриваться как $\mathbb{Z}$-модуль. Его периодическая подгруппа является тогда подгруппой в $\Omega$, состоящей из элементов \textit{конечного порядка}. В частности, любая абелева конечная группа — это периодическая группа.

Пусть $\Omega = \mathbb{R~/~Z}$ — аддитивная группа действительных чисел по \\ модулю 1. Ее подгруппа кручения является группой $\mathbb{Q~/~Z}$ рациональных чисел по модулю 1.
Пусть $u$ — эндоморфизм векторного пространства $E$ конечной размерности над полем $K$. Пространство $E$ тогда будет оснащено структурой $K[X]$-модуля, обозначаемого $E_u$, чтобы отличить его от векторного пространства $E$, и будет определено равенством:
\begin{center}
 $P(X) \cdot x = P(u)(x)$ для $P(X) \in K[X]$ и $x \in E$
\end{center}

\noindent $K[X]$-модуль $E_u$ является тогда периодическим модулем, как это показывает теорема Гамильтона — Кэли: если 
$P_u(X) = \det(XId_E - u)$, то $P_u(u) = 0$, т.е. $P_u \cdot E_u = 0$.

\begin{predl}

\textit{Пусть E — подмодуль свободного модуля L над кольцом A главных идеалов.}

\textit{ ($i$) Подмодуль E является прямым слагаемым в L тогда и только тогда, когда модуль $L~/~E$ свободен.}

\textit{ ($ii$) Если к тому же предположить, что L \textbf{конечного типа}, то \\ E — прямое слагаемое в L тогда и только тогда, когда $L~/~E$ — модуль без кручения.}\\
\end{predl}
\begin{myproof}
Если $L = E \oplus E^{'}$, то $L~/~E$ изоморфно подмодулю $E$ модуля $L$. Однако $E^{'}$ — подмодуль \textit{свободного} модуля $L$ над кольцом главных идеалов. Следовательно, он свободен \textit{без каких-либо дополнительных предположений конечности.}

\noindent Обратно предположим, что $L~/~E$ свободен и пусть $ \pi : L \rightarrow L~/~E$ - каноническая сюръекция. Следствие 52 дает нам ответ, и $\bigoplus_{i \in I} Ax_i $ — дополнение $E$. Это завершает доказательство пункта ($i$).

\noindent Если $L$ конечного типа, то фактормодуль $L~/~E$ также конечного типа. В этом случае имеется эквивалентность между свободным модулем $L~/~E$ и модулем без кручения $L~/~E$ (предложение 9), что доказывает пункт ($ii$).

Приведем результат, следующий из предложения 54, о том, что для модуля $M$ фактормодуль $M~/~tors(M)$ будет модулем без кручения.
\end{myproof}

\begin{predl}
\hspace*{0.5cm}

\textit{
Пусть M — A-модуль \textbf{конечного типа} над кольцом главных идеалов A, а $tors(M)$ — его подмодуль кручения. Тогда $M~/~tors(M)$ — свободный модуль и $tors(M)$ — прямое слагаемое в M, изоморфное $M~/~tors(M)$, свободно. }
\end{predl}
\subsection{Инвариантные множители подмодуля свободного модуля}
\noindent В разделе 2.2 мы привели алгоритм, позволяющий преобразовать с помощью автоморфизма в $A^n$ подмодуль $b_1A \times b_2A \times ... \times b_nA$ из $A^n$ в подмолуль $a_1A \times a_2A \times ... \times a_nA$, где $a_1~|~a_2, a_2~|~a_3, ..., a_{n-1}~|~ a_n$. В этом разделе мы покажем, что любой подмодуль может быть представлен в таком виде.
\begin{determ}
\hspace*{0.5cm}

\textit{($i$) Подмодуль E модуля $A^n$ называется \textbf{эквивалентным} подмодулю F модуля $A^m$, если существует изоморфизм $\phi : A^{n} \rightarrow A^{m}$, переводящий E в F, что влечет необходимое условие n = m.}

\textit{($ii$) Подмодуль E из $A^{n}$ называется нормализованным, если он имеет вид:}
\begin{center}
 $E = a_1A \times a_2A \times ... \times a_nA$, где  $a_1~|~a_2, a_2~|~a_3, ..., a_{n-1}~|~ a_n$.
\end{center}
\end{determ}
\begin{thm}[Положение подмодуля в свободном модуле]
\hspace*{0.5cm}
\textit{Любой подмодуль E из $A^n$ эквивалентен \textbf{единственному нормализованному} подмодулю $a_1A \times a_2A \times ... \times a_nA$. Если rang(E) = m, то $a_i = 0$ для $i > m$. } 
\end{thm}
\begin{myproof}
Подмодуль $E$ имеет базис из $m$ элементов, где $m \leqslant n$ (раздел 3.2, следствие 28). Пусть $X$ — $n \times m$-матрица, удовлетворяющая условию $Im~X = E$. Алгоритм приведения из теоремы 43 дает две обратимые матрицы $L$ и $R$ такие, что матрица $L X R$ будет приведенной. Если $X^{'} = L X R$, то подмодуль $Im~X^{'}$ является нормализованным подмодулем 
$a_1A \times a_2A \times ... \times a_nA$, где:
\begin{center}
 $a_i = x^{'}_{ii}$ для $1 \leqslant i \leqslant m$  и $a_i = 0$ для $ m < i \leqslant n$. 
\end{center}
\noindent Так как $L(Im~X) = Im~X^{'}$, то $L$ влечет изоморфизм в $A^{n}$, преобразующий подмодуль $E$ в нормализованный подмодуль. Единственность подмодуля (нормализованного) следует из следствия 23 раздела 2.3.
\end{myproof}
\noindent Приведем другую эквивалентную формулировку.
\begin{predl}[положение подмодуля в свободном модуле]
\hspace*{0.5cm}

\textit{Пусть E — подмодуль ранга m свободного модуля L ранга n над кольцом главных идеалов A. Тогда существует базис $\{f_1, f_2, ..., f_n\}$ в $L$ и \textbf{ненулевые} коэффициенты $a_1, a_2, ..., a_m$ такие, что:}
\begin{center}
$\{a_i~f_i\}_{1 \leqslant i \leqslant m}$ будет базисом $E$ и $a_1~|~a_2~|~a_3~|~...~|~a_{m-1}~|~ a_m$.
\end{center}
\noindent \textit{Коэффициенты $a_i$ единственны с точностью до обратимости. Такой базис будет называться \textbf{адаптированным} в модуле E.}
\end{predl}
Этот последний результат может быть доказан прямо, конструктивным способом.

\begin{determ}
\hspace*{0.5cm}

\textit{ Пусть L — свободный модуль над кольцом главных идеалов A. Для $x \in L$ определим идеал в A:}
$$ c(x) = \{\varphi(x)~|~\varphi \in L^{*} = Hom_{A} (L, A)\}$$,
\noindent \textit{ называемый \textbf{содержанием} $x$ в $L$. Говорят, что элемент $c_x$ порождает идеал $c(x)$. Говорят также, что $c_x$ — содержание $x$ в $A$ равносильно тому, что существует $\varphi \in L^{*}$, удовлетворяющее равенству $ \varphi(x) = c_x$, и для любого $\psi \in L^{*}$ элемент $c_x$  делит $\psi (x)$.}

\textit{Например, если $x = (12, 15, 18) \in \mathbb{Z}^{3}$, то:}
\begin{center}
$c(x) = \{12u + 15v + 18w,~,u,v,w \in \mathbb{Z}\} = $\text{ НОД}$(12, 15, 18) \mathbb{Z} = 3\mathbb{Z}.$
\end{center}

Вообще, легко показать, что наибольший общий делитель координат $x$ в произвольном базисе является содержанием $x$.
\end{determ}
\begin{lemma}

\hspace*{0.5cm}

\textit{Пусть L — свободный модуль над кольцом главных идеалов. Следующие четыре утверждения эквивалентны.}

\textit{$(i)$ Содержание $x$ в $L$ совпадает с A}.

\textit{$(ii)$ Существует линейная форма $ \varphi \in L^{*}$, удовлетворяющая ревенству $\varphi(x) = 1.$}

\textit{$(iii)$ $x$ — не нуль, и $A_x$ — прямое слагаемое (имеет дополнение) в $L$.}

\textit{$(iv)$ $x$ — часть базиса в L.}\\
\end{lemma}
\begin{myproof}
Докажем импликацию $(ii) \Rightarrow (iii)$, используя равенство
$$ L = Ax \oplus \Ker~\varphi$$ Если $y \in Ax \cap \Ker~\varphi$, то $y= \lambda x$ и $\varphi(y) = \lambda \varphi(x)$. Это влечет равенство $ \lambda = 0$, затем $y = 0$. Чтобы разложить $ y \in L$ в $Ax + \Ker~ \varphi$, представляют $y$ в виде $y = \lambda x + (y - \lambda x)$; и условие $\varphi(y - \lambda x) = 0$ влечет соотношение $\lambda = \varphi(y)$.

\noindent Чтобы доказать импликацию $(iii) \Rightarrow (iv)$, достаточно представить $L$ в виде $L = Ax \oplus L^{'}$ и рассмотреть базис $B^{'}$ в $L^{'}$ и дополнить его до базиса $\{x\} \cup B^{'}$ в $L$.

\noindent Наконец, чтобы доказать импликацию $(iv) \Rightarrow (ii)$, достаточно рассмотреть базис $L$, содержащий $x$ и координатную форму на $x$ и координатную форму на $x$. Эта форма будет линейной формой $\varphi$, которая отвечает пункту $(ii)$.
\end{myproof}
\begin{determ}
\hspace*{0.5cm}

\textit{Если $x \in L$ — ненулевой вектор, и если $c_x$ — содержание $x$, то существует один и только один вектор $y$ такой, что $c_xy = x$ (рассматривается базис $L$). Этот элемент, содержание которого равно 1, обозначается $x~/~ c_x$.}
\end{determ}
\begin{lemma}
\hspace*{0.5cm}

\textit{Пусть L — свободный модуль над кольцом главных идеалов A, E — ненулевой подмодуль L. Пусть $x \in E$ выбрано таким образом, чтобы $c(x)$ был максимальным \textbf{среди содержаний} E; $c_x$ — содержание $x$ в $L$ и $\varphi \in L^{*}$ такие, что $\varphi(x) = c_x.$ Тогда верны следующие свойства:\\}

\textit{($i$) $L = Ax~/~c_x \oplus \Ker~\varphi,$}

\textit{($ii$) $E = Ax \oplus (\Ker~\varphi \cup E),$}

\textit{($iii$) $\psi(E) \subset Ac_x$ для всех $\psi \in L^{*}$.\\\\\\}
\end{lemma}
\begin{myproof}
\noindent Пункт ($i$) следует из того, что $\varphi(x~/~c_x) = 1$, и из доказательства предыдущей леммы.

\noindent Покажем теперь, что $\varphi(E) \subset Ac_x$. Действительно, $Ac_x + \varphi(E)$ является идеалом в $A$ и, следовательно, имеет вид $Ad$. Элемент $d$ описывается равенством $\lambda c_x + \varphi(y) = \varphi(\lambda x + y)$, где $ \lambda \in A$ и $ y \in E $. Откуда:\\
$$ c(x) = Ac_x \subset Ac_x + \varphi(E) = Ad \subset c(\lambda x + y).$$

\noindent\\\\\\ Максимальность $c(x)$ влечет равенство $c(x) = c(\lambda x +y)$ и, следовательно, $ \varphi(E) \subset Ac_x$. Это включение доказывает, что $c(x)$ делит $\phi(y)$, и позволяет представить $y$ в виде:
$$ y = (\varphi(y)~/~c_x)x + y - (\varphi(y)~/~ c_x)x. $$

\noindent Это равенство доказывает, что сумма $(ii)$ прямая

\noindent Докажем последний пункт $(iii)$. Имеем:

$$ \psi(E) = A \psi(x) + \psi(\Ker~\varphi \cap E) \subset c(x) + \psi(\Ker~\varphi E) = Ad $$

\noindent Можно представить $d$ в виде $d = \lambda c_x + \psi(y)$, где $ y \in \Ker~\varphi \cap E$. Если $p: L \rightarrow \Ker~\phi$ обозначает проекцию в разложении $L = Ax ~/~ c_x \oplus \Ker~\phi$,
то $p(x) = 0$ и $p(y) = y$, и, как следствие,
$$ d = (\omega \circ p + \phi) (\lambda x + y). $$

\noindent Это равенство доказывает, что $d \in c(\lambda x + y)$. Используя (5), получают $c(x) \subset c(\lambda x + y)$. Максимальность $c(x)$ влечет $Ac_x = Ac_x + \psi(\Ker~ \varphi \cap E) \subset Ac_x.$ Вместе с (5) это последнее включение влечет $\psi(E) \subset Ac_x$, что доказывает пункт $(iii)$.
\end{myproof}
\noindent\textbf{Другое доказательство предложения 58}\\

Предложение 58 можно также доказать с помощью индукции по $n = rang~L$. Можно предположить, что $E \ne 0$. Применим предыдущую лемму к $L$ и $E$, полагая $a_1 = c_x, e_1 = x ~/~ с_x$ и $ L_1 = \Ker~\varphi$. Тогда:
$$ L = Ae_1 \oplus L_1,~~~ E = Aa_1e_1 \oplus (L_1 \cap E).$$

\noindent Так как $rang~L_1 = n -1$, то можно применить предположение индукции к паре ($L_1, L_1 \cap E$). Тогда существует базис $e_2, ....,e_n$ в $L_1$ и ненулевые скаляры  $a_2, ....,a_m$ такие, что $a_i$ делит $a_{i+1}$ и $a_2e_2,..., a_m e_m$ будет базисом $L_1 \cap E$. Из равенства, приведенного выше, следует, что $a_1 e_1, a_2 e_2, ..., a_m e_m$ — базис $E$; $e_1, e_2, ..., e_n$ — базис $L$. Остается доказать, что $a_1$ делит $a_2$. Пусть $\psi$ координатная форма на $e_2$; в силу пункта $(iii)$ предыдущей леммы $\psi(E) \subset Aa_1$, в частности, $\psi(a_2 e_2) = a_2 \in Aa_1$, что и требовалось доказать.

\begin{determ}
\hspace*{0.5cm}

\textit{Используя те же обозначения, что и в предложении 58, коэффициенты $(a_i)_{1 \leqslant\ i \leqslant m}$, или, скорее, идеалы $Aa_i$, которые определяются по коэффициентам единственным образом, называют \textbf{инвариантными множителями} подмодуля $E$ по отношению к свободному $L$.}\\
\begin{mynotice}
Инвариантные множители $E$ в $L$ зависят от модуля $L$, в котором содержится $E$. Пусть, например, $E = 4 \mathbb{Z}, L_1 = 2 \mathbb{Z}$ и $L_2 = \mathbb{Z}$, тогда $E \subset L_1 \subset L_2$. Следовательно, $E$ в $L_2$ имеет своим 
неприводимым множителем число 4 или идеал $(4)$, тогда как $E$ в $L_1$ имеет своим неприводимым множителем число 2 или идеал $(2)$.\\
\end{mynotice}

Следующее предложение дает формулы, связывающие  
инвариантные множители $E$ в $L$ с минорами матрицы, столбцы которой  порождают  $E$. Эти формулы позволяют вычислить инвариантные  множители. Эти вычисления реализованы в случае, когда ранг $L$ мал, но они предпочтительны во всех случаях технического приложения раздела 4. 
\end{determ}
\begin{predl}
\hspace*{0.5cm}

\textit{Пусть $a_1, a_2, ..., a_m$ — инвариантные множители подмодуля $E$ ранга $m$ свободного модуля $L$. Определим через
$\Lambda_q (L)$ $A$-модуль $q$-линейных знакопеременных форм на $L$ и через $\Phi _q (L, E)$ идеал, порожденный следующим образом:}
$$ \psi (x_1, x_2, ..., x_q), \psi \in \Lambda _q (L), (x_1, x_2, ... x_q) \in E^{q}.$$

\textit{($i$) Тогда для $ 1 \leqslant q \leqslant m$ идеал $\Phi _q (L, E)$ порождается элементами $a_1a_2 ...a_q$.}\\

\textit{($ii$) Кроме того, если рассмотреть матрицу произвольной системы образующих в $Е$ над произвольным базисом из $L$, то $\Phi _q (L, E)$ порождается $q \times q$- порождается минорами этой матрицы (т.е. НОД миноров), и, следовательно, $a_1 a_2 ...a_q$ являются наибольшим общим делителем $q \times q$- миноров матрицы образующих в $E$.}
\end{predl}
\begin{myproof}
Покажем сначала, что $\Phi _q (L, E) \subset (a_1 a_2 ... a_q)$. Любой элемент $ x \in E$ можно представить в иде $x = \xi _1 a_1 f_1 + \xi _2 a_2 f_2 + ... + \xi _m a_m f_m$, где $\{f_1, f_2, ..., f_n\}$ — базис $L$, адаптированный в $E$. Термы, которые встречаются в разложении формы $\psi (x_1, x_2, ... x_q)$ имеют вид:
\begin{center}
$\xi a_{i_1}, a_{i_2} ... a_{i_q}$ $ \psi (f_{i_1}, f_{i_2}, ...,f_{i_q})$,
где $1 \leqslant i_1 < i_2 < ... < i_q \leqslant n$ и $\xi \in A$;
\end{center}
и все они кратны $a_1 a_2 ... a_q$ в силу делимости на $a_i$.\\
\noindent Покажем, что $a_1 a_2 ... a_q$ принадлежит $\Phi _q (L, E).$ Рассмотрим на $L$ относительные координатные формы $(\pi _i)_{1 \leqslant i \leqslant n}$ в базисе $\{f_1, f_2, ..., f_n \}$. Тогда форма $\psi$ определяется равенством:
$$ \psi (x_1, x_2, ..., x_q) = \det(\pi _i (x_j)).$$
\noindent  и является линейной знакопеременной $q$-формой на $L$ такой, что:
$$\psi (a_1 f_1, a_2 f_2, ..., a_q f_q) = a_1 a_2 ... a_q \psi (f_1, f_2, ..., f_q) = a_1 a_2 ... a_q.$$

\noindent Отсюда следует нужный нам результат.

\noindent Второй пункт вытекает из следующей более общей леммы.
\end{myproof}
\begin{lemma}
\hspace*{0.5cm}

\textit{Пусть $A$ — произвольное коммутативное кольцо. Обозначим через $\{e_1, e_2, ..., e_n\}$ канонический базис $A$-модуля $A^{n}$. Если $\{s_1, s_2, ..., s_p\}$ — система образующих подмодуля $E$ модуля $A^{n}$, то идеал $\Phi _q (A^{n}, E)$, определенный как и в предыдущем предложении, является идеалом, порожденным $q \times q$- минорами системы  $\{s_1, s_2, ..., s_p\}$ в базисе $\{e_1, e_2, ..., e_n\}$.}
\end{lemma}
\begin{myproof}
В действительности здесь речь пойдет о внешнем вычислении. Разложим каждый элемент $s_j$ данной системы образующих в каноническом базисе: $s_j = \sum^{n}_{i=1} s_{ij} e_i$. Пусть $\psi \in \Lambda _q (E)$. Если $1 \leqslant j_1 < j_2 < ... < j_q \leqslant p$, то 
\begin{center} $\psi (s_{j_1}, s_{j_2}, ..., s_{j_q}) $= $\sum_{1 \leqslant i_1 < i_2 < ... < i_q \leqslant n}$ $ \pm $ $ \text{ Минор }_{IJ} \psi (e_{i_1}, e_{i_2},..., e_{i_q}). $\end{center} 

\noindent В этом выражении $I$ и $J$ обозначают последовательности индексов, а Минор$_{IJ}$ обозначает минор, соответствующий индексам строк или столбцов, образованных $I$ и $J$, соответственно. Если $x_1, x_2 ..., x_q$ — семейство $q$ элементов из $E$, то $ \psi (x_1, x_2, ..., x_q)$ является линейной комбинацией слагаемых формы $\psi (s_{j_1}, s_{j_2},..., s_{j_q})$. А равенство выше доказывает, что $ \psi (x_1, x_2, ..., x_q)$ принадлежит идеалу, порожденному $q \times q$-минорами. Отсюда следует, что $\Phi(A^{n}, E)_q$ содержится в идеале, порожденном этими минорами.

\noindent Обратно, рассмотрим $q \times q$-минор Минор$_{IJ}$, определенный возрастающими последовательностями индексов $I$ и $J$. Тогда форма $ \psi (x_1, x_2, ..., x_q) = \det(\pi _i (x_j))_{i \in I}$, где $\pi _i$ — проекция на $i$-ую компоненту, и является $q$-линейной знакопеременной формой, удовлетворяющей условию:
\begin{center} $ \psi (s_{j_1}, s_{j_2},..., s_{j_q})=$ Минор $_{IJ}.$\end{center}

\noindent Это доказывает, что минор принадлежит идеалу $\Phi(A^{n}, L)_q$
\end{myproof}
\noindent Базис $\{f_1, f_2,...f_n\}$ в $L$, встречающийся в предложении 58 не единствен. Однако подмодуль, порожденный $m$ первыми векторами $f_i$, единствен, как показывает следующее предложение.
\begin{predl}
\hspace*{0.5cm}

\textit{Пусть $A$ — кольцо главных идеалов, $E$ — подмодуль ранга $m$ свободного модуля $L$ ранга $n$, имеющего инвариантными множителями $a_1, a_2,...,a_m$. Если $\{f_1, f_2, ..., f_n\}$ — базис $L$, адаптированный к $E$, т.е. $E = \bigoplus ^{m} _{i=1} A a_i f_i$, то: }

\textit{ ($i$) Семейство $f_1, f_2, ...,f_m$ — базис модуля $\overline{E}$, замыкания $E$. В частности, $\overline{E}$ является прямым слагаемым в $L$, а $L~/~\overline{E}$ свободен:}
\begin{center} $ L = \overline{E} \oplus Af_{m+1} \oplus Af_{m+2} \oplus ... \oplus Af_{n}$ и $L~/~\overline{E} \simeq Af_{m+1} \oplus Af_{m+2} \oplus ... \oplus Af_{n}.$ \end{center}

\textit{ ($ii$) фактормодуль $\overline{E} ~/~ E$ является периодическим модулем конечного типа, и существует изоморфизм:}

$$ \overline{E} ~/~ E \simeq A ~/~ (a_1) \times A ~/~ (a_2) \times ... \times A ~/~ (a_m).$$

\noindent \textit{ В этом выражении некоторые $A ~/~ (a_1)$ могут быть тривиальными, если $a_i$ обратимы.}

\textit{ ($iii$) Существует изоморфизм модулей $L~/~E \simeq \overline{E} ~/~ E \oplus L ~/~ \overline{E}$, который можно схематизировать, говоря, что периодический модуль $ \overline{E} ~/~ E$ имеет всегда кручение фактормодуля $L~/~ \overline{E}$ и свободу свободного модуля $L~/~ \overline{E}$.\\\\\\\\}
\end{predl}
\begin{myproof}
Покажем, что $\overline{E} = \bigoplus ^{m} _{i=1} A f_i$. Прежде всего, для $1 \leqslant i \leqslant m, f_i \in \overline{E}$ так как $a_i f_i \in E$ и $a_i$ ненулевые. Обратно, каждое $x \in L$ можно представить в виде $x = y + z $,  где $ y \in \bigoplus ^{m} _{i=1} Af_i $ и $z \in \bigoplus ^{n} _{j=m+1}  Af_i $. Тогда, если $x \in \overline(E)$, т.е. если существует такое ненулевое $a$, что $ax \in E$, то $az=0$, откуда $z=0$, и наконец, $x \in \bigoplus ^{m} _{i=1} Af_i $.

\noindent Пункты ($i$) и ($ii$) теперь легко доказываются. Чтобы доказать пункт ($iii$), заметим, что 
\begin{center} $ L = \overline{E} \oplus F$, где $F = Af_{m+1} \oplus Af_{m+2} \oplus ... \oplus Af_n$;
\end{center}

\noindent это дает равенства:
$$ L ~/~ E = \overline{E} ~/~ E + (F + E) ~/~ E = \overline{E} ~/~ E \oplus (F + E) ~/~ E, $$

\noindent так как $ (F + E) \cap \overline{E} = E$. Однако каноническое отображение $F \rightarrow (F + E) ~/~ E$ сюръективно с ядром $F \cap E = 0$, и следовательно, $(F + E) ~/~ E  \simeq F \simeq L ~/~ \overline{E}$, что завершает доказательство.
\end{myproof}
\subsection{Инвариантные множители модуля конечного типа}
\noindent Поговорим сначала о прямых суммах однопорожденных модулей. Однопорожденный $A$-модуль имеет вид $M = Ax$. В этом случае линейное отображение из $A$ в $M$, определенное соответствием $a \rightarrow ax$, сюръективно и имеет своим ядром идеал-аннулятор $M$:
$$Ann(M)= \{a \in A | a M = 0\},$$
\noindent что индуцирует изоморфизм $ A ~/~ Ann(M) \simeq M$. Обратно, если $I$ — произвольный идеал из $A$, то модуль $ A ~/~ I$ является однопорожденным (с $\overline{I}$ в качестве образующей) с аннлуятором $I$.
\begin{thm}[структура модулей конечного типа]
\hspace*{0.5cm}
\textit{Пусть $M$ — $A$-модуль конечного типа над кольцом главных идеалов.}

\textit{($i$) Существует разложение M в прямую сумму однопорожденных ненулевых подмодулей:}
\begin{center}
$M = M_1 \oplus ... \oplus M_q$, где $Ann(M_q) \subset Ann(M_{q-1}) \subset ... \subset Ann(M_1) \ne A$.
\end{center}

\noindent \textit{Подмодуль кручения модуля M является прямой суммой $M_i$ с ненулевым аннулятором и, следовательно, допускает в качестве дополнения свободный подмодуль, состоящий из $M_j$, аннулятором 0:}
\begin{center}
$tors(M) = \bigoplus _{Ann(M_i) \ne 0} M_i$,
$Free = \bigoplus _{Ann(M_j) = 0} M_j$, и 
$M = tors(M) \oplus Free$.
\end{center}

\textit{($ii$) Другая формулировка этого результата такова: M изоморфен прямой сумме:}
\begin{center}
$ M \simeq A ~/~ I_1 \oplus A ~/~ I_2 \oplus ... \oplus A ~/~ I_q $, 
где $I_q \subset I_{q-1} \subset ... \subset I_1 \ne A$.
\end{center}

\textit{ Из этих условий идеалы $I_i$ определяются единственным образом и называются \textbf{инвариантными множителями} модуля M. Так как эти идеалы главные, $I_i = (a_i)$, то говорят иногда, что $a_i$, определенные с точностью до обратимости, являются инвариантными множителями $M$.}
\textit{\\\\Они не обратимы и удовлетворяют отношению делимости:}
\begin{center}
$a_1~|~a_2$,~~~~~$a_2~|~a_3$, ~~~~~~ $a_{q-1}~|~a_q$.
\end{center}
\end{thm}
\newpage
\begin{myproof}
Построим сюръекцию из $A^{n}$ на $M$, используя $n$ векторов канонического базиса $A^{n}$ в качестве семейства $n$ образующих $M$. Следовательно, подмодуль $M$ изоморфен фактормодулю $A^{n} ~/~ E$, где $E$ — подмодуль $A^{n}$ ранга $ m \leqslant n$. В силу предыдущих результатов существуют ненулевые коэффициенты $(b_1, b_2, ..., b_m)$, удовлетворяющие отношению $b_1~~|~~b_2~~|...|~~b_{m-1}~~|~~b_m$, и базис $\{f_1, f_2, ..., f_n\}$ из $A^{n}$ такой, что $\{b_1f_1, b_2f_2,...,b_mf_m\}$ будет базисом $E$, т.е.
\begin{center}
$A^{n} = Af_1 \oplus Af_2 \oplus ... \oplus Af_n$ и $ E = Ab_1f_1 \oplus Ab_2f_2 \oplus ... \oplus Ab_mf_m.$
\end{center}

\noindent Отсюда следует изоморфизм:
$$ M \simeq A ~/~(b_1) \oplus A ~/~(b_2) \oplus ... \oplus A ~/~(b_m) \oplus A^{n-m}. $$

\noindent Исключая обратимые $b_i$, которые приводят частные $A ~/~(b_i)$ к тривиальному виду, и записывая $A^{n-m} = A ~/~ \{0\} \oplus A ~/~ \{0\} \oplus ... \oplus A ~/~ \{0\}$, вводим последовательность идеалов $(I_i)_{1\leqslant i \leqslant q}$, удовлетворяющих условиям:
\begin{center}
$ M \simeq A ~/~ I_1 \oplus A ~/~ I_2 \oplus ... \oplus A ~/~ I_q $, 
где $I_q \subset I_{q-1} \subset ... \subset I_1 \ne A$.
\end{center}

\noindent Остальное легко выводится из этого отношения.
\end{myproof}
Примененный к кольцу целых чисел $\mathbb{Z}$, этот результат дает структуру абелевой группы конечного типа.
\begin{predl}[структура абелевой группы конечного типа]
\hspace*{0.5cm}

\textit{Любая абелева группа \textbf{конечного типа} $\Omega$ является прямой суммой своей периодической подгруппы $tors(\Omega)$, которая является подгруппой, состоящей из элементов конечного порядка, и свободной группы ранга $r$, изоморфной $\mathbb{Z}^r$. Подгруппа $tors(\Omega)$ является конечной и изоморфной конечному произведению циклических групп:}
$$tors(\Omega) \simeq \mathbb{Z} ~/~n_1 \mathbb{Z} \times \mathbb{Z} ~/~n_2 \mathbb{Z} \times ... \times \mathbb{Z} ~/~n_t \mathbb{Z},$$
\noindent \textit{ где $n_i$ — целые числа, большие или равные 2, удовлетворяющие условию: $n_1~~|~~n_2~~|~~n_3~~|...|~~n_{t-1}~~|~~n_t$. Целые числа $r, t$ и $n_1, n_2, ..., n_t$ определяются структурой группы $\Omega$ единственным образом. Числа $n_1, n_2, ..., n_t$ являются инвариантными множителями абелевой группы конечного типа $\Omega$.}
\end{predl}
\end{document}
